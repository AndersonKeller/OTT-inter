{"version":3,"sources":["webpack:///./components/Packages.js","webpack:///./node_modules/@babel/runtime/helpers/esm/toArray.js","webpack:///./pages/user/changePlan/form.js","webpack:///./pages/user/changePlan/payment.js"],"names":["PackageRadio","onChange","package_id","plan","readOnly","discount","buttonLabel","amount_with_discount","Math","round","amount","pivot","percent","checked","id","name","type","value","withApi","memo","error","items","loading","validationError","discount_id","setBlockDiscountFields","api","useState","discounts","setDiscounts","rest","useEffect","_","a","get","data","map","item","key","find","disc","_toArray","arr","FkInput","style","label","props","useField","field","meta","htmlFor","color","touched","className","ChangePlanForm","isPayUReady","packages","POS","free_package_id","requireds","IS_PRODUCTION","useContext","UserContext","user","updateUser","setDiscount","supportersDiscount","setSupportersDiscount","payment_method_id","payment_os","cash_payment_method_id","terms","supporter_id","alternate_supporter_id","values","setValues","setLoading","setError","createToken","promise","Promise","resolve","reject","additionalData","holder_name","document","getElementById","result","json","JSON","parse","console","log","token","isCardPayment","includes","method","onSubmit","e","preventDefault","paymentData","post","order","Router","push","pathname","query","download_link","link","response","status","request","description","errors","message","CONFIG","shortClubName","disabled","maxLength","target","length","backgroundColor","parseInt","onCashPaymentMethodChange","required","href","appName","block","InputRadio","state","Payment","paymentMethods","setPaymentMethods","cashPaymentMethods","setCashPaymentMethods","initSecureFields","paymentMethod"],"mappings":"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","file":"static/chunks/740db9341c83aebd8ef66b4686e3bad24f7f7364.295cc3b2df42b5af293d.js","sourcesContent":["// app imports\nimport FormGroup from './layout/AuthModal/FormGroup'\nimport { memo, useEffect, useState } from 'react'\nimport withApi from '~/components/withApi'\n\n// packages component\nconst Packages = ({\n  error,\n  items,\n  loading,\n  onChange,\n  package_id,\n  validationError,\n  readOnly,\n  discount_id,\n  setBlockDiscountFields,\n  api\n}) => {\n\n  const [discounts, setDiscounts] = useState([])\n\n  const [, ...rest] = items;\n\n  /* get discounts */\n  useEffect(_ => {\n    (async _ => {\n      setBlockDiscountFields(true)\n      const { data } = discount_id ? await api.get(`discounts/${discount_id}/packages`) : []\n      setDiscounts(data)\n      setBlockDiscountFields(false)\n    })()\n  }, [discount_id])\n\n\n  // error handling\n  if (error) {\n    return <div>No se pueden cargar paquetes</div>\n  }\n\n  // return\n  return (\n    <section className=\"packages\">\n      <div className=\"row gutter-15 packages__list\">\n        {rest && rest.map((item, key) => {\n          let discount = discounts ? discounts.find(disc => disc.id == item.id) : null\n\n          return <div className=\"col-6 col-md\" {...{ key }}>\n            <FormGroup>\n              <PackageRadio {...{ onChange, readOnly, discount, package_id, plan: item }} />\n            </FormGroup>\n          </div>\n        })}\n      </div>\n      {validationError && (\n        <div className=\"invalid-feedback\">{validationError}</div>\n      )}\n      <style jsx>{`\n        .packages {\n          margin-bottom: 15px;\n        }\n        .packages__list {\n          margin-bottom: -15px;\n        }\n      ` }</style>\n    </section>\n  )\n}\n\n// radio component\nexport const PackageRadio = ({\n  onChange,\n  package_id,\n  plan,\n  readOnly,\n  discount,\n  buttonLabel\n}) => {\n\n  plan.amount_with_discount = discount ? Math.round(plan.amount * (1 - discount.pivot.percent)) : 0\n\n  return (\n    <label className={'text-center' + (readOnly ? ' readonly' : '')}>\n      <input\n        checked={plan.id == package_id}\n        name=\"package_id\"\n        onChange={onChange}\n        type=\"radio\"\n        value={plan.id}\n        {...{ readOnly }}\n      />\n\n      <span className=\"fake-input\">\n\n        <div className=\"suscripcion\">Suscripción</div>\n        {/* name */}\n        <div className=\"d-block name\">{plan.name}</div>\n\n        {/* value */}\n        {(plan.amount !== plan.amount_with_discount ||\n          plan.amount === \"$0\" && !discount) && (\n            <div className={discount ? 'discount-value' : 'value'}>\n              { plan.amount}\n            </div>\n          )}\n\n        {/* discount */}\n        {discount && (\n          <div className=\"value\">\n            {plan.amount_with_discount}\n          </div>\n        )}\n\n        <div className={\"btn-suscribir\"}>{buttonLabel ? buttonLabel : \"Suscribir\"}</div>\n\n      </span>\n\n      <style jsx>{`\n        label {\n          cursor: pointer;\n          display: block;\n          margin-bottom: 15px;\n          overflow: hidden;\n          position: relative;\n        }\n        input {\n          opacity: 0;\n          position: absolute;\n        }\n        .fake-input {\n          display: block;\n          padding: 15px;\n          transition: border-color .3s;\n          background-color: #282828;\n          color: #FFF;\n        }\n        input:checked + .fake-input {\n          //border-color: var(--primary);\n          //border-width: 2px;\n          padding: 14px;\n          background-color: var(--primary);\n\n        }\n        .name {\n          font-size: 1.33em;\n          margin-bottom: 5px;\n        }\n        .discount-value {\n          text-decoration: line-through;\n          margin-right: 5px;\n          color: red;\n        }\n        .readonly {\n          cursor: default;\n        }\n        .value {\n          margin-top: 1.4em;\n          font-weight: bold;\n        }\n\n        .btn-suscribir {\n          margin-top: 1.3em;\n          background-color: transparent !important;\n          border: 1px solid #FFF !important;\n          font-weight: normal;\n          border-radius: 4.6px;\n          color: #FFF;\n          padding: 0.8em 1em;\n          font-size: 0.8em;\n        }\n        .suscripcion {\n          margin: 0 0 1.4em 0;\n          font-weight: bold;\n        }\n\n      ` }</style>\n    </label>\n  )\n}\n\n// export packages\nexport default withApi(memo(Packages))\n","import arrayWithHoles from \"./arrayWithHoles\";\nimport iterableToArray from \"./iterableToArray\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray\";\nimport nonIterableRest from \"./nonIterableRest\";\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}","// next\nimport Link   from 'next/link'\nimport Router from 'next/router'\n\n// react\nimport { useField } from 'formik'\nimport { useContext, useEffect, useState } from 'react'\n\n// components\nimport UserContext  from '~/contexts/UserContext'\nimport Packages     from '~/components/Packages'\nimport Payment      from './payment'\nimport Button       from '~/components/button'\nimport FormGroup    from '~/components/layout/AuthModal/FormGroup'\n\n// env\nimport { IS_PRODUCTION } from '~/constants/constants'\nimport { CONFIG } from '~/config'\n\n// import Select       from '../Select/Select'\nimport Label        from '~/components/layout/AuthModal/Label'\nimport Input        from '~/components/layout/AuthModal/Input'\n\n\nconst ChangePlanForm = ({ api, isPayUReady, packages, POS }) => {\n\n  const { id: free_package_id } = packages.items.find(item => item.amount == 0) || {}\n\n  const requireds = IS_PRODUCTION\n  const debug = false && ! IS_PRODUCTION\n\n  const { user, updateUser } = useContext(UserContext)\n\n  const [ discount, setDiscount ] = useState(false)\n  const [ supportersDiscount, setSupportersDiscount ] = useState()\n  const [ values, setValues ] = useState({\n    package_id: '',\n    payment_method_id: null,\n    payment_os: null,\n    cash_payment_method_id: null,\n    terms: null,\n    supporter_id: '',\n    alternate_supporter_id: '',\n  })\n\n  const [ loading, setLoading ] = useState()\n  const [ error, setError ] = useState()\n\n  /* fill user form */\n  useEffect(_ => {\n    if (user) {\n      setValues({\n        ...values\n      })\n    }\n  }, [user])\n\n  /* handle general input change */\n  const handleInputChange = e => {\n    const { checked, name, value, type } = e.target\n    setValues({\n      ...values,\n      [name]: type === 'checkbox' ?\n        (checked ? (value === 'true' ? true : value) : false) :\n        value,\n    })\n  }\n\n  const handleDiscountChange = e => {\n    setValues({\n      ...values,\n      alternate_supporter_id: e.target.value,\n    })\n    setDiscount(e.target.value.length === 5)\n  }\n\n  const handleSupportersDiscountChange = e => {\n    setValues({\n      ...values,\n      supporter_id: e.target.value,\n    })\n    setSupportersDiscount(e.target.value.length === 5)\n  }\n\n  /* handle package change */\n  function onPackageChange(e) {\n    const package_id = parseInt(e.target.value, 10)\n    setValues({\n      ...values,\n      package_id: package_id,\n      payment_method_id: package_id === free_package_id ? null : values.payment_method_id,\n    })\n  }\n\n  /* handle payment method change */\n  function onPaymentChange(e) {\n    setValues({\n      ...values,\n      payment_method_id: parseInt(e.target.value, 10),\n      cash_payment_method_id: null,\n    })\n  }\n\n  function onCashPaymentMethodChange(e) {\n    setValues({\n      ...values,\n      cash_payment_method_id: parseInt(e.target.value, 10),\n    })\n  }\n\n  /* token */\n  async function createToken() {\n    const promise = new Promise((resolve, reject) => {\n      const additionalData = {\n        holder_name: document.getElementById('cardholder-name').value,\n        // custom_data: document.getElementById('custom').value,\n      }\n      POS.createToken(additionalData, (result) => {\n        const json = JSON.parse(result)\n        console.log('json', json)\n        json.token ? resolve(json) : reject(json)\n      })\n    })\n    return promise\n  }\n\n  // is card payment\n  const credit_card_id = 1\n  const debit_card_id = 2\n  const isCardPayment = [credit_card_id, debit_card_id].includes(values.payment_method_id)\n\n  /* submit */\n  const handleSubmit = async e => {\n    e.preventDefault()\n    setLoading(true)\n    try {\n      const paymentData = values.package_id && values.package_id !== free_package_id &&\n        values.payment_method_id && isCardPayment ? await createToken() : null\n      const data = { ...values, payment_os: paymentData }\n      try {\n        const { data: { user, order } } = await api.post('register/changePlan', data)\n        updateUser(user)\n        if (order) {\n          Router.push({\n            pathname: '/account/confirm',\n            query: {\n              download_link: order.download_link,\n              link: order.link,\n            },\n          }, '/register/confirm')\n        } else {\n          Router.push('/')\n        }\n      } catch (error) {\n        console.log('error', error)\n        if (error.response) {\n          const { data, status } = error.response\n          if (status === 422) {\n            setError(data)\n          }\n        } else if (error.request) {\n          setError(error)\n        } else {\n          setError(error)\n        }\n      }\n    } catch (error) {\n      setError(error.description ? { errors: { payment_os: error.description } } : error)\n    }\n    setLoading(false)\n  }\n\n  return (\n    <form method=\"post\" onSubmit={handleSubmit}>\n\n      {/* main error msg */}\n      { error && error.message && (\n        <div className=\"invalid-feedback\">{error.message}</div>\n      ) }\n\n      {/* form data debug */}\n      { debug && (\n        <pre>\n          {JSON.stringify(values, null, 2)}\n        </pre>\n      )}\n\n      <h3 className=\"h3\">¿Eres Socio? Obtén un descuento especial</h3>\n        <div className=\"row\">\n          <div className=\"col-md-6\">\n            <div className=\"data\">\n              <FormGroup>\n                <Label htmlFor=\"supporter_id\">Socio {CONFIG.shortClubName}</Label>\n                <Input\n                  disabled={values.alternate_supporter_id}\n                  id=\"supporter_id\"\n                  maxLength={5}\n                  name=\"supporter_id\"\n                  onChange={handleSupportersDiscountChange}\n                  type=\"text\"\n                  style={supportersDiscount ? {backgroundColor: 'rgb(206, 249, 206)'} : {}}\n                  value={values.supporter_id}\n                />\n              </FormGroup>\n            </div>\n          </div>\n          <div className=\"col-md-6\">\n            <div className=\"localization\">\n              <FormGroup>\n                <Label htmlFor=\"alternate_supporter_id\">Somos {CONFIG.shortClubName}</Label>\n                <Input\n                  disabled={values.supporter_id}\n                  id=\"alternate_supporter_id\"\n                  maxLength={5}\n                  name=\"alternate_supporter_id\"\n                  onChange={handleDiscountChange}\n                  type=\"text\"\n                  style={discount ? {backgroundColor: 'rgb(206, 249, 206)'} : {}}\n                  value={values.alternate_supporter_id}\n                />\n              </FormGroup>\n            </div>\n          </div>\n        </div>\n\n\n      {/* package selection */}\n      <Packages {...{\n        error: packages.error ? packages.error : null,\n        items: packages.items ? packages.items : null,\n        onChange: onPackageChange,\n        package_id: values.package_id,\n        validationError: ! loading && error && error.errors && error.errors.package_id,\n        discount,\n        supportersDiscount,\n      }} />\n\n      {/* payment */}\n      { values.package_id && values.package_id !== free_package_id && (\n        <Payment {...{\n          api,\n          cash_payment_method_id: values.cash_payment_method_id,\n          error,\n          isCardPayment,\n          isPayUReady,\n          loading,\n          onCashPaymentMethodChange,\n          onChange: onPaymentChange,\n          payment_method_id: values.payment_method_id,\n          POS,\n          requireds,\n          validationError: ! loading && error && error.errors && error.errors.payment_method_id,\n        }} />\n      ) }\n\n      {/* footer */}\n      <div className=\"row align-items-center\">\n\n        {/* terms */}\n        <div className=\"col-md-6 offset-md-4\">\n          <label className=\"terms\">\n            <input\n              checked={values.terms}\n              name=\"terms\"\n              onChange={handleInputChange}\n              required={requireds}\n              type=\"checkbox\"\n              value={true}\n            />\n            <span>He leído y acepto <Link href=\"/terminos-y-politicas\">\n                <a target=\"_blank\">el contrato</a>\n              </Link> de {CONFIG.appName}</span>\n          </label>\n          { ! loading && error && error.errors && error.errors.terms && (\n            <div className=\"invalid-feedback\">{error.errors.terms}</div>\n          ) }\n        </div>\n\n        {/* send btn */}\n        <div className=\"col-md-2 text-right\">\n          <Button block color=\"secondary\" disabled={loading} type=\"submit\">Enviar</Button>\n        </div>\n\n      </div>\n\n      <style jsx>{`\n        :global(.h3) {\n          font-size: 20px;\n          font-weight: bold;\n          margin-bottom: 10px;\n        }\n        hr,\n        .hr {\n          margin-top: 0;\n          margin-bottom: 15px;\n        }\n        @media (min-width: 768px) {\n          .card-inputs {\n            margin-top: -21px;\n          }\n        }\n        .terms {\n          font-size: 18px;\n        }\n        .terms input {\n          margin-right: 5px;\n        }\n        .valid-number {\n          background-color: rgb(206, 249, 206);\n        }\n      `}</style>\n    </form>\n  )\n}\n\n// create formik input field\nexport const FkInput = ({ style, label, ...props }) => {\n  const [field, meta] = useField(props)\n  field.value = field.value || ''\n\n  return (\n    <>\n      { props.type == 'hidden' ? '' : <Label htmlFor={props.id || props.name}>{label}</Label> }\n      <Input style={{color: 'black', ...style}}  {...field} {...props} />\n      {meta.touched && meta.error ? ( <div className=\"invalid-feedback\">{ meta.error }</div> ) : null}\n    </>\n  )\n}\n\nexport default ChangePlanForm\n","//react\nimport { useEffect, useState } from 'react'\n\n//components\nimport FormGroup from '~/components/layout/AuthModal/FormGroup'\nimport Label from '~/components/layout/AuthModal/Label'\nimport Input from '~/components/layout/AuthModal/Input'\n\n// Payment\nconst Payment = ({\n  api,\n  cash_payment_method_id,\n  error,\n  isCardPayment,\n  isPayUReady,\n  loading,\n  onCashPaymentMethodChange,\n  onChange,\n  payment_method_id,\n  POS,\n  requireds,\n  validationError\n}) => {\n\n  // payment methods\n  const [paymentMethods, setPaymentMethods] = useState()\n  // cash payment methods\n  const [cashPaymentMethods, setCashPaymentMethods] = useState()\n\n  // get payment methods\n  useEffect(_ => {\n    (async _ => {\n      const { data } = await api.get('payment-methods')\n      setPaymentMethods(data)\n    })()\n  }, [])\n\n  // init card secure fields\n  useEffect(_ => { isPayUReady && isCardPayment && POS.initSecureFields('card-secure-fields') },\n    [isPayUReady, isCardPayment]\n  )\n\n  // get cash payment methods\n  useEffect(_ => {\n    (async _ => {\n      const { data } = await api.get('cash-payment-methods')\n      setCashPaymentMethods(data)\n    })()\n  }, [])\n\n\n  return (\n    <div className=\"row\">\n      <div className=\"offset-md-2 col-md-8\">\n        <h3 className=\"h3\">Pago</h3>\n        <div className=\"row\">\n\n          <div className=\"col-md-6\">\n            <FormGroup>\n              {paymentMethods && paymentMethods.map((paymentMethod, key) => (\n                <InputRadio\n                  key={key}\n                  label={paymentMethod.name}\n                  name=\"payment\"\n                  onChange={onChange}\n                  state={payment_method_id}\n                  value={paymentMethod.id}\n                />\n              ))}\n              {validationError && (\n                <div className=\"invalid-feedback\">{validationError}</div>\n              )}\n            </FormGroup>\n          </div>\n\n          <div className=\"col-md-6\">\n\n            {/* credit / debit card */}\n            {isCardPayment ? (\n              <div className=\"card-inputs\">\n\n                {/* mandatory data */}\n                <FormGroup>\n                  <Label htmlFor=\"cardholder-name\">Nombre impreso en tarjeta</Label>\n                  <Input id=\"cardholder-name\" name=\"cardholder-name\" required={requireds} type=\"text\" />\n                </FormGroup>\n\n                {/* card fields */}\n                <FormGroup>\n                  <div id=\"card-secure-fields\" />\n                  {!loading && error && error.errors && error.errors.payment_os && (\n                    <div className=\"invalid-feedback\">{error.errors.payment_os}</div>\n                  )}\n                </FormGroup>\n              </div>\n\n              // cash payment methods\n            ) : payment_method_id === 3 && (\n              <FormGroup>\n                {cashPaymentMethods == null ? (\n                  <p>Cargando...</p>\n                ) : cashPaymentMethods.length ? cashPaymentMethods.map((item, key) => (\n                  <InputRadio\n                    key={key}\n                    label={item.name}\n                    name=\"cash_payment_method_id\"\n                    onChange={onCashPaymentMethodChange}\n                    state={cash_payment_method_id}\n                    value={item.id}\n                  />\n                )) : (\n                      <p>Sin método de pago configurado.</p>\n                    )}\n                {!loading && error && error.errors && error.errors.cash_payment_method_id && (\n                  <div className=\"invalid-feedback\">{error.errors.cash_payment_method_id}</div>\n                )}\n              </FormGroup>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n\n\n// Radio\nconst InputRadio = ({ label, name, onChange, state, value }) => {\n  return (\n    <label>\n      <input checked={state === value} type=\"radio\" {...{ name, onChange, value }} />\n      <span className=\"fake-input\">\n        <span className=\"fake-radio\"></span>\n        <span>{label}</span>\n      </span>\n      <style jsx>{`\n        label {\n          display: block;\n          margin-bottom: 5px;\n          overflow: hidden;\n          position: relative;\n        }\n        input {\n          opacity: 0;\n          position: absolute;\n        }\n        .fake-input {\n          border: 2px solid var(--primary);\n          border-radius: 4px;\n          display: block;\n          font-size: 1rem;\n          line-height: 1.4;\n          padding: .375rem .75rem;\n          transition: background-color .3s, border-color .3s, color .3s;\n        }\n        .fake-radio {\n          background-color: var(--white);\n          border: 1px solid var(--gray2);\n          border-radius: 50%;\n          display: inline-block;\n          height: 15px;\n          margin-right: 7.5px;\n          padding: 1px;\n          vertical-align: -2px;\n          width: 15px;\n        }\n        .fake-radio::before {\n          background-color: var(--black);\n          border-radius: 50%;\n          content: '';\n          display: block;\n          opacity: 0;\n          height: 100%;\n          transition: opacity .3s;\n          width: 100%;\n        }\n        input:checked + .fake-input {\n          background-color: var(--primary);\n          color: white;\n        }\n        input:checked + .fake-input .fake-radio::before {\n          opacity: 1;\n        }\n      `}</style>\n    </label>\n  )\n}\n\nexport default Payment\n"],"sourceRoot":""}