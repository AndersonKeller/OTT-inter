{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport { useEffect, useState, useContext } from 'react';\nimport { Card, Table } from 'react-bootstrap';\nimport { ThemeContext } from 'styled-components';\nimport { PackageRadio } from '~/components/Packages';\nimport withAuth from '~/components/withAuth';\nimport Layout from '~/components/layout/Layout';\nimport { CONFIG } from '~/config';\nimport { StylePayment } from '~/components/layout/Payments/index';\nimport CardLogoHeader from '~/components/CardLogoHeader/index';\n\nconst PaymentsPage = ({\n  api,\n  layoutProps,\n  packages,\n  user\n}) => {\n  const {\n    0: plan,\n    1: setPlan\n  } = useState({});\n  const {\n    0: subscription,\n    1: setSubscription\n  } = useState({});\n  const {\n    0: orders,\n    1: setOrders\n  } = useState([]);\n  useEffect(_ => {\n    (async _ => {\n      try {\n        const {\n          data: {\n            package_id\n          }\n        } = await api.get('subscription'),\n              data = _objectWithoutProperties((await api.get('subscription')).data, [\"package_id\"]);\n\n        console.log(data);\n        setSubscription(data);\n\n        if (package_id) {\n          setPlan(packages.items.find(item => item.id == package_id));\n        } else {\n          setPlan(packages.items.find(item => item.amount == 0));\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    })();\n  }, []);\n  useEffect(_ => {\n    (async _ => {\n      try {\n        const {\n          data\n        } = await api.get('cash-orders');\n        setOrders(data);\n      } catch (error) {\n        console.log(error);\n      }\n    })();\n  }, []);\n  const theme = useContext(ThemeContext);\n  const backgroundColor = theme.colors.backgroundContrast;\n  return __jsx(Layout, layoutProps, __jsx(CardLogoHeader, null, __jsx(StylePayment, null, __jsx(Head, null, __jsx(\"title\", null, \"Pagos < \", CONFIG.appName, \" \")), __jsx(\"h1\", {\n    className: \"h2\"\n  }, \"Detalles de la compra\"), __jsx(\"div\", {\n    className: \"painel\"\n  }, __jsx(\"div\", {\n    className: \"detail-compra\"\n  }, __jsx(Card.Title, null, \"Tu plan\"), __jsx(Card.Text, null, \"Todo el contenido de \", CONFIG.appName, \" por \", plan.name, \".\")), __jsx(\"div\", {\n    className: \"col-5 col-md-2 text-center\",\n    style: {\n      fontSize: '13px',\n      lineHeight: '0.7rem',\n      padding: 0\n    }\n  }, __jsx(PackageRadio, {\n    readOnly: true,\n    package_id: plan.id,\n    plan: plan,\n    buttonLabel: \"Cambiar Plan\"\n  }))), __jsx(Card.Footer, {\n    style: {\n      fontSize: '12px',\n      lineHeight: 1\n    }\n  }, \"Pr\\xF3xima factura: \", subscription.ends_at && subscription.ends_at.split(' ')[0]), __jsx(\"div\", {\n    className: \"mobile-table\"\n  }, orders.map(order => __jsx(\"div\", {\n    className: \"mobile-row\",\n    key: order.id\n  }, __jsx(\"dl\", null, __jsx(\"dt\", null, \"Fecha\"), __jsx(\"dd\", null, __jsx(Link, {\n    href: \"receipt\"\n  }, __jsx(\"a\", {\n    target: \"_blank\"\n  }, order.paid_at && order.paid_at.split(' ')[0])))), __jsx(\"dl\", null, __jsx(\"dt\", null, \"Descripci\\xF3n\"), __jsx(\"dd\", null, CONFIG.appName)), __jsx(\"dl\", null, __jsx(\"dt\", null, \"Periodo\"), __jsx(\"dd\", null, order.paid_at && order.paid_at.split(' ')[0], \"-\")), __jsx(\"dl\", null, __jsx(\"dt\", null, \"Medio de Pago\"), __jsx(\"dd\", null, __jsx(Link, {\n    href: \"receipt\"\n  }, __jsx(\"a\", {\n    target: \"_blank\"\n  }, order.download_link)))), __jsx(\"dl\", null, __jsx(\"dt\", null, \"Total\"), __jsx(\"dd\", null, order.value))))), __jsx(Table, {\n    className: \"desktop-table\",\n    hover: true,\n    variant: \"dark\",\n    size: \"sm\"\n  }, __jsx(\"thead\", null, __jsx(\"tr\", null, __jsx(\"th\", null, \"#\"), __jsx(\"th\", null, \"Fecha\"), __jsx(\"th\", null, \"Descripci\\xF3n\"), __jsx(\"th\", null, \"Periodo\"), __jsx(\"th\", null, \"Medio de Pago\"), __jsx(\"th\", null, \"Total\"))), __jsx(\"tbody\", null, orders.map(order => __jsx(\"tr\", {\n    key: order.id\n  }, __jsx(\"td\", null, order.id), __jsx(\"td\", null, __jsx(Link, {\n    href: \"receipt\"\n  }, __jsx(\"a\", {\n    target: \"_blank\"\n  }, order.paid_at && order.paid_at.split(' ')[0]))), __jsx(\"td\", null, CONFIG.appName), __jsx(\"td\", null, order.paid_at && order.paid_at.split(' ')[0], \"-\"), __jsx(\"td\", null, __jsx(Link, {\n    href: \"receipt\"\n  }, __jsx(\"a\", {\n    target: \"_blank\"\n  }, order.download_link))), __jsx(\"td\", null, order.value))))))));\n};\n\nPaymentsPage.getInitialProps = async ({\n  api,\n  user\n}) => {\n  let packages;\n\n  try {\n    const {\n      data\n    } = await api.get('packages');\n    packages = {\n      items: data\n    };\n  } catch (error) {\n    packages = {\n      error\n    };\n  }\n\n  return {\n    packages,\n    user\n  };\n};\n\nexport default withAuth(PaymentsPage);","map":{"version":3,"sources":["/Users/rafael/Projects/somosgad/dale/pages/user/payments.js"],"names":["Head","Link","useEffect","useState","useContext","Card","Table","ThemeContext","PackageRadio","withAuth","Layout","CONFIG","StylePayment","CardLogoHeader","PaymentsPage","api","layoutProps","packages","user","plan","setPlan","subscription","setSubscription","orders","setOrders","_","data","package_id","get","console","log","items","find","item","id","amount","error","theme","backgroundColor","colors","backgroundContrast","appName","name","fontSize","lineHeight","padding","ends_at","split","map","order","paid_at","download_link","value","getInitialProps"],"mappings":"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","sourcesContent":["import Head from 'next/head'\nimport Link from 'next/link'\nimport { useEffect, useState, useContext } from 'react'\nimport { Card, Table } from 'react-bootstrap'\nimport { ThemeContext } from 'styled-components'\nimport { PackageRadio } from '~/components/Packages'\nimport withAuth from '~/components/withAuth'\nimport Layout from '~/components/layout/Layout'\nimport { CONFIG } from '~/config'\nimport { StylePayment } from '~/components/layout/Payments/index'\nimport CardLogoHeader from '~/components/CardLogoHeader/index'\n\nconst PaymentsPage = ({ api, layoutProps, packages, user }) => {\n\n  const [plan, setPlan] = useState({})\n  const [subscription, setSubscription] = useState({})\n  const [orders, setOrders] = useState([])\n\n  useEffect(_ => {\n    (async _ => {\n      try {\n        const { data: { package_id, ...data } } = await api.get('subscription')\n        console.log(data)\n        setSubscription(data)\n\n        if (package_id) {\n          setPlan(packages.items.find(item => item.id == package_id))\n        } else {\n          setPlan(packages.items.find(item => item.amount == 0))\n        }\n      } catch (error) {\n        console.log(error)\n      }\n    })()\n  }, [])\n\n  useEffect(_ => {\n    (async _ => {\n      try {\n        const { data } = await api.get('cash-orders')\n        setOrders(data)\n      } catch (error) {\n        console.log(error)\n      }\n    })()\n  }, [])\n\n  const theme = useContext(ThemeContext)\n  const backgroundColor = theme.colors.backgroundContrast\n\n  return (\n    <Layout {...layoutProps}>\n      <CardLogoHeader>\n        <StylePayment>\n          <Head>\n            <title>Pagos &lt; {CONFIG.appName} </title>\n          </Head>\n          {/* <div className=\"payments-wrapper\">\n            <div className=\"container\"> */}\n\n          <h1 className=\"h2\">Detalles de la compra</h1>\n\n          {/* <Card bg=\"dark\" text=\"white\"> */}\n          <div className=\"painel\">\n            <div className=\"detail-compra\">\n              <Card.Title>Tu plan</Card.Title>\n              <Card.Text>Todo el contenido de {CONFIG.appName} por {plan.name}.</Card.Text>\n            </div>\n            <div className=\"col-5 col-md-2 text-center\" style={{ fontSize: '13px', lineHeight: '0.7rem', padding: 0 }}>\n              <PackageRadio\n                readOnly\n                package_id={plan.id}\n                plan={plan}\n                buttonLabel={\"Cambiar Plan\"}\n              />\n            </div>\n          </div>\n\n          <Card.Footer style={{ fontSize: '12px', lineHeight: 1 }}>\n            Próxima factura: {subscription.ends_at && subscription.ends_at.split(' ')[0]}\n          </Card.Footer>\n          {/* </Card> */}\n          <div className=\"mobile-table\">\n            {orders.map(order =>\n              <div className=\"mobile-row\" key={order.id}>\n                <dl>\n                  <dt>Fecha</dt>\n                  <dd><Link href=\"receipt\"><a target=\"_blank\">{order.paid_at && order.paid_at.split(' ')[0]}</a></Link></dd>\n                </dl>\n                <dl>\n                  <dt>Descripción</dt>\n                  <dd>{CONFIG.appName}</dd>\n                </dl>\n                <dl>\n                  <dt>Periodo</dt>\n                  <dd>{order.paid_at && order.paid_at.split(' ')[0]}-</dd>\n                </dl>\n                <dl>\n                  <dt>Medio de Pago</dt>\n                  <dd><Link href=\"receipt\"><a target=\"_blank\">{order.download_link}</a></Link></dd>\n                </dl>\n                <dl>\n                  <dt>Total</dt>\n                  <dd>{order.value}</dd>\n                </dl>\n              </div>\n            )}\n            {/* <div className=\"mobile-row\">\n              <dl>\n                <dt>Fecha</dt>\n                <dd><Link href=\"receipt\"><a target=\"_blank\">09/01/2020</a></Link></dd>\n              </dl>\n              <dl>\n                <dt>Descripción</dt>\n                <dd>{CONFIG.appName}</dd>\n              </dl>\n              <dl>\n                <dt>Periodo</dt>\n                <dd>09/01/2020—08/02/2020</dd>\n              </dl>\n              <dl>\n                <dt>Medio de Pago</dt>\n                <dd>VISA •••• •••• •••• 1627</dd>\n              </dl>\n              <dl>\n                <dt>Total</dt>\n                <dd>$99,00</dd>\n              </dl>\n            </div> */}\n          </div>\n          <Table className=\"desktop-table\" hover variant=\"dark\" size=\"sm\">\n            <thead>\n              <tr>\n                <th>#</th>\n                <th>Fecha</th>\n                <th>Descripción</th>\n                <th>Periodo</th>\n                <th>Medio de Pago</th>\n                <th>Total</th>\n              </tr>\n            </thead>\n            <tbody>\n              {orders.map(order =>\n                <tr key={order.id}>\n                  <td>{order.id}</td>\n                  <td><Link href=\"receipt\"><a target=\"_blank\">{order.paid_at && order.paid_at.split(' ')[0]}</a></Link></td>\n                  <td>{CONFIG.appName}</td>\n                  <td>{order.paid_at && order.paid_at.split(' ')[0]}-</td>\n                  <td><Link href=\"receipt\"><a target=\"_blank\">{order.download_link}</a></Link></td>\n                  <td>{order.value}</td>\n                </tr>\n              )}\n            </tbody>\n          </Table>\n          {/* </div>\n          </div> */}\n        </StylePayment>\n      </CardLogoHeader >\n    </Layout >\n  )\n}\n\nPaymentsPage.getInitialProps = async ({ api, user }) => {\n  let packages\n  try {\n    const { data } = await api.get('packages')\n    packages = { items: data }\n  } catch (error) {\n    packages = { error }\n  }\n  return { packages, user }\n}\n\nexport default withAuth(PaymentsPage);\n"]},"metadata":{},"sourceType":"module"}