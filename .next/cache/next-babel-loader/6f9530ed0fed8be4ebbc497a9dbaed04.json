{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport Router from 'next/router';\nimport { useState, useContext } from 'react';\nimport UserContext from '../../../contexts/UserContext';\nimport { CLIENT_ID, CLIENT_SECRET } from '../../../constants/constants';\nimport { setAccessToken } from '../../../services/auth';\nimport api from '../../../services/api';\nimport { AuthModalContext } from '../../../contexts/AuthModalContext';\nimport FormGroup from './FormGroup';\nimport Input from './Input';\nimport Button from '../../button';\nimport SocialButtons from './SocialButtons';\nimport OrEnterWith from './OrEnterWith';\nimport { CONFIG } from '~/config';\n\nconst RegisterTab = ({\n  changeTab,\n  setLoading,\n  socialLogin\n}) => {\n  const {\n    0: name,\n    1: setName\n  } = useState('');\n  const {\n    0: email,\n    1: setEmail\n  } = useState('');\n  const {\n    0: password,\n    1: setPassword\n  } = useState('');\n  const {\n    0: error,\n    1: setError\n  } = useState('');\n  const {\n    signIn\n  } = useContext(UserContext);\n  const {\n    closeAuthModal,\n    packageId\n  } = useContext(AuthModalContext);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    document.activeElement.blur();\n\n    try {\n      const tokenResponse = await api().post('register', {\n        client_id: CLIENT_ID,\n        client_secret: CLIENT_SECRET,\n        email,\n        name,\n        package_id_intention: packageId,\n        password\n      });\n      const {\n        access_token\n      } = tokenResponse.data;\n      setAccessToken(access_token);\n      const userResponse = await api().get('user');\n      signIn(userResponse.data, tokenResponse.data);\n      closeAuthModal();\n      Router.push('/register/wizard/user-data');\n    } catch (error) {\n      if (error.response) {\n        setError(error.response.data);\n      } else {\n        setError('An error has occurred!');\n        console.log('error', error);\n      }\n    }\n\n    setLoading(false);\n  };\n\n  function goToLogin(e) {\n    e.preventDefault();\n    changeTab('login');\n  }\n\n  const alreadyRegistered = CONFIG.lang === 'es-CL' ? '¿Ya estás suscrito?' : '¿Ya eres suscriptor?';\n  const login = CONFIG.lang === 'es-CL' ? 'Inicia sesión' : 'Ház login';\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"intro-text\"\n  }, __jsx(\"p\", null, \"\\xA1Bienvenidos!\")), __jsx(\"form\", {\n    method: \"post\",\n    onSubmit: handleSubmit\n  }, error && __jsx(\"div\", {\n    className: \"invalid-feedback\"\n  }, error.message), __jsx(FormGroup, null, __jsx(Input, {\n    id: \"name\",\n    onChange: e => setName(e.target.value),\n    placeholder: \"Nombre\",\n    required: true,\n    value: name\n  }), error && error.errors && __jsx(\"div\", {\n    className: \"invalid-feedback\"\n  }, error.errors.name)), __jsx(FormGroup, null, __jsx(Input, {\n    id: \"reg_email\",\n    onChange: e => setEmail(e.target.value),\n    placeholder: \"E-mail\",\n    required: true,\n    type: \"email\",\n    value: email\n  }), error && error.errors && __jsx(\"div\", {\n    className: \"invalid-feedback\"\n  }, error.errors.email)), __jsx(FormGroup, null, __jsx(Input, {\n    id: \"reg_password\",\n    onChange: e => setPassword(e.target.value),\n    placeholder: \"Clave\",\n    required: true,\n    type: \"password\",\n    value: password\n  }), error && error.errors && __jsx(\"div\", {\n    className: \"invalid-feedback\"\n  }, error.errors.password)), __jsx(Button, {\n    block: true,\n    className: \"enter-btn\",\n    size: \"sm\",\n    type: \"submit\"\n  }, \"Registrar\"), __jsx(\"div\", {\n    className: \"already-subscriptor\"\n  }, __jsx(\"span\", null, alreadyRegistered), ' ', __jsx(\"a\", {\n    className: \"bold text-uppercase\",\n    href: \"/login\",\n    onClick: goToLogin\n  }, login)), __jsx(OrEnterWith, null), __jsx(SocialButtons, {\n    socialLogin: socialLogin\n  })));\n};\n\nexport default RegisterTab;","map":{"version":3,"sources":["/Users/rafael/Projects/somosgad/dale/components/layout/AuthModal/RegisterTab.js"],"names":["Router","useState","useContext","UserContext","CLIENT_ID","CLIENT_SECRET","setAccessToken","api","AuthModalContext","FormGroup","Input","Button","SocialButtons","OrEnterWith","CONFIG","RegisterTab","changeTab","setLoading","socialLogin","name","setName","email","setEmail","password","setPassword","error","setError","signIn","closeAuthModal","packageId","handleSubmit","e","preventDefault","document","activeElement","blur","tokenResponse","post","client_id","client_secret","package_id_intention","access_token","data","userResponse","get","push","response","console","log","goToLogin","alreadyRegistered","lang","login","message","target","value","errors"],"mappings":"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","sourcesContent":["import Router from 'next/router'\nimport {useState, useContext} from 'react'\nimport UserContext from '../../../contexts/UserContext'\nimport { CLIENT_ID, CLIENT_SECRET } from '../../../constants/constants'\nimport { setAccessToken } from '../../../services/auth'\nimport api from '../../../services/api'\nimport { AuthModalContext } from '../../../contexts/AuthModalContext'\nimport FormGroup from './FormGroup'\nimport Input from './Input'\nimport Button from '../../button'\nimport SocialButtons from './SocialButtons'\nimport OrEnterWith from './OrEnterWith'\nimport { CONFIG } from '~/config'\n\nconst RegisterTab = ({ changeTab, setLoading, socialLogin })  => {\n  const [name,setName] = useState('')\n  const [email,setEmail] = useState('')\n  const [password,setPassword] = useState('')\n  const [error, setError] = useState('')\n  const { signIn } = useContext(UserContext)\n  const { closeAuthModal, packageId } = useContext(AuthModalContext)\n\n  const handleSubmit = async e => {\n    e.preventDefault()\n    setLoading(true)\n    document.activeElement.blur()\n    try {\n      const tokenResponse = await api().post('register', {\n        client_id: CLIENT_ID,\n        client_secret: CLIENT_SECRET,\n        email,\n        name,\n        package_id_intention: packageId,\n        password,\n      })\n      const { access_token, } = tokenResponse.data\n      setAccessToken(access_token)\n      const userResponse = await api().get('user')\n      signIn(userResponse.data, tokenResponse.data)\n      closeAuthModal()\n      Router.push('/register/wizard/user-data')\n    } catch (error) {\n      if (error.response) {\n        setError(error.response.data)\n      } else {\n        setError('An error has occurred!')\n        console.log('error', error)\n      }\n    }\n    setLoading(false)\n  }\n\n  function goToLogin(e) {\n    e.preventDefault()\n    changeTab('login')\n  }\n\n  const alreadyRegistered = CONFIG.lang === 'es-CL' ? '¿Ya estás suscrito?' : '¿Ya eres suscriptor?'\n\n  const login = CONFIG.lang === 'es-CL' ? 'Inicia sesión' : 'Ház login'\n\n  return (\n    <>\n      <div className=\"intro-text\">\n        <p>¡Bienvenidos!</p>\n      </div>\n      <form method=\"post\" onSubmit={handleSubmit}>\n\n        {error && <div className=\"invalid-feedback\">{error.message}</div>}\n\n        <FormGroup>\n          <Input\n            id=\"name\"\n            onChange={e => setName(e.target.value)}\n            placeholder=\"Nombre\"\n            required\n            value={name}\n          />\n          {error && error.errors && (<div className=\"invalid-feedback\">{error.errors.name}</div>)}\n        </FormGroup>\n\n        <FormGroup>\n          <Input\n            id=\"reg_email\"\n            onChange={e => setEmail(e.target.value)}\n            placeholder=\"E-mail\"\n            required\n            type=\"email\"\n            value={email}\n          />\n          {error && error.errors && (<div className=\"invalid-feedback\">{error.errors.email}</div>)}\n        </FormGroup>\n\n        <FormGroup>\n          <Input\n            id=\"reg_password\"\n            onChange={e => setPassword(e.target.value)}\n            placeholder=\"Clave\"\n            required\n            type=\"password\"\n            value={password}\n          />\n          {error && error.errors &&  (\n            <div className=\"invalid-feedback\">{error.errors.password}</div>\n          )}\n        </FormGroup>\n\n        {/* <FormGroup>\n          <Label hmtlFor=\"password_confirmation\">Confirmación de Clave</Label>\n          <Input id=\"password_confirmation\" type=\"password\" />\n        </FormGroup> */}\n\n        <Button block className=\"enter-btn\" size=\"sm\" type=\"submit\">Registrar</Button>\n\n        <div className=\"already-subscriptor\">\n          <span>{alreadyRegistered}</span>\n          {' '}\n          <a className=\"bold text-uppercase\" href=\"/login\" onClick={goToLogin}>{login}</a>\n        </div>\n\n        <OrEnterWith />\n\n        <SocialButtons socialLogin={socialLogin} />\n\n      </form>\n    </>\n  )\n}\n\nexport default RegisterTab\n"]},"metadata":{},"sourceType":"module"}