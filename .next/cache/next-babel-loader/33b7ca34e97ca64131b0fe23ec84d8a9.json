{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useContext, useEffect, useState } from \"react\";\nimport FormGroup from \"~/components/layout/AuthModal/FormGroup\";\nimport Label from \"~/components/Form/Label\";\nimport Input from \"~/components/layout/AuthModal/Input\";\nimport withAuth from \"~/components/withAuth\";\nimport InvalidFeedback from \"~/components/Form/InvalidFeedback\";\nimport { HAS_WINDOW } from \"~/constants/constants\";\nimport useScript from \"@charlietango/use-script\";\nimport Select from \"~/components/Select/Select\";\nimport Button from \"~/components/button\";\nimport MaskedInput from 'react-text-mask';\nimport UserContext from \"~/contexts/UserContext\";\nimport Router from \"next/router\";\nimport { ThemeContext } from \"styled-components\";\nimport Color from \"color\";\nimport { CONFIG } from '~/config';\nimport NameProject from \"~/components/NameProject\";\nimport { toast } from \"react-toastify\";\n\nconst Payment = ({\n  layoutProps,\n  userData,\n  package_id,\n  packages,\n  api,\n  requireds,\n  handleSubmit\n}) => {\n  const theme = useContext(ThemeContext);\n  const primaryColor = Color(theme.colors.primary).hsl().string();\n  const [ready, status] = useScript('https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js');\n  let selectedPackage = null;\n\n  if (packages && package_id) {\n    selectedPackage = packages.items.find(i => i.id == package_id);\n    console.log(selectedPackage);\n  }\n\n  const {\n    user\n  } = useContext(UserContext);\n  const {\n    0: error,\n    1: setError\n  } = useState({\n    errors: {}\n  });\n  const {\n    0: values,\n    1: setValues\n  } = useState({\n    package_id: '',\n    paymentMethodId: null,\n    payment_os: null,\n    cash_paymentMethodId: null,\n    terms: null,\n    discount_id: null,\n    cardNumber: null,\n    cardHolderName: null,\n    cardExpirationDate: null,\n    cardSecurityCode: null,\n    paymentMethodCode: null,\n    docType: \"CPF\",\n    docNumber: null\n  });\n  const {\n    0: cardImg,\n    1: setCardImg\n  } = useState(null);\n  const {\n    0: creditCard,\n    1: setCreditCard\n  } = useState(null);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState();\n  const businessUnitPublicKey = 'TEST-7205c1be-9805-4308-bf00-6557c5b56b88';\n  const {\n    0: isMercadoPagoReady,\n    1: setIsMercadoPagoReady\n  } = useState(false);\n  const MercadoPago = ready && HAS_WINDOW ? window.Mercadopago : null;\n  const credit_card_id = 1;\n  const debit_card_id = 2;\n  const isCardPayment = [credit_card_id, debit_card_id].includes(values.paymentMethodId);\n  const {\n    0: payMethods,\n    1: setPayMethods\n  } = useState();\n  useEffect(_ => {\n    if (MercadoPago) {\n      MercadoPago.setPublishableKey(businessUnitPublicKey);\n      setIsMercadoPagoReady(true);\n      setPayMethods(MercadoPago.getPaymentMethods());\n    }\n  }, [MercadoPago]);\n  /* handle payment method change */\n\n  function onPaymentChange(e) {\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      paymentMethodId: parseInt(e.target.value, 10),\n      cash_paymentMethodId: null\n    }));\n  }\n\n  function onCashPaymentMethodChange(e) {\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      cash_paymentMethodId: parseInt(e.target.value, 10)\n    }));\n  }\n\n  const handleInputChange = e => {\n    const {\n      checked,\n      name,\n      value,\n      type\n    } = e.target;\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      [name]: type === 'checkbox' ? checked ? value === 'true' ? true : value : false : value\n    }));\n  };\n\n  const handleInputChangeCreditCardNumber = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      [name]: value\n    }));\n    let cardnumber = value;\n\n    if (cardnumber.length >= 6) {\n      let bin = cardnumber.substring(0, 6);\n      MercadoPago.getPaymentMethod({\n        \"bin\": bin\n      }, (status, details) => {\n        if (details.length > 0) {\n          setCardImg(details[0].secure_thumbnail);\n          setCreditCard(details[0]);\n          setValues(_objectSpread(_objectSpread({}, values), {}, {\n            ['paymentMethodCode']: details[0].id,\n            ['cardNumber']: cardnumber\n          }));\n        }\n      });\n    }\n  }; // payment methods\n\n\n  const {\n    0: paymentMethods,\n    1: setPaymentMethods\n  } = useState(); // get payment methods\n\n  useEffect(_ => {\n    const getPaymentMethods = async _ => {\n      const {\n        data\n      } = await api.get('payment-methods');\n      setPaymentMethods(data);\n    };\n\n    getPaymentMethods();\n  }, []); // cash payment methods\n\n  const {\n    0: cashPaymentMethods,\n    1: setCashPaymentMethods\n  } = useState(); // get cash payment methods\n\n  useEffect(_ => {\n    const getCashPaymentMethods = async _ => {\n      const {\n        data\n      } = await api.get('cash-payment-methods');\n      setCashPaymentMethods(data);\n    };\n\n    getCashPaymentMethods();\n  }, []);\n\n  let payMethodsHtml = () => {\n    {\n      payMethods && payMethods.map((m, key) => {\n        return __jsx(\"div\", {\n          className: \"col-6 col-md\"\n        }, m.id);\n      });\n    }\n  };\n\n  const submitCredit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    let expirationMonth = values.cardExpirationDate.split('/')[0];\n    let expirationYear = values.cardExpirationDate.split('/')[1];\n    MercadoPago.createToken({\n      cardNumber: values.cardNumber,\n      cardholderName: values.cardHolderName,\n      cardExpirationMonth: expirationMonth,\n      cardExpirationYear: expirationYear,\n      securityCode: values.cardSecurityCode,\n      docType: values.docType,\n      docNumber: values.docNumber,\n      email: user.email\n    }, async (statusCode, response) => {\n      let token = \"\";\n\n      if (response && response.cause && response.cause.length > 0) {\n        let errors = [];\n\n        for (let error of response.cause) {\n          if (error.code === \"E301\") {\n            errors[\"cardNumber\"] = \"Há algo de errado com esse número. Digite novamente.\";\n          }\n\n          if (error.code === \"E302\") {\n            errors[\"cardSecurityCode\"] = \"Confira o código de segurança.\";\n          }\n\n          if (error.code === \"316\") {\n            error[\"cardHolderName\"] = \"Por favor, digite um nome válido.\";\n          }\n\n          if (error.code === \"324\") {\n            errors[\"docType\"] = \"Confira seu documento.\";\n          }\n\n          if (error.code === \"325\" || error.code === \"326\") {\n            errors[\"cardExpirationDate\"] = \"Confira a data.\";\n          }\n        }\n\n        setError({\n          errors: errors\n        });\n      }\n\n      try {\n        token = response.id;\n        const res = await api.post(`register/subscribe`, {\n          package_id: package_id,\n          payment_method_id: values.paymentMethodId,\n          payment_method_code: values.paymentMethodCode,\n          token: token\n        });\n        handleSubmit(4, null);\n      } catch (error) {\n        if (error.response) {\n          const {\n            data,\n            status\n          } = error.response;\n          MercadoPago.clearSession();\n          toast.error(data.message, {\n            delay: 500,\n            autoClose: 5000\n          });\n\n          if (status === 422) {\n            setError(data);\n          }\n        } else if (error.request) {\n          setError(error);\n        } else {\n          setError(error);\n        }\n      } finally {\n        setLoading(false);\n      }\n\n      setLoading(false);\n    }); // const data = { ...values, payment_os: paymentData }\n    //\n  }; // function appName() {\n  //   if (CONFIG.projectName) {\n  //     return <div style={ { display: 'inline-block' } }>\n  //       <strong className=\"text-primary\">{ CONFIG.projectName.split(' ')[0] }</strong>{ CONFIG.projectName.split(' ')[1] }\n  //     </div>\n  //   } else if (CONFIG.appName) {\n  //     return <div style={ { display: 'inline-block' } }>\n  //       <strong className=\"text-primary\">{ CONFIG.appName.split(' ')[0] }</strong>{ CONFIG.appName.split(' ')[1] }\n  //     </div>\n  //   }\n  //   return <div style={ { display: 'inline-block' } }>\n  //     <strong className=\"text-primary\">Project</strong>Name!\n  //   </div>\n  // }\n\n\n  return __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"register-confirm container text-center responsive\"\n  }, __jsx(\"h2\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"card-title text-center\"\n  }, __jsx(\"span\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"text-primary\"\n  }, \"\\xA1\"), \"S\\xE9 parte de \", __jsx(NameProject, null), __jsx(\"span\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"text-primary\"\n  }, \"!\")), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"row\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"col-md-6 paymentMethod\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"row\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"row w-100\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"paymentMethodId\",\n    style: \"margin: 0;\"\n  }, \"Pague com\"), __jsx(Select, {\n    id: \"paymentMethodId\",\n    name: \"paymentMethodId\",\n    required: requireds,\n    onChange: onPaymentChange,\n    value: values.paymentMethodId\n  }, __jsx(\"option\", {\n    value: \"0\",\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]])\n  }, \"Selecione\"), paymentMethods && paymentMethods.map((paymentMethod, key) => __jsx(\"option\", {\n    key: paymentMethod.id,\n    state: values.paymentMethodId,\n    value: paymentMethod.id,\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]])\n  }, paymentMethod.name))), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"paymentMethodId\"\n  })))), values.paymentMethodId == 1 && __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"row\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"cardHolderName\"\n  }, \"Nombre impreso en tarjeta\"), __jsx(Input, {\n    id: \"cardHolderName\",\n    name: \"cardHolderName\",\n    required: requireds,\n    type: \"text\",\n    onChange: handleInputChange\n  }))), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"cardNumber\"\n  }, \"Nro Cart\\xE3o\"), __jsx(\"img\", {\n    src: cardImg,\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"creditCardBrand\"\n  }), __jsx(MaskedInput, {\n    mask: [/\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/],\n    guide: false,\n    className: \"form-control\",\n    onChange: handleInputChangeCreditCardNumber,\n    id: \"cardNumber\",\n    name: \"cardNumber\"\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"cardNumber\"\n  }))), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"docNumber\"\n  }, \"Documento\"), __jsx(Input, {\n    className: \"form-control\",\n    onChange: handleInputChange,\n    id: \"docNumber\",\n    name: \"docNumber\",\n    maxLength: 20\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"docNumber\"\n  }))), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"col-6\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"card-duedate\"\n  }, \"Dt Vencimento\"), __jsx(MaskedInput, {\n    mask: [/\\d/, /\\d/, '/', /\\d/, /\\d/],\n    guide: false,\n    className: \"form-control\",\n    placeholder: \"MM/AA\",\n    name: \"cardExpirationDate\",\n    onChange: handleInputChange\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"cardExpirationDate\"\n  }))), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"col-6\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"card-cvv\"\n  }, \"CVV\"), __jsx(MaskedInput, {\n    mask: [/\\d/, /\\d/, /\\d/],\n    guide: false,\n    className: \"form-control\",\n    name: \"cardSecurityCode\",\n    onChange: handleInputChange,\n    placeholder: \"***\"\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"cardSecurityCode\"\n  }))), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"col-12\"\n  }, __jsx(Button, {\n    block: true,\n    color: \"secondary\",\n    type: \"button\",\n    disabled: loading,\n    loading: loading,\n    onClick: submitCredit\n  }, \"Pagar\"))), values.paymentMethodId == 3 && __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"row\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"col-12\"\n  }, __jsx(Button, {\n    block: true,\n    color: \"secondary\",\n    type: \"button\",\n    disabled: loading,\n    loading: loading,\n    onClick: submitCredit\n  }, \"Gerar Boleto\"))))), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"col-md-6\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"product-summary\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"product-image\"\n  }), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"product-name-group\"\n  }, __jsx(\"h6\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]])\n  }, \"Voc\\xEA est\\xE1 comprando:\"), __jsx(\"p\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"product-name\"\n  }, \"Assinatura - \", __jsx(\"strong\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]])\n  }, selectedPackage.name), \" recorrente\")), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"price-breakdown\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"checkout-total\"\n  }, __jsx(\"h6\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]])\n  }, \"Total\"), __jsx(\"p\", {\n    className: _JSXStyle.dynamic([[\"3006206827\", [primaryColor, primaryColor, primaryColor]]]) + \" \" + \"price\"\n  }, \"$ \", selectedPackage.amount)))))), __jsx(_JSXStyle, {\n    id: \"3006206827\",\n    dynamic: [primaryColor, primaryColor, primaryColor]\n  }, `.text-primary{color:${primaryColor} !important;}strong.text-primary{color:${primaryColor} !important;}h2.card-title{font-weight:normal;color:#000;margin-bottom:1em;font-size:1.7em;}.pay-methods{margin:32px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;}div.card-subtitle{font-size:1.1em;font-weight:500;margin-bottom:2.5em;}.text-primary{color:${primaryColor} !important;}.register-confirm{padding-top:50px;padding-bottom:50px;color:#666666;}@media(max-width:765px){.responsive{padding:20px 30px 15px 30px!important;padding:0px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;height:100%!importat;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;height:100%!important;}.card{background-color:rgba(255,255,255,0.85);}.card-body{background-image:url()!important;}label{display:inline-block;margin-bottom:.5rem;text-align:center;}.justify-content-end{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center!important;-webkit-justify-content:center!important;-ms-flex-pack:center!important;justify-content:center!important;}form{padding:0px!important;}.row{display:-ms-flexbox;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;margin-right:0px;margin-left:0px;}.col-8{max-width:100%!important;}.offset-3{margin-left:0px;}}\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9yYWZhZWwvUHJvamVjdHMvc29tb3NnYWQvZGFsZS9wYWdlcy9yZWdpc3Rlci93aXphcmQvcGF5bWVudC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFxYmdDLEFBSTBELEFBSUEsQUFLNUIsQUFPYixBQUtVLEFBTStCLEFBRzlCLEFBT3lCLEFBV0QsQUFNUCxBQU1ULEFBTVosQUFJVSxBQUdILEFBT0ksQUFHVCxZQWxFSixJQUtLLEFBOERoQixDQXJEb0IsRUFyQlQsQ0FnRUUsQ0FiVyxDQVV6QixHQVVDLEtBdEVrQixFQVlFLENBa0NyQixJQXpCZSxDQU9GLEVBWWIsQ0FXdUIsS0E3RHhCLEFBSUEsQUF1QkEsRUFoQmtCLEVBNEJILENBUGYsQ0FUQSxPQXVDSSxLQWxESixVQXNEbUMsWUFqRHBCLFFBeURNLG1CQUNELFdBbkNILE1Bb0NFLGFBMURuQixHQTJERSxtQ0FwQ3FCLHFCQUNDLFdBeUJ2Qix3RkF4QnNCLHNCQUVyQiIsImZpbGUiOiIvVXNlcnMvcmFmYWVsL1Byb2plY3RzL3NvbW9zZ2FkL2RhbGUvcGFnZXMvcmVnaXN0ZXIvd2l6YXJkL3BheW1lbnQuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgdXNlQ29udGV4dCwgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IEZvcm1Hcm91cCBmcm9tIFwifi9jb21wb25lbnRzL2xheW91dC9BdXRoTW9kYWwvRm9ybUdyb3VwXCI7XG5pbXBvcnQgTGFiZWwgZnJvbSBcIn4vY29tcG9uZW50cy9Gb3JtL0xhYmVsXCI7XG5pbXBvcnQgSW5wdXQgZnJvbSBcIn4vY29tcG9uZW50cy9sYXlvdXQvQXV0aE1vZGFsL0lucHV0XCI7XG5pbXBvcnQgd2l0aEF1dGggZnJvbSBcIn4vY29tcG9uZW50cy93aXRoQXV0aFwiO1xuaW1wb3J0IEludmFsaWRGZWVkYmFjayBmcm9tIFwifi9jb21wb25lbnRzL0Zvcm0vSW52YWxpZEZlZWRiYWNrXCJcbmltcG9ydCB7IEhBU19XSU5ET1cgfSBmcm9tIFwifi9jb25zdGFudHMvY29uc3RhbnRzXCI7XG5pbXBvcnQgdXNlU2NyaXB0IGZyb20gXCJAY2hhcmxpZXRhbmdvL3VzZS1zY3JpcHRcIjtcbmltcG9ydCBTZWxlY3QgZnJvbSBcIn4vY29tcG9uZW50cy9TZWxlY3QvU2VsZWN0XCI7XG5pbXBvcnQgQnV0dG9uIGZyb20gXCJ+L2NvbXBvbmVudHMvYnV0dG9uXCI7XG5pbXBvcnQgTWFza2VkSW5wdXQgZnJvbSAncmVhY3QtdGV4dC1tYXNrJ1xuaW1wb3J0IFVzZXJDb250ZXh0IGZyb20gXCJ+L2NvbnRleHRzL1VzZXJDb250ZXh0XCI7XG5pbXBvcnQgUm91dGVyIGZyb20gXCJuZXh0L3JvdXRlclwiO1xuaW1wb3J0IHsgVGhlbWVDb250ZXh0IH0gZnJvbSBcInN0eWxlZC1jb21wb25lbnRzXCI7XG5pbXBvcnQgQ29sb3IgZnJvbSBcImNvbG9yXCI7XG5pbXBvcnQgeyBDT05GSUcgfSBmcm9tICd+L2NvbmZpZydcbmltcG9ydCBOYW1lUHJvamVjdCBmcm9tIFwifi9jb21wb25lbnRzL05hbWVQcm9qZWN0XCI7XG5pbXBvcnQge3RvYXN0fSBmcm9tIFwicmVhY3QtdG9hc3RpZnlcIjtcblxuY29uc3QgUGF5bWVudCA9ICh7XG4gIGxheW91dFByb3BzLFxuICB1c2VyRGF0YSxcbiAgcGFja2FnZV9pZCxcbiAgcGFja2FnZXMsXG4gIGFwaSxcbiAgcmVxdWlyZWRzLFxuICBoYW5kbGVTdWJtaXRcbn0pID0+IHtcblxuICBjb25zdCB0aGVtZSA9IHVzZUNvbnRleHQoVGhlbWVDb250ZXh0KVxuICBjb25zdCBwcmltYXJ5Q29sb3IgPSBDb2xvcih0aGVtZS5jb2xvcnMucHJpbWFyeSkuaHNsKCkuc3RyaW5nKClcblxuICBjb25zdCBbcmVhZHksIHN0YXR1c10gPSB1c2VTY3JpcHQoJ2h0dHBzOi8vc2VjdXJlLm1sc3RhdGljLmNvbS9zZGsvamF2YXNjcmlwdC92MS9tZXJjYWRvcGFnby5qcycpXG5cblxuICBsZXQgc2VsZWN0ZWRQYWNrYWdlID0gbnVsbFxuICBpZiAocGFja2FnZXMgJiYgcGFja2FnZV9pZCkge1xuICAgIHNlbGVjdGVkUGFja2FnZSA9IHBhY2thZ2VzLml0ZW1zLmZpbmQoaSA9PiBpLmlkID09IHBhY2thZ2VfaWQpXG4gICAgY29uc29sZS5sb2coc2VsZWN0ZWRQYWNrYWdlKVxuICB9XG5cbiAgY29uc3QgeyB1c2VyIH0gPSB1c2VDb250ZXh0KFVzZXJDb250ZXh0KVxuICBjb25zdCBbZXJyb3IsIHNldEVycm9yXSA9IHVzZVN0YXRlKHtcbiAgICBlcnJvcnM6IHt9XG4gIH0pXG5cbiAgY29uc3QgW3ZhbHVlcywgc2V0VmFsdWVzXSA9IHVzZVN0YXRlKHtcbiAgICBwYWNrYWdlX2lkOiAnJyxcbiAgICBwYXltZW50TWV0aG9kSWQ6IG51bGwsXG4gICAgcGF5bWVudF9vczogbnVsbCxcbiAgICBjYXNoX3BheW1lbnRNZXRob2RJZDogbnVsbCxcbiAgICB0ZXJtczogbnVsbCxcbiAgICBkaXNjb3VudF9pZDogbnVsbCxcbiAgICBjYXJkTnVtYmVyOiBudWxsLFxuICAgIGNhcmRIb2xkZXJOYW1lOiBudWxsLFxuICAgIGNhcmRFeHBpcmF0aW9uRGF0ZTogbnVsbCxcbiAgICBjYXJkU2VjdXJpdHlDb2RlOiBudWxsLFxuICAgIHBheW1lbnRNZXRob2RDb2RlOiBudWxsLFxuICAgIGRvY1R5cGU6IFwiQ1BGXCIsXG4gICAgZG9jTnVtYmVyOiBudWxsLFxuICB9KVxuXG4gIGNvbnN0IFtjYXJkSW1nLCBzZXRDYXJkSW1nXSA9IHVzZVN0YXRlKG51bGwpO1xuICBjb25zdCBbY3JlZGl0Q2FyZCwgc2V0Q3JlZGl0Q2FyZF0gPSB1c2VTdGF0ZShudWxsKTtcblxuICBjb25zdCBbbG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZSgpO1xuXG4gIGNvbnN0IGJ1c2luZXNzVW5pdFB1YmxpY0tleSA9ICdURVNULTcyMDVjMWJlLTk4MDUtNDMwOC1iZjAwLTY1NTdjNWI1NmI4OCdcbiAgY29uc3QgW2lzTWVyY2Fkb1BhZ29SZWFkeSwgc2V0SXNNZXJjYWRvUGFnb1JlYWR5XSA9IHVzZVN0YXRlKGZhbHNlKVxuICBjb25zdCBNZXJjYWRvUGFnbyA9IHJlYWR5ICYmIEhBU19XSU5ET1cgPyB3aW5kb3cuTWVyY2Fkb3BhZ28gOiBudWxsXG5cbiAgY29uc3QgY3JlZGl0X2NhcmRfaWQgPSAxXG4gIGNvbnN0IGRlYml0X2NhcmRfaWQgPSAyXG4gIGNvbnN0IGlzQ2FyZFBheW1lbnQgPSBbY3JlZGl0X2NhcmRfaWQsIGRlYml0X2NhcmRfaWRdLmluY2x1ZGVzKHZhbHVlcy5wYXltZW50TWV0aG9kSWQpXG5cblxuICBjb25zdCBbcGF5TWV0aG9kcywgc2V0UGF5TWV0aG9kc10gPSB1c2VTdGF0ZSgpO1xuXG4gIHVzZUVmZmVjdChfID0+IHtcbiAgICBpZiAoTWVyY2Fkb1BhZ28pIHtcbiAgICAgIE1lcmNhZG9QYWdvLnNldFB1Ymxpc2hhYmxlS2V5KGJ1c2luZXNzVW5pdFB1YmxpY0tleSlcbiAgICAgIHNldElzTWVyY2Fkb1BhZ29SZWFkeSh0cnVlKVxuICAgICAgc2V0UGF5TWV0aG9kcyhNZXJjYWRvUGFnby5nZXRQYXltZW50TWV0aG9kcygpKTtcbiAgICB9XG4gIH0sIFtNZXJjYWRvUGFnb10pXG5cblxuICAvKiBoYW5kbGUgcGF5bWVudCBtZXRob2QgY2hhbmdlICovXG4gIGZ1bmN0aW9uIG9uUGF5bWVudENoYW5nZShlKSB7XG4gICAgc2V0VmFsdWVzKHtcbiAgICAgIC4uLnZhbHVlcyxcbiAgICAgIHBheW1lbnRNZXRob2RJZDogcGFyc2VJbnQoZS50YXJnZXQudmFsdWUsIDEwKSxcbiAgICAgIGNhc2hfcGF5bWVudE1ldGhvZElkOiBudWxsLFxuICAgIH0pXG4gIH1cblxuICBmdW5jdGlvbiBvbkNhc2hQYXltZW50TWV0aG9kQ2hhbmdlKGUpIHtcbiAgICBzZXRWYWx1ZXMoe1xuICAgICAgLi4udmFsdWVzLFxuICAgICAgY2FzaF9wYXltZW50TWV0aG9kSWQ6IHBhcnNlSW50KGUudGFyZ2V0LnZhbHVlLCAxMCksXG4gICAgfSlcbiAgfVxuXG4gIGNvbnN0IGhhbmRsZUlucHV0Q2hhbmdlID0gZSA9PiB7XG4gICAgY29uc3QgeyBjaGVja2VkLCBuYW1lLCB2YWx1ZSwgdHlwZSB9ID0gZS50YXJnZXRcbiAgICBzZXRWYWx1ZXMoe1xuICAgICAgLi4udmFsdWVzLFxuICAgICAgW25hbWVdOiB0eXBlID09PSAnY2hlY2tib3gnID9cbiAgICAgICAgKGNoZWNrZWQgPyAodmFsdWUgPT09ICd0cnVlJyA/IHRydWUgOiB2YWx1ZSkgOiBmYWxzZSkgOlxuICAgICAgICB2YWx1ZSxcbiAgICB9KVxuICB9XG5cbiAgY29uc3QgaGFuZGxlSW5wdXRDaGFuZ2VDcmVkaXRDYXJkTnVtYmVyID0gZSA9PiB7XG5cbiAgICBjb25zdCB7IG5hbWUsIHZhbHVlIH0gPSBlLnRhcmdldFxuXG5cbiAgICBzZXRWYWx1ZXMoe1xuICAgICAgLi4udmFsdWVzLFxuICAgICAgW25hbWVdOiB2YWx1ZSxcbiAgICB9KVxuXG4gICAgbGV0IGNhcmRudW1iZXIgPSB2YWx1ZTtcblxuICAgIGlmIChjYXJkbnVtYmVyLmxlbmd0aCA+PSA2KSB7XG4gICAgICBsZXQgYmluID0gY2FyZG51bWJlci5zdWJzdHJpbmcoMCwgNik7XG5cbiAgICAgIE1lcmNhZG9QYWdvLmdldFBheW1lbnRNZXRob2Qoe1xuICAgICAgICBcImJpblwiOiBiaW5cbiAgICAgIH0sIChzdGF0dXMsIGRldGFpbHMpID0+IHtcbiAgICAgICAgaWYgKGRldGFpbHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHNldENhcmRJbWcoZGV0YWlsc1swXS5zZWN1cmVfdGh1bWJuYWlsKTtcbiAgICAgICAgICBzZXRDcmVkaXRDYXJkKGRldGFpbHNbMF0pO1xuICAgICAgICAgIHNldFZhbHVlcyh7XG4gICAgICAgICAgICAuLi52YWx1ZXMsXG4gICAgICAgICAgICBbJ3BheW1lbnRNZXRob2RDb2RlJ106IGRldGFpbHNbMF0uaWQsXG4gICAgICAgICAgICBbJ2NhcmROdW1iZXInXTogY2FyZG51bWJlclxuICAgICAgICAgIH0pXG5cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICB9XG4gIH1cblxuICAvLyBwYXltZW50IG1ldGhvZHNcbiAgY29uc3QgW3BheW1lbnRNZXRob2RzLCBzZXRQYXltZW50TWV0aG9kc10gPSB1c2VTdGF0ZSgpXG5cbiAgLy8gZ2V0IHBheW1lbnQgbWV0aG9kc1xuICB1c2VFZmZlY3QoXyA9PiB7XG4gICAgY29uc3QgZ2V0UGF5bWVudE1ldGhvZHMgPSBhc3luYyBfID0+IHtcbiAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgYXBpLmdldCgncGF5bWVudC1tZXRob2RzJylcbiAgICAgIHNldFBheW1lbnRNZXRob2RzKGRhdGEpXG4gICAgfVxuICAgIGdldFBheW1lbnRNZXRob2RzKClcbiAgfSwgW10pXG5cblxuICAvLyBjYXNoIHBheW1lbnQgbWV0aG9kc1xuICBjb25zdCBbY2FzaFBheW1lbnRNZXRob2RzLCBzZXRDYXNoUGF5bWVudE1ldGhvZHNdID0gdXNlU3RhdGUoKVxuXG4gIC8vIGdldCBjYXNoIHBheW1lbnQgbWV0aG9kc1xuICB1c2VFZmZlY3QoXyA9PiB7XG4gICAgY29uc3QgZ2V0Q2FzaFBheW1lbnRNZXRob2RzID0gYXN5bmMgXyA9PiB7XG4gICAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGFwaS5nZXQoJ2Nhc2gtcGF5bWVudC1tZXRob2RzJylcbiAgICAgIHNldENhc2hQYXltZW50TWV0aG9kcyhkYXRhKVxuICAgIH1cbiAgICBnZXRDYXNoUGF5bWVudE1ldGhvZHMoKVxuICB9LCBbXSlcblxuICBsZXQgcGF5TWV0aG9kc0h0bWwgPSAoKSA9PiB7XG4gICAge1xuICAgICAgcGF5TWV0aG9kcyAmJiBwYXlNZXRob2RzLm1hcCgobSwga2V5KSA9PiB7XG4gICAgICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT1cImNvbC02IGNvbC1tZFwiPlxuICAgICAgICAgIHttLmlkfVxuICAgICAgICA8L2Rpdj5cbiAgICAgIH0pXG4gICAgfVxuICB9XG5cblxuICBjb25zdCBzdWJtaXRDcmVkaXQgPSBhc3luYyBlID0+IHtcblxuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIHNldExvYWRpbmcodHJ1ZSk7XG5cbiAgICBsZXQgZXhwaXJhdGlvbk1vbnRoID0gdmFsdWVzLmNhcmRFeHBpcmF0aW9uRGF0ZS5zcGxpdCgnLycpWzBdO1xuICAgIGxldCBleHBpcmF0aW9uWWVhciA9IHZhbHVlcy5jYXJkRXhwaXJhdGlvbkRhdGUuc3BsaXQoJy8nKVsxXTtcblxuICAgIE1lcmNhZG9QYWdvLmNyZWF0ZVRva2VuKHtcbiAgICAgIGNhcmROdW1iZXI6IHZhbHVlcy5jYXJkTnVtYmVyLFxuICAgICAgY2FyZGhvbGRlck5hbWU6IHZhbHVlcy5jYXJkSG9sZGVyTmFtZSxcbiAgICAgIGNhcmRFeHBpcmF0aW9uTW9udGg6IGV4cGlyYXRpb25Nb250aCxcbiAgICAgIGNhcmRFeHBpcmF0aW9uWWVhcjogZXhwaXJhdGlvblllYXIsXG4gICAgICBzZWN1cml0eUNvZGU6IHZhbHVlcy5jYXJkU2VjdXJpdHlDb2RlLFxuICAgICAgZG9jVHlwZTogdmFsdWVzLmRvY1R5cGUsXG4gICAgICBkb2NOdW1iZXI6IHZhbHVlcy5kb2NOdW1iZXIsXG4gICAgICBlbWFpbDogdXNlci5lbWFpbFxuICAgIH0sIGFzeW5jIChzdGF0dXNDb2RlLCByZXNwb25zZSkgPT4ge1xuXG4gICAgICBsZXQgdG9rZW4gPSBcIlwiO1xuXG4gICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2UuY2F1c2UgJiYgcmVzcG9uc2UuY2F1c2UubGVuZ3RoID4gMCkge1xuICAgICAgICBsZXQgZXJyb3JzID0gW107XG4gICAgICAgIGZvciAobGV0IGVycm9yIG9mIHJlc3BvbnNlLmNhdXNlKSB7XG4gICAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09IFwiRTMwMVwiKSB7XG4gICAgICAgICAgICBlcnJvcnNbXCJjYXJkTnVtYmVyXCJdID0gXCJIw6EgYWxnbyBkZSBlcnJhZG8gY29tIGVzc2UgbsO6bWVyby4gRGlnaXRlIG5vdmFtZW50ZS5cIlxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gXCJFMzAyXCIpIHtcbiAgICAgICAgICAgIGVycm9yc1tcImNhcmRTZWN1cml0eUNvZGVcIl0gPSBcIkNvbmZpcmEgbyBjw7NkaWdvIGRlIHNlZ3VyYW7Dp2EuXCJcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09IFwiMzE2XCIpIHtcbiAgICAgICAgICAgIGVycm9yW1wiY2FyZEhvbGRlck5hbWVcIl0gPSBcIlBvciBmYXZvciwgZGlnaXRlIHVtIG5vbWUgdsOhbGlkby5cIlxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gXCIzMjRcIikge1xuICAgICAgICAgICAgZXJyb3JzW1wiZG9jVHlwZVwiXSA9IFwiQ29uZmlyYSBzZXUgZG9jdW1lbnRvLlwiO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gXCIzMjVcIiB8fCBlcnJvci5jb2RlID09PSBcIjMyNlwiKSB7XG4gICAgICAgICAgICBlcnJvcnNbXCJjYXJkRXhwaXJhdGlvbkRhdGVcIl0gPSBcIkNvbmZpcmEgYSBkYXRhLlwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBzZXRFcnJvcih7XG4gICAgICAgICAgZXJyb3JzOiBlcnJvcnNcbiAgICAgICAgfSk7XG4gICAgICB9XG5cblxuICAgICAgdHJ5IHtcblxuICAgICAgICB0b2tlbiA9IHJlc3BvbnNlLmlkO1xuXG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaS5wb3N0KGByZWdpc3Rlci9zdWJzY3JpYmVgLCB7XG4gICAgICAgICAgcGFja2FnZV9pZDogcGFja2FnZV9pZCxcbiAgICAgICAgICBwYXltZW50X21ldGhvZF9pZDogdmFsdWVzLnBheW1lbnRNZXRob2RJZCxcbiAgICAgICAgICBwYXltZW50X21ldGhvZF9jb2RlOiB2YWx1ZXMucGF5bWVudE1ldGhvZENvZGUsXG4gICAgICAgICAgdG9rZW46IHRva2VuXG4gICAgICAgIH0pXG5cblxuICAgICAgICBoYW5kbGVTdWJtaXQoNCwgbnVsbCk7XG5cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG5cblxuICAgICAgICBpZiAoZXJyb3IucmVzcG9uc2UpIHtcblxuICAgICAgICAgIGNvbnN0IHsgZGF0YSwgc3RhdHVzIH0gPSBlcnJvci5yZXNwb25zZVxuXG4gICAgICAgICAgTWVyY2Fkb1BhZ28uY2xlYXJTZXNzaW9uKCk7XG5cbiAgICAgICAgICB0b2FzdC5lcnJvcihkYXRhLm1lc3NhZ2UsIHsgZGVsYXk6IDUwMCwgYXV0b0Nsb3NlOiA1MDAwIH0pXG5cbiAgICAgICAgICBpZiAoc3RhdHVzID09PSA0MjIpIHtcbiAgICAgICAgICAgIHNldEVycm9yKGRhdGEpXG4gICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSBpZiAoZXJyb3IucmVxdWVzdCkge1xuICAgICAgICAgIHNldEVycm9yKGVycm9yKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNldEVycm9yKGVycm9yKVxuICAgICAgICB9XG5cbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHNldExvYWRpbmcoZmFsc2UpXG4gICAgICB9XG5cblxuICAgICAgc2V0TG9hZGluZyhmYWxzZSk7XG5cbiAgICB9KTtcblxuXG4gICAgLy8gY29uc3QgZGF0YSA9IHsgLi4udmFsdWVzLCBwYXltZW50X29zOiBwYXltZW50RGF0YSB9XG4gICAgLy9cblxuICB9XG5cbiAgLy8gZnVuY3Rpb24gYXBwTmFtZSgpIHtcbiAgLy8gICBpZiAoQ09ORklHLnByb2plY3ROYW1lKSB7XG4gIC8vICAgICByZXR1cm4gPGRpdiBzdHlsZT17IHsgZGlzcGxheTogJ2lubGluZS1ibG9jaycgfSB9PlxuICAvLyAgICAgICA8c3Ryb25nIGNsYXNzTmFtZT1cInRleHQtcHJpbWFyeVwiPnsgQ09ORklHLnByb2plY3ROYW1lLnNwbGl0KCcgJylbMF0gfTwvc3Ryb25nPnsgQ09ORklHLnByb2plY3ROYW1lLnNwbGl0KCcgJylbMV0gfVxuICAvLyAgICAgPC9kaXY+XG4gIC8vICAgfSBlbHNlIGlmIChDT05GSUcuYXBwTmFtZSkge1xuICAvLyAgICAgcmV0dXJuIDxkaXYgc3R5bGU9eyB7IGRpc3BsYXk6ICdpbmxpbmUtYmxvY2snIH0gfT5cbiAgLy8gICAgICAgPHN0cm9uZyBjbGFzc05hbWU9XCJ0ZXh0LXByaW1hcnlcIj57IENPTkZJRy5hcHBOYW1lLnNwbGl0KCcgJylbMF0gfTwvc3Ryb25nPnsgQ09ORklHLmFwcE5hbWUuc3BsaXQoJyAnKVsxXSB9XG4gIC8vICAgICA8L2Rpdj5cbiAgLy8gICB9XG4gIC8vICAgcmV0dXJuIDxkaXYgc3R5bGU9eyB7IGRpc3BsYXk6ICdpbmxpbmUtYmxvY2snIH0gfT5cbiAgLy8gICAgIDxzdHJvbmcgY2xhc3NOYW1lPVwidGV4dC1wcmltYXJ5XCI+UHJvamVjdDwvc3Ryb25nPk5hbWUhXG4gIC8vICAgPC9kaXY+XG4gIC8vIH1cblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwicmVnaXN0ZXItY29uZmlybSBjb250YWluZXIgdGV4dC1jZW50ZXIgcmVzcG9uc2l2ZVwiPlxuXG4gICAgICA8aDIgY2xhc3NOYW1lPVwiY2FyZC10aXRsZSB0ZXh0LWNlbnRlclwiPjxzcGFuIGNsYXNzTmFtZT17IFwidGV4dC1wcmltYXJ5XCIgfT7CoTwvc3Bhbj5Tw6kgcGFydGUgZGUgeyA8TmFtZVByb2plY3QvPiB9XG4gICAgICAgIDxzcGFuIGNsYXNzTmFtZT17IFwidGV4dC1wcmltYXJ5XCIgfT4hPC9zcGFuPjwvaDI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cInJvd1wiPlxuXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sLW1kLTYgcGF5bWVudE1ldGhvZFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicm93XCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInJvdyB3LTEwMFwiPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC0xMlwiPlxuICAgICAgICAgICAgICAgIDxGb3JtR3JvdXA+XG4gICAgICAgICAgICAgICAgICA8TGFiZWwgaHRtbEZvcj1cInBheW1lbnRNZXRob2RJZFwiIHN0eWxlPVwibWFyZ2luOiAwO1wiPlBhZ3VlIGNvbTwvTGFiZWw+XG4gICAgICAgICAgICAgICAgICA8U2VsZWN0XG4gICAgICAgICAgICAgICAgICAgIGlkPVwicGF5bWVudE1ldGhvZElkXCJcbiAgICAgICAgICAgICAgICAgICAgbmFtZT1cInBheW1lbnRNZXRob2RJZFwiXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkPXtyZXF1aXJlZHN9XG4gICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtvblBheW1lbnRDaGFuZ2V9XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlPXt2YWx1ZXMucGF5bWVudE1ldGhvZElkfVxuICAgICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPVwiMFwiPlNlbGVjaW9uZTwvb3B0aW9uPlxuICAgICAgICAgICAgICAgICAgICB7cGF5bWVudE1ldGhvZHMgJiYgcGF5bWVudE1ldGhvZHMubWFwKChwYXltZW50TWV0aG9kLCBrZXkpID0+IChcbiAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBrZXk9e3BheW1lbnRNZXRob2QuaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZT17dmFsdWVzLnBheW1lbnRNZXRob2RJZH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlPXtwYXltZW50TWV0aG9kLmlkfVxuICAgICAgICAgICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICAgICAgICAgIHtwYXltZW50TWV0aG9kLm5hbWV9XG4gICAgICAgICAgICAgICAgICAgICAgPC9vcHRpb24+XG4gICAgICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICAgICAgPC9TZWxlY3Q+XG4gICAgICAgICAgICAgICAgICA8SW52YWxpZEZlZWRiYWNrIGVycm9yPXtlcnJvcn0gbG9hZGluZz17bG9hZGluZ30gbmFtZT1cInBheW1lbnRNZXRob2RJZFwiIC8+XG4gICAgICAgICAgICAgICAgPC9Gb3JtR3JvdXA+XG4gICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICB7dmFsdWVzLnBheW1lbnRNZXRob2RJZCA9PSAxICYmIChcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyb3dcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC0xMlwiPlxuICAgICAgICAgICAgICAgICAgPEZvcm1Hcm91cD5cbiAgICAgICAgICAgICAgICAgICAgPExhYmVsIGh0bWxGb3I9XCJjYXJkSG9sZGVyTmFtZVwiPk5vbWJyZSBpbXByZXNvIGVuIHRhcmpldGE8L0xhYmVsPlxuICAgICAgICAgICAgICAgICAgICA8SW5wdXQgaWQ9XCJjYXJkSG9sZGVyTmFtZVwiIG5hbWU9XCJjYXJkSG9sZGVyTmFtZVwiIHJlcXVpcmVkPXtyZXF1aXJlZHN9IHR5cGU9XCJ0ZXh0XCJcbiAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17aGFuZGxlSW5wdXRDaGFuZ2V9IC8+XG4gICAgICAgICAgICAgICAgICA8L0Zvcm1Hcm91cD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC0xMlwiPlxuICAgICAgICAgICAgICAgICAgPEZvcm1Hcm91cD5cbiAgICAgICAgICAgICAgICAgICAgPExhYmVsIGh0bWxGb3I9XCJjYXJkTnVtYmVyXCI+TnJvIENhcnTDo288L0xhYmVsPlxuICAgICAgICAgICAgICAgICAgICA8aW1nIHNyYz17Y2FyZEltZ30gY2xhc3NOYW1lPVwiY3JlZGl0Q2FyZEJyYW5kXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgPE1hc2tlZElucHV0XG4gICAgICAgICAgICAgICAgICAgICAgbWFzaz17Wy9cXGQvLCAvXFxkLywgL1xcZC8sIC9cXGQvLCAnICcsIC9cXGQvLCAvXFxkLywgL1xcZC8sIC9cXGQvLCAnICcsIC9cXGQvLCAvXFxkLywgL1xcZC8sIC9cXGQvLCAnICcsIC9cXGQvLCAvXFxkLywgL1xcZC8sIC9cXGQvXX1cbiAgICAgICAgICAgICAgICAgICAgICBndWlkZT17ZmFsc2V9XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcImZvcm0tY29udHJvbFwifVxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVJbnB1dENoYW5nZUNyZWRpdENhcmROdW1iZXJ9XG4gICAgICAgICAgICAgICAgICAgICAgaWQ9XCJjYXJkTnVtYmVyXCIgbmFtZT1cImNhcmROdW1iZXJcIlxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8SW52YWxpZEZlZWRiYWNrIGVycm9yPXtlcnJvcn0gbG9hZGluZz17bG9hZGluZ30gbmFtZT1cImNhcmROdW1iZXJcIiAvPlxuICAgICAgICAgICAgICAgICAgPC9Gb3JtR3JvdXA+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wtMTJcIj5cbiAgICAgICAgICAgICAgICAgIDxGb3JtR3JvdXA+XG4gICAgICAgICAgICAgICAgICAgIDxMYWJlbCBodG1sRm9yPVwiZG9jTnVtYmVyXCI+RG9jdW1lbnRvPC9MYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgPElucHV0XG4gICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtcImZvcm0tY29udHJvbFwifVxuICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVJbnB1dENoYW5nZX1cbiAgICAgICAgICAgICAgICAgICAgICBpZD1cImRvY051bWJlclwiIG5hbWU9XCJkb2NOdW1iZXJcIlxuICAgICAgICAgICAgICAgICAgICAgIG1heExlbmd0aD17MjB9XG4gICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDxJbnZhbGlkRmVlZGJhY2sgZXJyb3I9e2Vycm9yfSBsb2FkaW5nPXtsb2FkaW5nfSBuYW1lPVwiZG9jTnVtYmVyXCIgLz5cbiAgICAgICAgICAgICAgICAgIDwvRm9ybUdyb3VwPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sLTZcIj5cbiAgICAgICAgICAgICAgICAgIDxGb3JtR3JvdXA+XG4gICAgICAgICAgICAgICAgICAgIDxMYWJlbCBodG1sRm9yPVwiY2FyZC1kdWVkYXRlXCI+RHQgVmVuY2ltZW50bzwvTGFiZWw+XG4gICAgICAgICAgICAgICAgICAgIDxNYXNrZWRJbnB1dFxuICAgICAgICAgICAgICAgICAgICAgIG1hc2s9e1svXFxkLywgL1xcZC8sICcvJywgL1xcZC8sIC9cXGQvLF19XG4gICAgICAgICAgICAgICAgICAgICAgZ3VpZGU9e2ZhbHNlfVxuICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17XCJmb3JtLWNvbnRyb2xcIn1cbiAgICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcj17XCJNTS9BQVwifVxuICAgICAgICAgICAgICAgICAgICAgIG5hbWU9e1wiY2FyZEV4cGlyYXRpb25EYXRlXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e2hhbmRsZUlucHV0Q2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8SW52YWxpZEZlZWRiYWNrIGVycm9yPXtlcnJvcn0gbG9hZGluZz17bG9hZGluZ30gbmFtZT1cImNhcmRFeHBpcmF0aW9uRGF0ZVwiIC8+XG4gICAgICAgICAgICAgICAgICA8L0Zvcm1Hcm91cD5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC02XCI+XG4gICAgICAgICAgICAgICAgICA8Rm9ybUdyb3VwPlxuICAgICAgICAgICAgICAgICAgICA8TGFiZWwgaHRtbEZvcj1cImNhcmQtY3Z2XCI+Q1ZWPC9MYWJlbD5cbiAgICAgICAgICAgICAgICAgICAgPE1hc2tlZElucHV0XG4gICAgICAgICAgICAgICAgICAgICAgbWFzaz17Wy9cXGQvLCAvXFxkLywgL1xcZC9dfVxuICAgICAgICAgICAgICAgICAgICAgIGd1aWRlPXtmYWxzZX1cbiAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e1wiZm9ybS1jb250cm9sXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgbmFtZT17XCJjYXJkU2VjdXJpdHlDb2RlXCJ9XG4gICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U9e2hhbmRsZUlucHV0Q2hhbmdlfVxuICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtcIioqKlwifVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICA8SW52YWxpZEZlZWRiYWNrIGVycm9yPXtlcnJvcn0gbG9hZGluZz17bG9hZGluZ30gbmFtZT1cImNhcmRTZWN1cml0eUNvZGVcIiAvPlxuICAgICAgICAgICAgICAgICAgPC9Gb3JtR3JvdXA+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wtMTJcIj5cbiAgICAgICAgICAgICAgICAgIDxCdXR0b24gYmxvY2sgY29sb3I9XCJzZWNvbmRhcnlcIiB0eXBlPVwiYnV0dG9uXCIgZGlzYWJsZWQ9e2xvYWRpbmd9XG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmc9e2xvYWRpbmd9IG9uQ2xpY2s9e3N1Ym1pdENyZWRpdH0+UGFnYXI8L0J1dHRvbj5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApfVxuXG4gICAgICAgICAgICB7dmFsdWVzLnBheW1lbnRNZXRob2RJZCA9PSAzICYmIChcbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e1wicm93XCJ9PlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiY29sLTEyXCI+XG4gICAgICAgICAgICAgICAgICA8QnV0dG9uIGJsb2NrIGNvbG9yPVwic2Vjb25kYXJ5XCIgdHlwZT1cImJ1dHRvblwiIGRpc2FibGVkPXtsb2FkaW5nfVxuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nPXtsb2FkaW5nfSBvbkNsaWNrPXtzdWJtaXRDcmVkaXR9PkdlcmFyIEJvbGV0bzwvQnV0dG9uPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wtbWQtNlwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicHJvZHVjdC1zdW1tYXJ5XCI+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInByb2R1Y3QtaW1hZ2VcIj5cbiAgICAgICAgICAgICAgey8qPGltZyBzcmM9XCIvc3RhdGljL2xhdS9zdWJzL3BsYW5faGVyby5wbmdcIiBhbHQ9XCJcIiAvPiovfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17XCJwcm9kdWN0LW5hbWUtZ3JvdXBcIn0+XG4gICAgICAgICAgICAgIDxoNj5cbiAgICAgICAgICAgICAgICBWb2PDqiBlc3TDoSBjb21wcmFuZG86XG4gICAgICAgICAgICAgIDwvaDY+XG4gICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT17XCJwcm9kdWN0LW5hbWVcIn0+XG4gICAgICAgICAgICAgICAgQXNzaW5hdHVyYSAtIDxzdHJvbmc+e3NlbGVjdGVkUGFja2FnZS5uYW1lfTwvc3Ryb25nPiByZWNvcnJlbnRlXG4gICAgICAgICAgICAgIDwvcD5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e1wicHJpY2UtYnJlYWtkb3duXCJ9PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNoZWNrb3V0LXRvdGFsXCI+XG4gICAgICAgICAgICAgICAgPGg2PlxuICAgICAgICAgICAgICAgICAgVG90YWxcbiAgICAgICAgICAgICAgICA8L2g2PlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzTmFtZT17XCJwcmljZVwifT5cbiAgICAgICAgICAgICAgICAgICQge3NlbGVjdGVkUGFja2FnZS5hbW91bnR9XG4gICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgICAgPHN0eWxlIGpzeCBnbG9iYWw9e3RydWV9PntgXG5cbiAgICAgICAgLnRleHQtcHJpbWFyeSB7XG4gICAgICAgICAgIGNvbG9yOiAkeyBwcmltYXJ5Q29sb3J9ICFpbXBvcnRhbnQ7XG4gICAgICAgIH1cblxuICAgICAgICBzdHJvbmcudGV4dC1wcmltYXJ5IHtcbiAgICAgICAgICAgY29sb3I6ICR7IHByaW1hcnlDb2xvciB9ICFpbXBvcnRhbnQ7XG4gICAgICAgIH1cblxuXG4gICAgICAgIGgyLmNhcmQtdGl0bGUge1xuICAgICAgICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7XG4gICAgICAgICAgY29sb3I6ICMwMDA7XG4gICAgICAgICAgbWFyZ2luLWJvdHRvbTogMWVtO1xuICAgICAgICAgIGZvbnQtc2l6ZTogMS43ZW07XG4gICAgICAgIH1cblxuICAgICAgIC5wYXktbWV0aG9kcyB7XG4gICAgbWFyZ2luOiAzMnB4O1xuICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICBmbGV4LXdyYXA6IHdyYXA7XG4gICAgICAgIH1cbiAgICAgICAgZGl2LmNhcmQtc3VidGl0bGUge1xuICAgICAgICAgIGZvbnQtc2l6ZTogMS4xZW07XG4gICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgICAgICAgICBtYXJnaW4tYm90dG9tOiAyLjVlbTtcbiAgICAgICAgfVxuXG4gICAgICAgIC50ZXh0LXByaW1hcnkge1xuICAgICAgICAgICBjb2xvcjogJHsgcHJpbWFyeUNvbG9yfSAhaW1wb3J0YW50O1xuICAgICAgICB9XG4gICAgICAgIC5yZWdpc3Rlci1jb25maXJtIHtcbiAgICAgICAgICBwYWRkaW5nLXRvcDogNTBweDtcbiAgICAgICAgICBwYWRkaW5nLWJvdHRvbTogNTBweDtcbiAgICAgICAgICBjb2xvcjogIzY2NjY2NjtcbiAgICAgICAgfVxuICAgICAgICAgQG1lZGlhKG1heC13aWR0aDogNzY1cHgpIHtcblxuICAgICAgICAucmVzcG9uc2l2ZXtcbiAgICAgICAgICAgICAgcGFkZGluZzogMjBweCAzMHB4IDE1cHggMzBweCFpbXBvcnRhbnQ7XG4gICAgICAgICAgLy8gcGFkZGluZzogNDBweCFpbXBvcnRhbnQ7XG4gICAgICAgICAgcGFkZGluZzogMHB4O1xuICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgZmxleC13cmFwOiB3cmFwO1xuICAgICAgICAgIGhlaWdodDogMTAwJSFpbXBvcnRhdDtcbiAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgIGhlaWdodDoxMDAlIWltcG9ydGFudDtcblxuICAgICAgICAgIH1cbiAgICAgICAgIC5jYXJke1xuICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI1NSwyNTUsMjU1LDAuODUpO1xuICAgICAgICAgIC8vICBoZWlnaHQ6MTAwJSFpbXBvcnRhbnQ7XG5cbiAgICAgICAgIH1cblxuICAgICAgICAgIC5jYXJkLWJvZHl7XG4gICAgICAgICAgIGJhY2tncm91bmQtaW1hZ2U6IHVybCgpIWltcG9ydGFudDtcbiAgICAgICAgICAvLyAgaGVpZ2h0OjEwMCUhaW1wb3J0YW50O1xuXG4gICAgICAgICB9XG5cbiAgICAgICAgIGxhYmVsIHtcbiAgICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAuNXJlbTtcbiAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAuanVzdGlmeS1jb250ZW50LWVuZCB7XG4gICAgICAgICAgIGRpc3BsYXk6ZmxleDtcbiAgICAgICAgICAganVzdGlmeS1jb250ZW50OmNlbnRlciFpbXBvcnRhbnQ7XG4gICAgICAgICB9XG4gICAgICAgICBmb3Jte1xuICAgICAgICAgICBwYWRkaW5nOiAwcHghaW1wb3J0YW50O1xuICAgICAgICAgfVxuICAgICAgICAgLnJvdyB7XG4gICAgICAgICAgZGlzcGxheTogLW1zLWZsZXhib3g7XG4gICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAtbXMtZmxleC13cmFwOiB3cmFwO1xuICAgICAgICAgICBtYXJnaW4tcmlnaHQ6IDBweDtcbiAgICAgICAgICAgbWFyZ2luLWxlZnQ6IDBweDtcbiAgICAgICAgICB9XG4gICAgICAgIC5jb2wtOCB7XG4gICAgICAgICBtYXgtd2lkdGg6IDEwMCUhaW1wb3J0YW50O1xuICAgICAgICAgIH1cbiAgICAgICAgIC5vZmZzZXQtM3tcbiAgICAgICAgICBtYXJnaW4tbGVmdDowcHg7XG4gICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuXG4gICAgICBgIH08L3N0eWxlPlxuICAgIDwvZGl2PlxuXG4gIClcbn1cblxuZXhwb3J0IGRlZmF1bHQgd2l0aEF1dGgoUGF5bWVudCwgdHJ1ZSk7XG4iXX0= */\n/*@ sourceURL=/Users/rafael/Projects/somosgad/dale/pages/register/wizard/payment.js */`));\n};\n\nexport default withAuth(Payment, true);","map":{"version":3,"sources":["/Users/rafael/Projects/somosgad/dale/pages/register/wizard/payment.js"],"names":["React","useContext","useEffect","useState","FormGroup","Label","Input","withAuth","InvalidFeedback","HAS_WINDOW","useScript","Select","Button","MaskedInput","UserContext","Router","ThemeContext","Color","CONFIG","NameProject","toast","Payment","layoutProps","userData","package_id","packages","api","requireds","handleSubmit","theme","primaryColor","colors","primary","hsl","string","ready","status","selectedPackage","items","find","i","id","console","log","user","error","setError","errors","values","setValues","paymentMethodId","payment_os","cash_paymentMethodId","terms","discount_id","cardNumber","cardHolderName","cardExpirationDate","cardSecurityCode","paymentMethodCode","docType","docNumber","cardImg","setCardImg","creditCard","setCreditCard","loading","setLoading","businessUnitPublicKey","isMercadoPagoReady","setIsMercadoPagoReady","MercadoPago","window","Mercadopago","credit_card_id","debit_card_id","isCardPayment","includes","payMethods","setPayMethods","_","setPublishableKey","getPaymentMethods","onPaymentChange","e","parseInt","target","value","onCashPaymentMethodChange","handleInputChange","checked","name","type","handleInputChangeCreditCardNumber","cardnumber","length","bin","substring","getPaymentMethod","details","secure_thumbnail","paymentMethods","setPaymentMethods","data","get","cashPaymentMethods","setCashPaymentMethods","getCashPaymentMethods","payMethodsHtml","map","m","key","submitCredit","preventDefault","expirationMonth","split","expirationYear","createToken","cardholderName","cardExpirationMonth","cardExpirationYear","securityCode","email","statusCode","response","token","cause","code","res","post","payment_method_id","payment_method_code","clearSession","message","delay","autoClose","request","paymentMethod","amount"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,UAAhB,EAA4BC,SAA5B,EAAuCC,QAAvC,QAAuD,OAAvD;AACA,OAAOC,SAAP,MAAsB,yCAAtB;AACA,OAAOC,KAAP,MAAkB,yBAAlB;AACA,OAAOC,KAAP,MAAkB,qCAAlB;AACA,OAAOC,QAAP,MAAqB,uBAArB;AACA,OAAOC,eAAP,MAA4B,mCAA5B;AACA,SAASC,UAAT,QAA2B,uBAA3B;AACA,OAAOC,SAAP,MAAsB,0BAAtB;AACA,OAAOC,MAAP,MAAmB,4BAAnB;AACA,OAAOC,MAAP,MAAmB,qBAAnB;AACA,OAAOC,WAAP,MAAwB,iBAAxB;AACA,OAAOC,WAAP,MAAwB,wBAAxB;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,SAASC,YAAT,QAA6B,mBAA7B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,MAAT,QAAuB,UAAvB;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AACA,SAAQC,KAAR,QAAoB,gBAApB;;AAEA,MAAMC,OAAO,GAAG,CAAC;AACfC,EAAAA,WADe;AAEfC,EAAAA,QAFe;AAGfC,EAAAA,UAHe;AAIfC,EAAAA,QAJe;AAKfC,EAAAA,GALe;AAMfC,EAAAA,SANe;AAOfC,EAAAA;AAPe,CAAD,KAQV;AAEJ,QAAMC,KAAK,GAAG5B,UAAU,CAACe,YAAD,CAAxB;AACA,QAAMc,YAAY,GAAGb,KAAK,CAACY,KAAK,CAACE,MAAN,CAAaC,OAAd,CAAL,CAA4BC,GAA5B,GAAkCC,MAAlC,EAArB;AAEA,QAAM,CAACC,KAAD,EAAQC,MAAR,IAAkB1B,SAAS,CAAC,8DAAD,CAAjC;AAGA,MAAI2B,eAAe,GAAG,IAAtB;;AACA,MAAIZ,QAAQ,IAAID,UAAhB,EAA4B;AAC1Ba,IAAAA,eAAe,GAAGZ,QAAQ,CAACa,KAAT,CAAeC,IAAf,CAAoBC,CAAC,IAAIA,CAAC,CAACC,EAAF,IAAQjB,UAAjC,CAAlB;AACAkB,IAAAA,OAAO,CAACC,GAAR,CAAYN,eAAZ;AACD;;AAED,QAAM;AAAEO,IAAAA;AAAF,MAAW3C,UAAU,CAACa,WAAD,CAA3B;AACA,QAAM;AAAA,OAAC+B,KAAD;AAAA,OAAQC;AAAR,MAAoB3C,QAAQ,CAAC;AACjC4C,IAAAA,MAAM,EAAE;AADyB,GAAD,CAAlC;AAIA,QAAM;AAAA,OAACC,MAAD;AAAA,OAASC;AAAT,MAAsB9C,QAAQ,CAAC;AACnCqB,IAAAA,UAAU,EAAE,EADuB;AAEnC0B,IAAAA,eAAe,EAAE,IAFkB;AAGnCC,IAAAA,UAAU,EAAE,IAHuB;AAInCC,IAAAA,oBAAoB,EAAE,IAJa;AAKnCC,IAAAA,KAAK,EAAE,IAL4B;AAMnCC,IAAAA,WAAW,EAAE,IANsB;AAOnCC,IAAAA,UAAU,EAAE,IAPuB;AAQnCC,IAAAA,cAAc,EAAE,IARmB;AASnCC,IAAAA,kBAAkB,EAAE,IATe;AAUnCC,IAAAA,gBAAgB,EAAE,IAViB;AAWnCC,IAAAA,iBAAiB,EAAE,IAXgB;AAYnCC,IAAAA,OAAO,EAAE,KAZ0B;AAanCC,IAAAA,SAAS,EAAE;AAbwB,GAAD,CAApC;AAgBA,QAAM;AAAA,OAACC,OAAD;AAAA,OAAUC;AAAV,MAAwB5D,QAAQ,CAAC,IAAD,CAAtC;AACA,QAAM;AAAA,OAAC6D,UAAD;AAAA,OAAaC;AAAb,MAA8B9D,QAAQ,CAAC,IAAD,CAA5C;AAEA,QAAM;AAAA,OAAC+D,OAAD;AAAA,OAAUC;AAAV,MAAwBhE,QAAQ,EAAtC;AAEA,QAAMiE,qBAAqB,GAAG,2CAA9B;AACA,QAAM;AAAA,OAACC,kBAAD;AAAA,OAAqBC;AAArB,MAA8CnE,QAAQ,CAAC,KAAD,CAA5D;AACA,QAAMoE,WAAW,GAAGpC,KAAK,IAAI1B,UAAT,GAAsB+D,MAAM,CAACC,WAA7B,GAA2C,IAA/D;AAEA,QAAMC,cAAc,GAAG,CAAvB;AACA,QAAMC,aAAa,GAAG,CAAtB;AACA,QAAMC,aAAa,GAAG,CAACF,cAAD,EAAiBC,aAAjB,EAAgCE,QAAhC,CAAyC7B,MAAM,CAACE,eAAhD,CAAtB;AAGA,QAAM;AAAA,OAAC4B,UAAD;AAAA,OAAaC;AAAb,MAA8B5E,QAAQ,EAA5C;AAEAD,EAAAA,SAAS,CAAC8E,CAAC,IAAI;AACb,QAAIT,WAAJ,EAAiB;AACfA,MAAAA,WAAW,CAACU,iBAAZ,CAA8Bb,qBAA9B;AACAE,MAAAA,qBAAqB,CAAC,IAAD,CAArB;AACAS,MAAAA,aAAa,CAACR,WAAW,CAACW,iBAAZ,EAAD,CAAb;AACD;AACF,GANQ,EAMN,CAACX,WAAD,CANM,CAAT;AASA;;AACA,WAASY,eAAT,CAAyBC,CAAzB,EAA4B;AAC1BnC,IAAAA,SAAS,iCACJD,MADI;AAEPE,MAAAA,eAAe,EAAEmC,QAAQ,CAACD,CAAC,CAACE,MAAF,CAASC,KAAV,EAAiB,EAAjB,CAFlB;AAGPnC,MAAAA,oBAAoB,EAAE;AAHf,OAAT;AAKD;;AAED,WAASoC,yBAAT,CAAmCJ,CAAnC,EAAsC;AACpCnC,IAAAA,SAAS,iCACJD,MADI;AAEPI,MAAAA,oBAAoB,EAAEiC,QAAQ,CAACD,CAAC,CAACE,MAAF,CAASC,KAAV,EAAiB,EAAjB;AAFvB,OAAT;AAID;;AAED,QAAME,iBAAiB,GAAGL,CAAC,IAAI;AAC7B,UAAM;AAAEM,MAAAA,OAAF;AAAWC,MAAAA,IAAX;AAAiBJ,MAAAA,KAAjB;AAAwBK,MAAAA;AAAxB,QAAiCR,CAAC,CAACE,MAAzC;AACArC,IAAAA,SAAS,iCACJD,MADI;AAEP,OAAC2C,IAAD,GAAQC,IAAI,KAAK,UAAT,GACLF,OAAO,GAAIH,KAAK,KAAK,MAAV,GAAmB,IAAnB,GAA0BA,KAA9B,GAAuC,KADzC,GAENA;AAJK,OAAT;AAMD,GARD;;AAUA,QAAMM,iCAAiC,GAAGT,CAAC,IAAI;AAE7C,UAAM;AAAEO,MAAAA,IAAF;AAAQJ,MAAAA;AAAR,QAAkBH,CAAC,CAACE,MAA1B;AAGArC,IAAAA,SAAS,iCACJD,MADI;AAEP,OAAC2C,IAAD,GAAQJ;AAFD,OAAT;AAKA,QAAIO,UAAU,GAAGP,KAAjB;;AAEA,QAAIO,UAAU,CAACC,MAAX,IAAqB,CAAzB,EAA4B;AAC1B,UAAIC,GAAG,GAAGF,UAAU,CAACG,SAAX,CAAqB,CAArB,EAAwB,CAAxB,CAAV;AAEA1B,MAAAA,WAAW,CAAC2B,gBAAZ,CAA6B;AAC3B,eAAOF;AADoB,OAA7B,EAEG,CAAC5D,MAAD,EAAS+D,OAAT,KAAqB;AACtB,YAAIA,OAAO,CAACJ,MAAR,GAAiB,CAArB,EAAwB;AACtBhC,UAAAA,UAAU,CAACoC,OAAO,CAAC,CAAD,CAAP,CAAWC,gBAAZ,CAAV;AACAnC,UAAAA,aAAa,CAACkC,OAAO,CAAC,CAAD,CAAR,CAAb;AACAlD,UAAAA,SAAS,iCACJD,MADI;AAEP,aAAC,mBAAD,GAAuBmD,OAAO,CAAC,CAAD,CAAP,CAAW1D,EAF3B;AAGP,aAAC,YAAD,GAAgBqD;AAHT,aAAT;AAMD;AACF,OAbD;AAeD;AACF,GA/BD,CAtFI,CAuHJ;;;AACA,QAAM;AAAA,OAACO,cAAD;AAAA,OAAiBC;AAAjB,MAAsCnG,QAAQ,EAApD,CAxHI,CA0HJ;;AACAD,EAAAA,SAAS,CAAC8E,CAAC,IAAI;AACb,UAAME,iBAAiB,GAAG,MAAMF,CAAN,IAAW;AACnC,YAAM;AAAEuB,QAAAA;AAAF,UAAW,MAAM7E,GAAG,CAAC8E,GAAJ,CAAQ,iBAAR,CAAvB;AACAF,MAAAA,iBAAiB,CAACC,IAAD,CAAjB;AACD,KAHD;;AAIArB,IAAAA,iBAAiB;AAClB,GANQ,EAMN,EANM,CAAT,CA3HI,CAoIJ;;AACA,QAAM;AAAA,OAACuB,kBAAD;AAAA,OAAqBC;AAArB,MAA8CvG,QAAQ,EAA5D,CArII,CAuIJ;;AACAD,EAAAA,SAAS,CAAC8E,CAAC,IAAI;AACb,UAAM2B,qBAAqB,GAAG,MAAM3B,CAAN,IAAW;AACvC,YAAM;AAAEuB,QAAAA;AAAF,UAAW,MAAM7E,GAAG,CAAC8E,GAAJ,CAAQ,sBAAR,CAAvB;AACAE,MAAAA,qBAAqB,CAACH,IAAD,CAArB;AACD,KAHD;;AAIAI,IAAAA,qBAAqB;AACtB,GANQ,EAMN,EANM,CAAT;;AAQA,MAAIC,cAAc,GAAG,MAAM;AACzB;AACE9B,MAAAA,UAAU,IAAIA,UAAU,CAAC+B,GAAX,CAAe,CAACC,CAAD,EAAIC,GAAJ,KAAY;AACvC,eAAO;AAAK,UAAA,SAAS,EAAC;AAAf,WACJD,CAAC,CAACrE,EADE,CAAP;AAGD,OAJa,CAAd;AAKD;AACF,GARD;;AAWA,QAAMuE,YAAY,GAAG,MAAM5B,CAAN,IAAW;AAE9BA,IAAAA,CAAC,CAAC6B,cAAF;AAEA9C,IAAAA,UAAU,CAAC,IAAD,CAAV;AAEA,QAAI+C,eAAe,GAAGlE,MAAM,CAACS,kBAAP,CAA0B0D,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,CAAtB;AACA,QAAIC,cAAc,GAAGpE,MAAM,CAACS,kBAAP,CAA0B0D,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,CAArB;AAEA5C,IAAAA,WAAW,CAAC8C,WAAZ,CAAwB;AACtB9D,MAAAA,UAAU,EAAEP,MAAM,CAACO,UADG;AAEtB+D,MAAAA,cAAc,EAAEtE,MAAM,CAACQ,cAFD;AAGtB+D,MAAAA,mBAAmB,EAAEL,eAHC;AAItBM,MAAAA,kBAAkB,EAAEJ,cAJE;AAKtBK,MAAAA,YAAY,EAAEzE,MAAM,CAACU,gBALC;AAMtBE,MAAAA,OAAO,EAAEZ,MAAM,CAACY,OANM;AAOtBC,MAAAA,SAAS,EAAEb,MAAM,CAACa,SAPI;AAQtB6D,MAAAA,KAAK,EAAE9E,IAAI,CAAC8E;AARU,KAAxB,EASG,OAAOC,UAAP,EAAmBC,QAAnB,KAAgC;AAEjC,UAAIC,KAAK,GAAG,EAAZ;;AAEA,UAAID,QAAQ,IAAIA,QAAQ,CAACE,KAArB,IAA8BF,QAAQ,CAACE,KAAT,CAAe/B,MAAf,GAAwB,CAA1D,EAA6D;AAC3D,YAAIhD,MAAM,GAAG,EAAb;;AACA,aAAK,IAAIF,KAAT,IAAkB+E,QAAQ,CAACE,KAA3B,EAAkC;AAChC,cAAIjF,KAAK,CAACkF,IAAN,KAAe,MAAnB,EAA2B;AACzBhF,YAAAA,MAAM,CAAC,YAAD,CAAN,GAAuB,sDAAvB;AACD;;AACD,cAAIF,KAAK,CAACkF,IAAN,KAAe,MAAnB,EAA2B;AACzBhF,YAAAA,MAAM,CAAC,kBAAD,CAAN,GAA6B,gCAA7B;AACD;;AACD,cAAIF,KAAK,CAACkF,IAAN,KAAe,KAAnB,EAA0B;AACxBlF,YAAAA,KAAK,CAAC,gBAAD,CAAL,GAA0B,mCAA1B;AACD;;AACD,cAAIA,KAAK,CAACkF,IAAN,KAAe,KAAnB,EAA0B;AACxBhF,YAAAA,MAAM,CAAC,SAAD,CAAN,GAAoB,wBAApB;AACD;;AACD,cAAIF,KAAK,CAACkF,IAAN,KAAe,KAAf,IAAwBlF,KAAK,CAACkF,IAAN,KAAe,KAA3C,EAAkD;AAChDhF,YAAAA,MAAM,CAAC,oBAAD,CAAN,GAA+B,iBAA/B;AACD;AACF;;AACDD,QAAAA,QAAQ,CAAC;AACPC,UAAAA,MAAM,EAAEA;AADD,SAAD,CAAR;AAGD;;AAGD,UAAI;AAEF8E,QAAAA,KAAK,GAAGD,QAAQ,CAACnF,EAAjB;AAEA,cAAMuF,GAAG,GAAG,MAAMtG,GAAG,CAACuG,IAAJ,CAAU,oBAAV,EAA+B;AAC/CzG,UAAAA,UAAU,EAAEA,UADmC;AAE/C0G,UAAAA,iBAAiB,EAAElF,MAAM,CAACE,eAFqB;AAG/CiF,UAAAA,mBAAmB,EAAEnF,MAAM,CAACW,iBAHmB;AAI/CkE,UAAAA,KAAK,EAAEA;AAJwC,SAA/B,CAAlB;AAQAjG,QAAAA,YAAY,CAAC,CAAD,EAAI,IAAJ,CAAZ;AAED,OAdD,CAcE,OAAOiB,KAAP,EAAc;AAGd,YAAIA,KAAK,CAAC+E,QAAV,EAAoB;AAElB,gBAAM;AAAErB,YAAAA,IAAF;AAAQnE,YAAAA;AAAR,cAAmBS,KAAK,CAAC+E,QAA/B;AAEArD,UAAAA,WAAW,CAAC6D,YAAZ;AAEAhH,UAAAA,KAAK,CAACyB,KAAN,CAAY0D,IAAI,CAAC8B,OAAjB,EAA0B;AAAEC,YAAAA,KAAK,EAAE,GAAT;AAAcC,YAAAA,SAAS,EAAE;AAAzB,WAA1B;;AAEA,cAAInG,MAAM,KAAK,GAAf,EAAoB;AAClBU,YAAAA,QAAQ,CAACyD,IAAD,CAAR;AACD;AAEF,SAZD,MAYO,IAAI1D,KAAK,CAAC2F,OAAV,EAAmB;AACxB1F,UAAAA,QAAQ,CAACD,KAAD,CAAR;AACD,SAFM,MAEA;AACLC,UAAAA,QAAQ,CAACD,KAAD,CAAR;AACD;AAEF,OAnCD,SAmCU;AACRsB,QAAAA,UAAU,CAAC,KAAD,CAAV;AACD;;AAGDA,MAAAA,UAAU,CAAC,KAAD,CAAV;AAED,KAhFD,EAT8B,CA4F9B;AACA;AAED,GA/FD,CA3JI,CA4PJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEA,SACE;AAAA,kDAiJiBrC,YAjJjB,EAqJiBA,YArJjB,EA4KiBA,YA5KjB,aAAe;AAAf,KAEE;AAAA,kDA+IeA,YA/If,EAmJeA,YAnJf,EA0KeA,YA1Kf,aAAc;AAAd,KAAuC;AAAA,kDA+IxBA,YA/IwB,EAmJxBA,YAnJwB,EA0KxBA,YA1KwB,aAAkB;AAAlB,YAAvC,qBAAgG,MAAC,WAAD,OAAhG,EACE;AAAA,kDA8IaA,YA9Ib,EAkJaA,YAlJb,EAyKaA,YAzKb,aAAkB;AAAlB,SADF,CAFF,EAIE;AAAA,kDA6IeA,YA7If,EAiJeA,YAjJf,EAwKeA,YAxKf,aAAe;AAAf,KAEE;AAAA,kDA2IaA,YA3Ib,EA+IaA,YA/Ib,EAsKaA,YAtKb,aAAe;AAAf,KACE;AAAA,kDA0IWA,YA1IX,EA8IWA,YA9IX,EAqKWA,YArKX,aAAe;AAAf,KACE;AAAA,kDAyISA,YAzIT,EA6ISA,YA7IT,EAoKSA,YApKT,aAAe;AAAf,KACE;AAAA,kDAwIOA,YAxIP,EA4IOA,YA5IP,EAmKOA,YAnKP,aAAe;AAAf,KACE,MAAC,SAAD,QACE,MAAC,KAAD;AAAO,IAAA,OAAO,EAAC,iBAAf;AAAiC,IAAA,KAAK,EAAC;AAAvC,iBADF,EAEE,MAAC,MAAD;AACE,IAAA,EAAE,EAAC,iBADL;AAEE,IAAA,IAAI,EAAC,iBAFP;AAGE,IAAA,QAAQ,EAAEH,SAHZ;AAIE,IAAA,QAAQ,EAAEwD,eAJZ;AAKE,IAAA,KAAK,EAAEnC,MAAM,CAACE;AALhB,KAOE;AAAQ,IAAA,KAAK,EAAC,GAAd;AAAA,kDA8HCpB,YA9HD,EAkICA,YAlID,EAyJCA,YAzJD;AAAA,iBAPF,EAQGuE,cAAc,IAAIA,cAAc,CAACQ,GAAf,CAAmB,CAAC4B,aAAD,EAAgB1B,GAAhB,KACpC;AACE,IAAA,GAAG,EAAE0B,aAAa,CAAChG,EADrB;AAEE,IAAA,KAAK,EAAEO,MAAM,CAACE,eAFhB;AAGE,IAAA,KAAK,EAAEuF,aAAa,CAAChG,EAHvB;AAAA,kDA4HDX,YA5HC,EAgIDA,YAhIC,EAuJDA,YAvJC;AAAA,KAKG2G,aAAa,CAAC9C,IALjB,CADiB,CARrB,CAFF,EAoBE,MAAC,eAAD;AAAiB,IAAA,KAAK,EAAE9C,KAAxB;AAA+B,IAAA,OAAO,EAAEqB,OAAxC;AAAiD,IAAA,IAAI,EAAC;AAAtD,IApBF,CADF,CADF,CADF,EA2BGlB,MAAM,CAACE,eAAP,IAA0B,CAA1B,IACC;AAAA,kDA8GOpB,YA9GP,EAkHOA,YAlHP,EAyIOA,YAzIP,aAAe;AAAf,KACE;AAAA,kDA6GKA,YA7GL,EAiHKA,YAjHL,EAwIKA,YAxIL,aAAe;AAAf,KACE,MAAC,SAAD,QACE,MAAC,KAAD;AAAO,IAAA,OAAO,EAAC;AAAf,iCADF,EAEE,MAAC,KAAD;AAAO,IAAA,EAAE,EAAC,gBAAV;AAA2B,IAAA,IAAI,EAAC,gBAAhC;AAAiD,IAAA,QAAQ,EAAEH,SAA3D;AAAsE,IAAA,IAAI,EAAC,MAA3E;AACE,IAAA,QAAQ,EAAE8D;AADZ,IAFF,CADF,CADF,EAQE;AAAA,kDAsGK3D,YAtGL,EA0GKA,YA1GL,EAiIKA,YAjIL,aAAe;AAAf,KACE,MAAC,SAAD,QACE,MAAC,KAAD;AAAO,IAAA,OAAO,EAAC;AAAf,qBADF,EAEE;AAAK,IAAA,GAAG,EAAEgC,OAAV;AAAA,kDAmGChC,YAnGD,EAuGCA,YAvGD,EA8HCA,YA9HD,aAA6B;AAA7B,IAFF,EAGE,MAAC,WAAD;AACE,IAAA,IAAI,EAAE,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmB,IAAnB,EAAyB,GAAzB,EAA8B,IAA9B,EAAoC,IAApC,EAA0C,IAA1C,EAAgD,IAAhD,EAAsD,GAAtD,EAA2D,IAA3D,EAAiE,IAAjE,EAAuE,IAAvE,EAA6E,IAA7E,EAAmF,GAAnF,EAAwF,IAAxF,EAA8F,IAA9F,EAAoG,IAApG,EAA0G,IAA1G,CADR;AAEE,IAAA,KAAK,EAAE,KAFT;AAGE,IAAA,SAAS,EAAE,cAHb;AAIE,IAAA,QAAQ,EAAE+D,iCAJZ;AAKE,IAAA,EAAE,EAAC,YALL;AAKkB,IAAA,IAAI,EAAC;AALvB,IAHF,EAUE,MAAC,eAAD;AAAiB,IAAA,KAAK,EAAEhD,KAAxB;AAA+B,IAAA,OAAO,EAAEqB,OAAxC;AAAiD,IAAA,IAAI,EAAC;AAAtD,IAVF,CADF,CARF,EAsBE;AAAA,kDAwFKpC,YAxFL,EA4FKA,YA5FL,EAmHKA,YAnHL,aAAe;AAAf,KACE,MAAC,SAAD,QACE,MAAC,KAAD;AAAO,IAAA,OAAO,EAAC;AAAf,iBADF,EAEE,MAAC,KAAD;AACE,IAAA,SAAS,EAAE,cADb;AAEE,IAAA,QAAQ,EAAE2D,iBAFZ;AAGE,IAAA,EAAE,EAAC,WAHL;AAGiB,IAAA,IAAI,EAAC,WAHtB;AAIE,IAAA,SAAS,EAAE;AAJb,IAFF,EAQE,MAAC,eAAD;AAAiB,IAAA,KAAK,EAAE5C,KAAxB;AAA+B,IAAA,OAAO,EAAEqB,OAAxC;AAAiD,IAAA,IAAI,EAAC;AAAtD,IARF,CADF,CAtBF,EAkCE;AAAA,kDA4EKpC,YA5EL,EAgFKA,YAhFL,EAuGKA,YAvGL,aAAe;AAAf,KACE,MAAC,SAAD,QACE,MAAC,KAAD;AAAO,IAAA,OAAO,EAAC;AAAf,qBADF,EAEE,MAAC,WAAD;AACE,IAAA,IAAI,EAAE,CAAC,IAAD,EAAO,IAAP,EAAa,GAAb,EAAkB,IAAlB,EAAwB,IAAxB,CADR;AAEE,IAAA,KAAK,EAAE,KAFT;AAGE,IAAA,SAAS,EAAE,cAHb;AAIE,IAAA,WAAW,EAAE,OAJf;AAKE,IAAA,IAAI,EAAE,oBALR;AAME,IAAA,QAAQ,EAAE2D;AANZ,IAFF,EAUE,MAAC,eAAD;AAAiB,IAAA,KAAK,EAAE5C,KAAxB;AAA+B,IAAA,OAAO,EAAEqB,OAAxC;AAAiD,IAAA,IAAI,EAAC;AAAtD,IAVF,CADF,CAlCF,EAgDE;AAAA,kDA8DKpC,YA9DL,EAkEKA,YAlEL,EAyFKA,YAzFL,aAAe;AAAf,KACE,MAAC,SAAD,QACE,MAAC,KAAD;AAAO,IAAA,OAAO,EAAC;AAAf,WADF,EAEE,MAAC,WAAD;AACE,IAAA,IAAI,EAAE,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,CADR;AAEE,IAAA,KAAK,EAAE,KAFT;AAGE,IAAA,SAAS,EAAE,cAHb;AAIE,IAAA,IAAI,EAAE,kBAJR;AAKE,IAAA,QAAQ,EAAE2D,iBALZ;AAME,IAAA,WAAW,EAAE;AANf,IAFF,EAUE,MAAC,eAAD;AAAiB,IAAA,KAAK,EAAE5C,KAAxB;AAA+B,IAAA,OAAO,EAAEqB,OAAxC;AAAiD,IAAA,IAAI,EAAC;AAAtD,IAVF,CADF,CAhDF,EA8DE;AAAA,kDAgDKpC,YAhDL,EAoDKA,YApDL,EA2EKA,YA3EL,aAAe;AAAf,KACE,MAAC,MAAD;AAAQ,IAAA,KAAK,MAAb;AAAc,IAAA,KAAK,EAAC,WAApB;AAAgC,IAAA,IAAI,EAAC,QAArC;AAA8C,IAAA,QAAQ,EAAEoC,OAAxD;AACE,IAAA,OAAO,EAAEA,OADX;AACoB,IAAA,OAAO,EAAE8C;AAD7B,aADF,CA9DF,CA5BJ,EAiGGhE,MAAM,CAACE,eAAP,IAA0B,CAA1B,IACC;AAAA,kDAwCOpB,YAxCP,EA4COA,YA5CP,EAmEOA,YAnEP,aAAgB;AAAhB,KACE;AAAA,kDAuCKA,YAvCL,EA2CKA,YA3CL,EAkEKA,YAlEL,aAAe;AAAf,KACE,MAAC,MAAD;AAAQ,IAAA,KAAK,MAAb;AAAc,IAAA,KAAK,EAAC,WAApB;AAAgC,IAAA,IAAI,EAAC,QAArC;AAA8C,IAAA,QAAQ,EAAEoC,OAAxD;AACE,IAAA,OAAO,EAAEA,OADX;AACoB,IAAA,OAAO,EAAE8C;AAD7B,oBADF,CADF,CAlGJ,CADF,CAFF,EAgHE;AAAA,kDA6BalF,YA7Bb,EAiCaA,YAjCb,EAwDaA,YAxDb,aAAe;AAAf,KACE;AAAA,kDA4BWA,YA5BX,EAgCWA,YAhCX,EAuDWA,YAvDX,aAAe;AAAf,KACE;AAAA,kDA2BSA,YA3BT,EA+BSA,YA/BT,EAsDSA,YAtDT,aAAe;AAAf,IADF,EAIE;AAAA,kDAwBSA,YAxBT,EA4BSA,YA5BT,EAmDSA,YAnDT,aAAgB;AAAhB,KACE;AAAA,kDAuBOA,YAvBP,EA2BOA,YA3BP,EAkDOA,YAlDP;AAAA,kCADF,EAIE;AAAA,kDAoBOA,YApBP,EAwBOA,YAxBP,EA+COA,YA/CP,aAAc;AAAd,sBACe;AAAA,kDAmBRA,YAnBQ,EAuBRA,YAvBQ,EA8CRA,YA9CQ;AAAA,KAASO,eAAe,CAACsD,IAAzB,CADf,gBAJF,CAJF,EAYE;AAAA,kDAgBS7D,YAhBT,EAoBSA,YApBT,EA2CSA,YA3CT,aAAgB;AAAhB,KACE;AAAA,kDAeOA,YAfP,EAmBOA,YAnBP,EA0COA,YA1CP,aAAe;AAAf,KACE;AAAA,kDAcKA,YAdL,EAkBKA,YAlBL,EAyCKA,YAzCL;AAAA,aADF,EAIE;AAAA,kDAWKA,YAXL,EAeKA,YAfL,EAsCKA,YAtCL,aAAc;AAAd,WACKO,eAAe,CAACqG,MADrB,CAJF,CADF,CAZF,CADF,CAhHF,CAJF;AAAA;AAAA,cAiJiB5G,YAjJjB,EAqJiBA,YArJjB,EA4KiBA,YA5KjB;AAAA,4BAiJiBA,YAjJjB,0CAqJiBA,YArJjB,uVA4KiBA,YA5KjB;;uFAAA,EADF;AA+OD,CAlgBD;;AAogBA,eAAevB,QAAQ,CAACc,OAAD,EAAU,IAAV,CAAvB","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport FormGroup from \"~/components/layout/AuthModal/FormGroup\";\nimport Label from \"~/components/Form/Label\";\nimport Input from \"~/components/layout/AuthModal/Input\";\nimport withAuth from \"~/components/withAuth\";\nimport InvalidFeedback from \"~/components/Form/InvalidFeedback\"\nimport { HAS_WINDOW } from \"~/constants/constants\";\nimport useScript from \"@charlietango/use-script\";\nimport Select from \"~/components/Select/Select\";\nimport Button from \"~/components/button\";\nimport MaskedInput from 'react-text-mask'\nimport UserContext from \"~/contexts/UserContext\";\nimport Router from \"next/router\";\nimport { ThemeContext } from \"styled-components\";\nimport Color from \"color\";\nimport { CONFIG } from '~/config'\nimport NameProject from \"~/components/NameProject\";\nimport {toast} from \"react-toastify\";\n\nconst Payment = ({\n  layoutProps,\n  userData,\n  package_id,\n  packages,\n  api,\n  requireds,\n  handleSubmit\n}) => {\n\n  const theme = useContext(ThemeContext)\n  const primaryColor = Color(theme.colors.primary).hsl().string()\n\n  const [ready, status] = useScript('https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js')\n\n\n  let selectedPackage = null\n  if (packages && package_id) {\n    selectedPackage = packages.items.find(i => i.id == package_id)\n    console.log(selectedPackage)\n  }\n\n  const { user } = useContext(UserContext)\n  const [error, setError] = useState({\n    errors: {}\n  })\n\n  const [values, setValues] = useState({\n    package_id: '',\n    paymentMethodId: null,\n    payment_os: null,\n    cash_paymentMethodId: null,\n    terms: null,\n    discount_id: null,\n    cardNumber: null,\n    cardHolderName: null,\n    cardExpirationDate: null,\n    cardSecurityCode: null,\n    paymentMethodCode: null,\n    docType: \"CPF\",\n    docNumber: null,\n  })\n\n  const [cardImg, setCardImg] = useState(null);\n  const [creditCard, setCreditCard] = useState(null);\n\n  const [loading, setLoading] = useState();\n\n  const businessUnitPublicKey = 'TEST-7205c1be-9805-4308-bf00-6557c5b56b88'\n  const [isMercadoPagoReady, setIsMercadoPagoReady] = useState(false)\n  const MercadoPago = ready && HAS_WINDOW ? window.Mercadopago : null\n\n  const credit_card_id = 1\n  const debit_card_id = 2\n  const isCardPayment = [credit_card_id, debit_card_id].includes(values.paymentMethodId)\n\n\n  const [payMethods, setPayMethods] = useState();\n\n  useEffect(_ => {\n    if (MercadoPago) {\n      MercadoPago.setPublishableKey(businessUnitPublicKey)\n      setIsMercadoPagoReady(true)\n      setPayMethods(MercadoPago.getPaymentMethods());\n    }\n  }, [MercadoPago])\n\n\n  /* handle payment method change */\n  function onPaymentChange(e) {\n    setValues({\n      ...values,\n      paymentMethodId: parseInt(e.target.value, 10),\n      cash_paymentMethodId: null,\n    })\n  }\n\n  function onCashPaymentMethodChange(e) {\n    setValues({\n      ...values,\n      cash_paymentMethodId: parseInt(e.target.value, 10),\n    })\n  }\n\n  const handleInputChange = e => {\n    const { checked, name, value, type } = e.target\n    setValues({\n      ...values,\n      [name]: type === 'checkbox' ?\n        (checked ? (value === 'true' ? true : value) : false) :\n        value,\n    })\n  }\n\n  const handleInputChangeCreditCardNumber = e => {\n\n    const { name, value } = e.target\n\n\n    setValues({\n      ...values,\n      [name]: value,\n    })\n\n    let cardnumber = value;\n\n    if (cardnumber.length >= 6) {\n      let bin = cardnumber.substring(0, 6);\n\n      MercadoPago.getPaymentMethod({\n        \"bin\": bin\n      }, (status, details) => {\n        if (details.length > 0) {\n          setCardImg(details[0].secure_thumbnail);\n          setCreditCard(details[0]);\n          setValues({\n            ...values,\n            ['paymentMethodCode']: details[0].id,\n            ['cardNumber']: cardnumber\n          })\n\n        }\n      });\n\n    }\n  }\n\n  // payment methods\n  const [paymentMethods, setPaymentMethods] = useState()\n\n  // get payment methods\n  useEffect(_ => {\n    const getPaymentMethods = async _ => {\n      const { data } = await api.get('payment-methods')\n      setPaymentMethods(data)\n    }\n    getPaymentMethods()\n  }, [])\n\n\n  // cash payment methods\n  const [cashPaymentMethods, setCashPaymentMethods] = useState()\n\n  // get cash payment methods\n  useEffect(_ => {\n    const getCashPaymentMethods = async _ => {\n      const { data } = await api.get('cash-payment-methods')\n      setCashPaymentMethods(data)\n    }\n    getCashPaymentMethods()\n  }, [])\n\n  let payMethodsHtml = () => {\n    {\n      payMethods && payMethods.map((m, key) => {\n        return <div className=\"col-6 col-md\">\n          {m.id}\n        </div>\n      })\n    }\n  }\n\n\n  const submitCredit = async e => {\n\n    e.preventDefault();\n\n    setLoading(true);\n\n    let expirationMonth = values.cardExpirationDate.split('/')[0];\n    let expirationYear = values.cardExpirationDate.split('/')[1];\n\n    MercadoPago.createToken({\n      cardNumber: values.cardNumber,\n      cardholderName: values.cardHolderName,\n      cardExpirationMonth: expirationMonth,\n      cardExpirationYear: expirationYear,\n      securityCode: values.cardSecurityCode,\n      docType: values.docType,\n      docNumber: values.docNumber,\n      email: user.email\n    }, async (statusCode, response) => {\n\n      let token = \"\";\n\n      if (response && response.cause && response.cause.length > 0) {\n        let errors = [];\n        for (let error of response.cause) {\n          if (error.code === \"E301\") {\n            errors[\"cardNumber\"] = \"Há algo de errado com esse número. Digite novamente.\"\n          }\n          if (error.code === \"E302\") {\n            errors[\"cardSecurityCode\"] = \"Confira o código de segurança.\"\n          }\n          if (error.code === \"316\") {\n            error[\"cardHolderName\"] = \"Por favor, digite um nome válido.\"\n          }\n          if (error.code === \"324\") {\n            errors[\"docType\"] = \"Confira seu documento.\";\n          }\n          if (error.code === \"325\" || error.code === \"326\") {\n            errors[\"cardExpirationDate\"] = \"Confira a data.\";\n          }\n        }\n        setError({\n          errors: errors\n        });\n      }\n\n\n      try {\n\n        token = response.id;\n\n        const res = await api.post(`register/subscribe`, {\n          package_id: package_id,\n          payment_method_id: values.paymentMethodId,\n          payment_method_code: values.paymentMethodCode,\n          token: token\n        })\n\n\n        handleSubmit(4, null);\n\n      } catch (error) {\n\n\n        if (error.response) {\n\n          const { data, status } = error.response\n\n          MercadoPago.clearSession();\n\n          toast.error(data.message, { delay: 500, autoClose: 5000 })\n\n          if (status === 422) {\n            setError(data)\n          }\n\n        } else if (error.request) {\n          setError(error)\n        } else {\n          setError(error)\n        }\n\n      } finally {\n        setLoading(false)\n      }\n\n\n      setLoading(false);\n\n    });\n\n\n    // const data = { ...values, payment_os: paymentData }\n    //\n\n  }\n\n  // function appName() {\n  //   if (CONFIG.projectName) {\n  //     return <div style={ { display: 'inline-block' } }>\n  //       <strong className=\"text-primary\">{ CONFIG.projectName.split(' ')[0] }</strong>{ CONFIG.projectName.split(' ')[1] }\n  //     </div>\n  //   } else if (CONFIG.appName) {\n  //     return <div style={ { display: 'inline-block' } }>\n  //       <strong className=\"text-primary\">{ CONFIG.appName.split(' ')[0] }</strong>{ CONFIG.appName.split(' ')[1] }\n  //     </div>\n  //   }\n  //   return <div style={ { display: 'inline-block' } }>\n  //     <strong className=\"text-primary\">Project</strong>Name!\n  //   </div>\n  // }\n\n  return (\n    <div className=\"register-confirm container text-center responsive\">\n\n      <h2 className=\"card-title text-center\"><span className={ \"text-primary\" }>¡</span>Sé parte de { <NameProject/> }\n        <span className={ \"text-primary\" }>!</span></h2>\n      <div className=\"row\">\n\n        <div className=\"col-md-6 paymentMethod\">\n          <div className=\"row\">\n            <div className=\"row w-100\">\n              <div className=\"col-12\">\n                <FormGroup>\n                  <Label htmlFor=\"paymentMethodId\" style=\"margin: 0;\">Pague com</Label>\n                  <Select\n                    id=\"paymentMethodId\"\n                    name=\"paymentMethodId\"\n                    required={requireds}\n                    onChange={onPaymentChange}\n                    value={values.paymentMethodId}\n                  >\n                    <option value=\"0\">Selecione</option>\n                    {paymentMethods && paymentMethods.map((paymentMethod, key) => (\n                      <option\n                        key={paymentMethod.id}\n                        state={values.paymentMethodId}\n                        value={paymentMethod.id}\n                      >\n                        {paymentMethod.name}\n                      </option>\n                    ))}\n                  </Select>\n                  <InvalidFeedback error={error} loading={loading} name=\"paymentMethodId\" />\n                </FormGroup>\n              </div>\n            </div>\n            {values.paymentMethodId == 1 && (\n              <div className=\"row\">\n                <div className=\"col-12\">\n                  <FormGroup>\n                    <Label htmlFor=\"cardHolderName\">Nombre impreso en tarjeta</Label>\n                    <Input id=\"cardHolderName\" name=\"cardHolderName\" required={requireds} type=\"text\"\n                      onChange={handleInputChange} />\n                  </FormGroup>\n                </div>\n                <div className=\"col-12\">\n                  <FormGroup>\n                    <Label htmlFor=\"cardNumber\">Nro Cartão</Label>\n                    <img src={cardImg} className=\"creditCardBrand\" />\n                    <MaskedInput\n                      mask={[/\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/]}\n                      guide={false}\n                      className={\"form-control\"}\n                      onChange={handleInputChangeCreditCardNumber}\n                      id=\"cardNumber\" name=\"cardNumber\"\n                    />\n                    <InvalidFeedback error={error} loading={loading} name=\"cardNumber\" />\n                  </FormGroup>\n                </div>\n                <div className=\"col-12\">\n                  <FormGroup>\n                    <Label htmlFor=\"docNumber\">Documento</Label>\n                    <Input\n                      className={\"form-control\"}\n                      onChange={handleInputChange}\n                      id=\"docNumber\" name=\"docNumber\"\n                      maxLength={20}\n                    />\n                    <InvalidFeedback error={error} loading={loading} name=\"docNumber\" />\n                  </FormGroup>\n                </div>\n                <div className=\"col-6\">\n                  <FormGroup>\n                    <Label htmlFor=\"card-duedate\">Dt Vencimento</Label>\n                    <MaskedInput\n                      mask={[/\\d/, /\\d/, '/', /\\d/, /\\d/,]}\n                      guide={false}\n                      className={\"form-control\"}\n                      placeholder={\"MM/AA\"}\n                      name={\"cardExpirationDate\"}\n                      onChange={handleInputChange}\n                    />\n                    <InvalidFeedback error={error} loading={loading} name=\"cardExpirationDate\" />\n                  </FormGroup>\n                </div>\n                <div className=\"col-6\">\n                  <FormGroup>\n                    <Label htmlFor=\"card-cvv\">CVV</Label>\n                    <MaskedInput\n                      mask={[/\\d/, /\\d/, /\\d/]}\n                      guide={false}\n                      className={\"form-control\"}\n                      name={\"cardSecurityCode\"}\n                      onChange={handleInputChange}\n                      placeholder={\"***\"}\n                    />\n                    <InvalidFeedback error={error} loading={loading} name=\"cardSecurityCode\" />\n                  </FormGroup>\n                </div>\n                <div className=\"col-12\">\n                  <Button block color=\"secondary\" type=\"button\" disabled={loading}\n                    loading={loading} onClick={submitCredit}>Pagar</Button>\n                </div>\n              </div>\n            )}\n\n            {values.paymentMethodId == 3 && (\n              <div className={\"row\"}>\n                <div className=\"col-12\">\n                  <Button block color=\"secondary\" type=\"button\" disabled={loading}\n                    loading={loading} onClick={submitCredit}>Gerar Boleto</Button>\n                </div>\n              </div>\n            )}\n\n          </div>\n        </div>\n\n        <div className=\"col-md-6\">\n          <div className=\"product-summary\">\n            <div className=\"product-image\">\n              {/*<img src=\"/static/lau/subs/plan_hero.png\" alt=\"\" />*/}\n            </div>\n            <div className={\"product-name-group\"}>\n              <h6>\n                Você está comprando:\n              </h6>\n              <p className={\"product-name\"}>\n                Assinatura - <strong>{selectedPackage.name}</strong> recorrente\n              </p>\n            </div>\n            <div className={\"price-breakdown\"}>\n              <div className=\"checkout-total\">\n                <h6>\n                  Total\n                </h6>\n                <p className={\"price\"}>\n                  $ {selectedPackage.amount}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <style jsx global={true}>{`\n\n        .text-primary {\n           color: ${ primaryColor} !important;\n        }\n\n        strong.text-primary {\n           color: ${ primaryColor } !important;\n        }\n\n\n        h2.card-title {\n          font-weight: normal;\n          color: #000;\n          margin-bottom: 1em;\n          font-size: 1.7em;\n        }\n\n       .pay-methods {\n    margin: 32px;\n        display: flex;\n        flex-wrap: wrap;\n        }\n        div.card-subtitle {\n          font-size: 1.1em;\n          font-weight: 500;\n          margin-bottom: 2.5em;\n        }\n\n        .text-primary {\n           color: ${ primaryColor} !important;\n        }\n        .register-confirm {\n          padding-top: 50px;\n          padding-bottom: 50px;\n          color: #666666;\n        }\n         @media(max-width: 765px) {\n\n        .responsive{\n              padding: 20px 30px 15px 30px!important;\n          // padding: 40px!important;\n          padding: 0px;\n          display: flex;\n          flex-wrap: wrap;\n          height: 100%!importat;\n         justify-content: center;\n          height:100%!important;\n\n          }\n         .card{\n           background-color: rgba(255,255,255,0.85);\n          //  height:100%!important;\n\n         }\n\n          .card-body{\n           background-image: url()!important;\n          //  height:100%!important;\n\n         }\n\n         label {\n              display: inline-block;\n              margin-bottom: .5rem;\n              text-align: center;\n            }\n\n         .justify-content-end {\n           display:flex;\n           justify-content:center!important;\n         }\n         form{\n           padding: 0px!important;\n         }\n         .row {\n          display: -ms-flexbox;\n          display: flex;\n          -ms-flex-wrap: wrap;\n           margin-right: 0px;\n           margin-left: 0px;\n          }\n        .col-8 {\n         max-width: 100%!important;\n          }\n         .offset-3{\n          margin-left:0px;\n          }\n\n        }\n\n\n      ` }</style>\n    </div>\n\n  )\n}\n\nexport default withAuth(Payment, true);\n"]},"metadata":{},"sourceType":"module"}