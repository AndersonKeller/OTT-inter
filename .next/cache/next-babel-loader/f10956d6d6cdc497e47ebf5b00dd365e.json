{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport { useEffect, useState, useContext } from 'react';\nimport { Card, Table } from 'react-bootstrap';\nimport { ThemeContext } from 'styled-components';\nimport { PackageRadio } from '~/components/Packages';\nimport withAuth from '~/components/withAuth';\nimport Layout from '~/components/layout/Layout';\nimport { CONFIG } from '~/config';\n\nvar PaymentsPage = function PaymentsPage(_ref) {\n  var api = _ref.api,\n      layoutProps = _ref.layoutProps,\n      packages = _ref.packages,\n      user = _ref.user;\n\n  var _useState = useState({}),\n      plan = _useState[0],\n      setPlan = _useState[1];\n\n  var _useState2 = useState({}),\n      subscription = _useState2[0],\n      setSubscription = _useState2[1];\n\n  var _useState3 = useState([]),\n      orders = _useState3[0],\n      setOrders = _useState3[1];\n\n  useEffect(function (_) {\n    (function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_) {\n        var _yield$api$get, _yield$api$get$data, package_id, data;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return api.get('subscription');\n\n              case 3:\n                _yield$api$get = _context.sent;\n                _yield$api$get$data = _yield$api$get.data;\n                package_id = _yield$api$get$data.package_id;\n                data = _objectWithoutProperties(_yield$api$get$data, [\"package_id\"]);\n                console.log(data);\n                setSubscription(data);\n\n                if (package_id) {\n                  setPlan(packages.items.find(function (item) {\n                    return item.id == package_id;\n                  }));\n                } else {\n                  setPlan(packages.items.find(function (item) {\n                    return item.amount == 0;\n                  }));\n                }\n\n                _context.next = 15;\n                break;\n\n              case 12:\n                _context.prev = 12;\n                _context.t0 = _context[\"catch\"](0);\n                console.log(_context.t0);\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 12]]);\n      }));\n\n      return function (_x) {\n        return _ref2.apply(this, arguments);\n      };\n    })()();\n  }, []);\n  useEffect(function (_) {\n    (function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_) {\n        var _yield$api$get2, data;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                _context2.next = 3;\n                return api.get('cash-orders');\n\n              case 3:\n                _yield$api$get2 = _context2.sent;\n                data = _yield$api$get2.data;\n                setOrders(data);\n                _context2.next = 11;\n                break;\n\n              case 8:\n                _context2.prev = 8;\n                _context2.t0 = _context2[\"catch\"](0);\n                console.log(_context2.t0);\n\n              case 11:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[0, 8]]);\n      }));\n\n      return function (_x2) {\n        return _ref3.apply(this, arguments);\n      };\n    })()();\n  }, []);\n  var theme = useContext(ThemeContext);\n  var backgroundColor = theme.colors.backgroundContrast;\n  return __jsx(Layout, layoutProps, __jsx(Head, null, __jsx(\"title\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Pagos < \", CONFIG.appName, \" \")), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"payments-wrapper\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"container\"\n  }, __jsx(\"h3\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"title\"\n  }, \"Pagos\"), __jsx(Card, {\n    bg: \"dark\",\n    text: \"white\"\n  }, __jsx(Card.Body, null, __jsx(Card.Title, null, \"Tu plan\"), __jsx(Card.Text, null, \"Todo el contenido de \", CONFIG.appName, \" por \", plan.name, \".\"), __jsx(\"div\", {\n    style: {\n      fontSize: '13px',\n      lineHeight: '0.7rem',\n      padding: 0\n    },\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"col-5 col-md-2 text-center\"\n  }, __jsx(PackageRadio, {\n    readOnly: true,\n    package_id: plan.id,\n    plan: plan\n  }))), __jsx(Card.Footer, {\n    style: {\n      fontSize: '12px',\n      lineHeight: 1\n    }\n  }, \"Pr\\xF3xima factura: \", subscription.ends_at && subscription.ends_at.split(' ')[0])), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"mobile-table\"\n  }, orders.map(function (order) {\n    return __jsx(\"div\", {\n      key: order.id,\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"mobile-row\"\n    }, __jsx(\"dl\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, __jsx(\"dt\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, \"Fecha\"), __jsx(\"dd\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, __jsx(Link, {\n      href: \"receipt\"\n    }, __jsx(\"a\", {\n      target: \"_blank\",\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, order.paid_at && order.paid_at.split(' ')[0])))), __jsx(\"dl\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, __jsx(\"dt\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, \"Descripci\\xF3n\"), __jsx(\"dd\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, CONFIG.appName)), __jsx(\"dl\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, __jsx(\"dt\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, \"Periodo\"), __jsx(\"dd\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, order.paid_at && order.paid_at.split(' ')[0], \"-\")), __jsx(\"dl\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, __jsx(\"dt\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, \"Medio de Pago\"), __jsx(\"dd\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, __jsx(Link, {\n      href: \"receipt\"\n    }, __jsx(\"a\", {\n      target: \"_blank\",\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, order.download_link)))), __jsx(\"dl\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, __jsx(\"dt\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, \"Total\"), __jsx(\"dd\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, order.value)));\n  })), __jsx(Table, {\n    className: \"desktop-table\",\n    hover: true,\n    variant: \"dark\",\n    size: \"sm\"\n  }, __jsx(\"thead\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(\"tr\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"#\"), __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Fecha\"), __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Descripci\\xF3n\"), __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Periodo\"), __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Medio de Pago\"), __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Total\"))), __jsx(\"tbody\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, orders.map(function (order) {\n    return __jsx(\"tr\", {\n      key: order.id,\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, __jsx(\"td\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, order.id), __jsx(\"td\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, __jsx(Link, {\n      href: \"receipt\"\n    }, __jsx(\"a\", {\n      target: \"_blank\",\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, order.paid_at && order.paid_at.split(' ')[0]))), __jsx(\"td\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, CONFIG.appName), __jsx(\"td\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, order.paid_at && order.paid_at.split(' ')[0], \"-\"), __jsx(\"td\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, __jsx(Link, {\n      href: \"receipt\"\n    }, __jsx(\"a\", {\n      target: \"_blank\",\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, order.download_link))), __jsx(\"td\", {\n      className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n    }, order.value));\n  }))))), __jsx(_JSXStyle, {\n    id: \"556766073\",\n    dynamic: [backgroundColor]\n  }, [\".payments-wrapper .bg-dark{background-color:\".concat(backgroundColor, \" !important;}\"), \"td>a{color:var(--gray);line-height:1.5;-webkit-text-decoration:underline;text-decoration:underline;}\", \"dd>a{color:var(--primary);}\", \"td>a:hover{color:var(--primary-hover);}\", \"dd>a:hover{-webkit-text-decoration:underline;text-decoration:underline;color:var(--primary-hover);}\", \"h3{margin-bottom:25px;}\", \".table{margin-top:15px;}\", \".table-dark{background:transparent;}\", \".table-sm{font-size:16px;}\", \".card-text{font-size:14px;}\", \".table-dark.table-hover tbody tr:hover{background-color:var(--primary-alpha);}\", \".mobile-table{font-size:16px;margin-top:40px;margin-bottom:20px;display:none;}\", \".mobile-row{border-top:1px solid white;}\", \"dl:first-child{margin-top:15px;}\", \"dl{margin-bottom:0.5rem;}\", \"dt,dd{font-weight:300;display:inline;}\", \"dd{float:right;}\", \"@media only screen and (max-width:767px){.mobile-table{display:inherit;}.table{display:none;}}\"]));\n};\n\nPaymentsPage.getInitialProps = /*#__PURE__*/function () {\n  var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref4) {\n    var api, user, packages, _yield$api$get3, data;\n\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            api = _ref4.api, user = _ref4.user;\n            _context3.prev = 1;\n            _context3.next = 4;\n            return api.get('packages');\n\n          case 4:\n            _yield$api$get3 = _context3.sent;\n            data = _yield$api$get3.data;\n            packages = {\n              items: data\n            };\n            _context3.next = 12;\n            break;\n\n          case 9:\n            _context3.prev = 9;\n            _context3.t0 = _context3[\"catch\"](1);\n            packages = {\n              error: _context3.t0\n            };\n\n          case 12:\n            return _context3.abrupt(\"return\", {\n              packages: packages,\n              user: user\n            });\n\n          case 13:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[1, 9]]);\n  }));\n\n  return function (_x3) {\n    return _ref5.apply(this, arguments);\n  };\n}();\n\nexport default withAuth(PaymentsPage);","map":{"version":3,"sources":["/Users/rafael/Projects/somosgad/dale/pages/user/payments.js"],"names":["Head","Link","useEffect","useState","useContext","Card","Table","ThemeContext","PackageRadio","withAuth","Layout","CONFIG","PaymentsPage","api","layoutProps","packages","user","plan","setPlan","subscription","setSubscription","orders","setOrders","_","get","data","package_id","console","log","items","find","item","id","amount","theme","backgroundColor","colors","backgroundContrast","appName","name","fontSize","lineHeight","padding","ends_at","split","map","order","paid_at","download_link","value","getInitialProps","error"],"mappings":"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","sourcesContent":["import Head from 'next/head'\nimport Link   from 'next/link'\nimport { useEffect, useState, useContext } from 'react'\nimport { Card, Table } from 'react-bootstrap'\nimport { ThemeContext } from 'styled-components'\nimport { PackageRadio } from '~/components/Packages'\nimport withAuth         from '~/components/withAuth'\nimport Layout           from '~/components/layout/Layout'\nimport { CONFIG }       from '~/config'\n\nconst PaymentsPage = ({ api, layoutProps, packages, user }) => {\n\n  const [ plan, setPlan ] = useState({})\n  const [ subscription, setSubscription ] = useState({})\n  const [ orders, setOrders ] = useState([])\n\n  useEffect(_ => {\n    (async _ => {\n      try{\n        const { data: {package_id, ...data} } = await api.get('subscription')\n        console.log(data)\n        setSubscription(data)\n\n        if(package_id){\n          setPlan(packages.items.find(item => item.id == package_id))\n        }else{\n          setPlan(packages.items.find(item => item.amount == 0))\n        }\n      }catch(error){\n        console.log(error)\n      }\n    })()\n  }, [])\n\n  useEffect(_ => {\n    (async _ => {\n      try{\n        const { data } = await api.get('cash-orders')\n        setOrders(data)\n      }catch(error){\n        console.log(error)\n      }\n    })()\n  }, [])\n\n  const theme = useContext(ThemeContext)\n  const backgroundColor = theme.colors.backgroundContrast\n\n  return (\n    <Layout { ...layoutProps }>\n      <Head>\n        <title>Pagos &lt; {CONFIG.appName} </title>\n      </Head>\n      <div className=\"payments-wrapper\">\n        <div className=\"container\">\n          <h3 className=\"title\">Pagos</h3>\n          <Card bg=\"dark\" text=\"white\">\n            <Card.Body>\n              <Card.Title>Tu plan</Card.Title>\n              <Card.Text>Todo el contenido de {CONFIG.appName} por {plan.name}.</Card.Text>\n              <div className=\"col-5 col-md-2 text-center\" style={{fontSize: '13px', lineHeight: '0.7rem', padding: 0}}>\n                <PackageRadio\n                  readOnly\n                  package_id={plan.id}\n                  plan={plan}\n                />\n              </div>\n            </Card.Body>\n            <Card.Footer style={{fontSize: '12px', lineHeight: 1}}>\n              Próxima factura: {subscription.ends_at && subscription.ends_at.split(' ')[0]}\n            </Card.Footer>\n          </Card>\n          <div className=\"mobile-table\">\n            {orders.map(order =>\n              <div className=\"mobile-row\" key={order.id}>\n                <dl>\n                  <dt>Fecha</dt>\n                  <dd><Link href=\"receipt\"><a target=\"_blank\">{order.paid_at && order.paid_at.split(' ')[0]}</a></Link></dd>\n                </dl>\n                <dl>\n                  <dt>Descripción</dt>\n                  <dd>{CONFIG.appName}</dd>\n                </dl>\n                <dl>\n                  <dt>Periodo</dt>\n                  <dd>{order.paid_at && order.paid_at.split(' ')[0]}-</dd>\n                </dl>\n                <dl>\n                  <dt>Medio de Pago</dt>\n                  <dd><Link href=\"receipt\"><a target=\"_blank\">{order.download_link}</a></Link></dd>\n                </dl>\n                <dl>\n                  <dt>Total</dt>\n                  <dd>{order.value}</dd>\n                </dl>\n              </div>\n            )}\n            {/* <div className=\"mobile-row\">\n              <dl>\n                <dt>Fecha</dt>\n                <dd><Link href=\"receipt\"><a target=\"_blank\">09/01/2020</a></Link></dd>\n              </dl>\n              <dl>\n                <dt>Descripción</dt>\n                <dd>{CONFIG.appName}</dd>\n              </dl>\n              <dl>\n                <dt>Periodo</dt>\n                <dd>09/01/2020—08/02/2020</dd>\n              </dl>\n              <dl>\n                <dt>Medio de Pago</dt>\n                <dd>VISA •••• •••• •••• 1627</dd>\n              </dl>\n              <dl>\n                <dt>Total</dt>\n                <dd>$99,00</dd>\n              </dl>\n            </div> */}\n          </div>\n          <Table className=\"desktop-table\" hover variant=\"dark\" size=\"sm\">\n            <thead>\n              <tr>\n                <th>#</th>\n                <th>Fecha</th>\n                <th>Descripción</th>\n                <th>Periodo</th>\n                <th>Medio de Pago</th>\n                <th>Total</th>\n              </tr>\n            </thead>\n            <tbody>\n              {orders.map(order =>\n                <tr key={order.id}>\n                  <td>{order.id}</td>\n                  <td><Link href=\"receipt\"><a target=\"_blank\">{order.paid_at && order.paid_at.split(' ')[0]}</a></Link></td>\n                  <td>{CONFIG.appName}</td>\n                  <td>{order.paid_at && order.paid_at.split(' ')[0]}-</td>\n                  <td><Link href=\"receipt\"><a target=\"_blank\">{order.download_link}</a></Link></td>\n                  <td>{order.value}</td>\n                </tr>\n              )}\n            </tbody>\n          </Table>\n        </div>\n      </div>\n      <style global jsx>{`\n        .payments-wrapper .bg-dark {\n          background-color: ${backgroundColor} !important;\n          /* It's appearing a compiler error here on dev at Windows,\n          but apparently it has already been resolved in newer versions of next and styled-jsx:\n          https://github.com/zeit/next.js/issues/9065 */\n        }\n        td > a  {\n          color: var(--gray);\n          line-height: 1.5;\n          text-decoration: underline;\n        }\n        dd > a {\n          color: var(--primary);\n        }\n        td > a:hover {\n          color: var(--primary-hover);\n        }\n        dd > a:hover {\n          text-decoration: underline;\n          color: var(--primary-hover);\n        }\n        h3 {\n          margin-bottom: 25px;\n        }\n        .table {\n          margin-top: 15px;\n        }\n        .table-dark {\n          background: transparent;\n        }\n        .table-sm {\n          font-size: 16px;\n        }\n        .card-text {\n          font-size: 14px;\n        }\n        .table-dark.table-hover tbody tr:hover {\n          background-color: var(--primary-alpha);\n        }\n        .mobile-table {\n          font-size: 16px;\n          margin-top: 40px;\n          margin-bottom: 20px;\n          display: none;\n        }\n        .mobile-row {\n          border-top: 1px solid white;\n        }\n        dl:first-child {\n          margin-top: 15px;\n        }\n        dl {\n          margin-bottom: 0.5rem;\n        }\n        dt, dd {\n          font-weight: 300;\n          display: inline;\n        }\n        dd {\n          float:right;\n        }\n        @media only screen and (max-width: 767px) {\n          .mobile-table {\n            display: inherit;\n          }\n          .table {\n            display: none;\n          }\n        }\n    `}</style>\n  </Layout>\n)}\n\nPaymentsPage.getInitialProps = async ({ api, user }) => {\n  let packages\n  try {\n    const { data } = await api.get('packages')\n    packages = { items: data }\n  } catch(error) {\n    packages = { error }\n  }\n  return { packages, user }\n}\n\nexport default withAuth(PaymentsPage);\n"]},"metadata":{},"sourceType":"module"}