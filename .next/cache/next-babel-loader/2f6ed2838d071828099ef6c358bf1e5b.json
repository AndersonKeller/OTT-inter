{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport { useEffect, useState, useContext } from 'react';\nimport { Card, Table } from 'react-bootstrap';\nimport { ThemeContext } from 'styled-components';\nimport { PackageRadio } from '~/components/Packages';\nimport withAuth from '~/components/withAuth';\nimport Layout from '~/components/layout/Layout';\nimport { CONFIG } from '~/config';\n\nconst PaymentsPage = ({\n  api,\n  layoutProps,\n  packages,\n  user\n}) => {\n  const {\n    0: plan,\n    1: setPlan\n  } = useState({});\n  const {\n    0: subscription,\n    1: setSubscription\n  } = useState({});\n  const {\n    0: orders,\n    1: setOrders\n  } = useState([]);\n  useEffect(_ => {\n    (async _ => {\n      try {\n        const {\n          data: {\n            package_id\n          }\n        } = await api.get('subscription'),\n              data = _objectWithoutProperties((await api.get('subscription')).data, [\"package_id\"]);\n\n        console.log(data);\n        setSubscription(data);\n\n        if (package_id) {\n          setPlan(packages.items.find(item => item.id == package_id));\n        } else {\n          setPlan(packages.items.find(item => item.amount == 0));\n        }\n      } catch (error) {\n        console.log(error);\n      }\n    })();\n  }, []);\n  useEffect(_ => {\n    (async _ => {\n      try {\n        const {\n          data\n        } = await api.get('cash-orders');\n        setOrders(data);\n      } catch (error) {\n        console.log(error);\n      }\n    })();\n  }, []);\n  const theme = useContext(ThemeContext);\n  const backgroundColor = theme.colors.backgroundContrast;\n  return __jsx(Layout, layoutProps, __jsx(Head, null, __jsx(\"title\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Pagos < \", CONFIG.appName, \" \")), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"payments-wrapper\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"container\"\n  }, __jsx(\"h3\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"title\"\n  }, \"Pagos\"), __jsx(Card, {\n    bg: \"dark\",\n    text: \"white\"\n  }, __jsx(Card.Body, null, __jsx(Card.Title, null, \"Tu plan\"), __jsx(Card.Text, null, \"Todo el contenido de \", CONFIG.appName, \" por \", plan.name, \".\"), __jsx(\"div\", {\n    style: {\n      fontSize: '13px',\n      lineHeight: '0.7rem',\n      padding: 0\n    },\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"col-5 col-md-2 text-center\"\n  }, __jsx(PackageRadio, {\n    readOnly: true,\n    package_id: plan.id,\n    plan: plan\n  }))), __jsx(Card.Footer, {\n    style: {\n      fontSize: '12px',\n      lineHeight: 1\n    }\n  }, \"Pr\\xF3xima factura: \", subscription.ends_at && subscription.ends_at.split(' ')[0])), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"mobile-table\"\n  }, orders.map(order => __jsx(\"div\", {\n    key: order.id,\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]]) + \" \" + \"mobile-row\"\n  }, __jsx(\"dl\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(\"dt\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Fecha\"), __jsx(\"dd\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(Link, {\n    href: \"receipt\"\n  }, __jsx(\"a\", {\n    target: \"_blank\",\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, order.paid_at && order.paid_at.split(' ')[0])))), __jsx(\"dl\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(\"dt\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Descripci\\xF3n\"), __jsx(\"dd\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, CONFIG.appName)), __jsx(\"dl\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(\"dt\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Periodo\"), __jsx(\"dd\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, order.paid_at && order.paid_at.split(' ')[0], \"-\")), __jsx(\"dl\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(\"dt\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Medio de Pago\"), __jsx(\"dd\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(Link, {\n    href: \"receipt\"\n  }, __jsx(\"a\", {\n    target: \"_blank\",\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, order.download_link)))), __jsx(\"dl\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(\"dt\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Total\"), __jsx(\"dd\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, order.value))))), __jsx(Table, {\n    className: \"desktop-table\",\n    hover: true,\n    variant: \"dark\",\n    size: \"sm\"\n  }, __jsx(\"thead\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(\"tr\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"#\"), __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Fecha\"), __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Descripci\\xF3n\"), __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Periodo\"), __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Medio de Pago\"), __jsx(\"th\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, \"Total\"))), __jsx(\"tbody\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, orders.map(order => __jsx(\"tr\", {\n    key: order.id,\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(\"td\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, order.id), __jsx(\"td\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(Link, {\n    href: \"receipt\"\n  }, __jsx(\"a\", {\n    target: \"_blank\",\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, order.paid_at && order.paid_at.split(' ')[0]))), __jsx(\"td\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, CONFIG.appName), __jsx(\"td\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, order.paid_at && order.paid_at.split(' ')[0], \"-\"), __jsx(\"td\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, __jsx(Link, {\n    href: \"receipt\"\n  }, __jsx(\"a\", {\n    target: \"_blank\",\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, order.download_link))), __jsx(\"td\", {\n    className: _JSXStyle.dynamic([[\"556766073\", [backgroundColor]]])\n  }, order.value))))))), __jsx(_JSXStyle, {\n    id: \"556766073\",\n    dynamic: [backgroundColor]\n  }, [`.payments-wrapper .bg-dark{background-color:${backgroundColor} !important;}`, \"td>a{color:var(--gray);line-height:1.5;-webkit-text-decoration:underline;text-decoration:underline;}\", \"dd>a{color:var(--primary);}\", \"td>a:hover{color:var(--primary-hover);}\", \"dd>a:hover{-webkit-text-decoration:underline;text-decoration:underline;color:var(--primary-hover);}\", \"h3{margin-bottom:25px;}\", \".table{margin-top:15px;}\", \".table-dark{background:transparent;}\", \".table-sm{font-size:16px;}\", \".card-text{font-size:14px;}\", \".table-dark.table-hover tbody tr:hover{background-color:var(--primary-alpha);}\", \".mobile-table{font-size:16px;margin-top:40px;margin-bottom:20px;display:none;}\", \".mobile-row{border-top:1px solid white;}\", \"dl:first-child{margin-top:15px;}\", \"dl{margin-bottom:0.5rem;}\", \"dt,dd{font-weight:300;display:inline;}\", \"dd{float:right;}\", \"@media only screen and (max-width:767px){.mobile-table{display:inherit;}.table{display:none;}}\"]));\n};\n\nPaymentsPage.getInitialProps = async ({\n  api,\n  user\n}) => {\n  let packages;\n\n  try {\n    const {\n      data\n    } = await api.get('packages');\n    packages = {\n      items: data\n    };\n  } catch (error) {\n    packages = {\n      error\n    };\n  }\n\n  return {\n    packages,\n    user\n  };\n};\n\nexport default withAuth(PaymentsPage);","map":{"version":3,"sources":["/Users/rafael/Projects/somosgad/dale/pages/user/payments.js"],"names":["Head","Link","useEffect","useState","useContext","Card","Table","ThemeContext","PackageRadio","withAuth","Layout","CONFIG","PaymentsPage","api","layoutProps","packages","user","plan","setPlan","subscription","setSubscription","orders","setOrders","_","data","package_id","get","console","log","items","find","item","id","amount","error","theme","backgroundColor","colors","backgroundContrast","appName","name","fontSize","lineHeight","padding","ends_at","split","map","order","paid_at","download_link","value","getInitialProps"],"mappings":"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","sourcesContent":["import Head from 'next/head'\nimport Link   from 'next/link'\nimport { useEffect, useState, useContext } from 'react'\nimport { Card, Table } from 'react-bootstrap'\nimport { ThemeContext } from 'styled-components'\nimport { PackageRadio } from '~/components/Packages'\nimport withAuth         from '~/components/withAuth'\nimport Layout           from '~/components/layout/Layout'\nimport { CONFIG }       from '~/config'\n\nconst PaymentsPage = ({ api, layoutProps, packages, user }) => {\n\n  const [ plan, setPlan ] = useState({})\n  const [ subscription, setSubscription ] = useState({})\n  const [ orders, setOrders ] = useState([])\n\n  useEffect(_ => {\n    (async _ => {\n      try{\n        const { data: {package_id, ...data} } = await api.get('subscription')\n        console.log(data)\n        setSubscription(data)\n\n        if(package_id){\n          setPlan(packages.items.find(item => item.id == package_id))\n        }else{\n          setPlan(packages.items.find(item => item.amount == 0))\n        }\n      }catch(error){\n        console.log(error)\n      }\n    })()\n  }, [])\n\n  useEffect(_ => {\n    (async _ => {\n      try{\n        const { data } = await api.get('cash-orders')\n        setOrders(data)\n      }catch(error){\n        console.log(error)\n      }\n    })()\n  }, [])\n\n  const theme = useContext(ThemeContext)\n  const backgroundColor = theme.colors.backgroundContrast\n\n  return (\n    <Layout { ...layoutProps }>\n      <Head>\n        <title>Pagos &lt; {CONFIG.appName} </title>\n      </Head>\n      <div className=\"payments-wrapper\">\n        <div className=\"container\">\n          <h3 className=\"title\">Pagos</h3>\n          <Card bg=\"dark\" text=\"white\">\n            <Card.Body>\n              <Card.Title>Tu plan</Card.Title>\n              <Card.Text>Todo el contenido de {CONFIG.appName} por {plan.name}.</Card.Text>\n              <div className=\"col-5 col-md-2 text-center\" style={{fontSize: '13px', lineHeight: '0.7rem', padding: 0}}>\n                <PackageRadio\n                  readOnly\n                  package_id={plan.id}\n                  plan={plan}\n                />\n              </div>\n            </Card.Body>\n            <Card.Footer style={{fontSize: '12px', lineHeight: 1}}>\n              Próxima factura: {subscription.ends_at && subscription.ends_at.split(' ')[0]}\n            </Card.Footer>\n          </Card>\n          <div className=\"mobile-table\">\n            {orders.map(order =>\n              <div className=\"mobile-row\" key={order.id}>\n                <dl>\n                  <dt>Fecha</dt>\n                  <dd><Link href=\"receipt\"><a target=\"_blank\">{order.paid_at && order.paid_at.split(' ')[0]}</a></Link></dd>\n                </dl>\n                <dl>\n                  <dt>Descripción</dt>\n                  <dd>{CONFIG.appName}</dd>\n                </dl>\n                <dl>\n                  <dt>Periodo</dt>\n                  <dd>{order.paid_at && order.paid_at.split(' ')[0]}-</dd>\n                </dl>\n                <dl>\n                  <dt>Medio de Pago</dt>\n                  <dd><Link href=\"receipt\"><a target=\"_blank\">{order.download_link}</a></Link></dd>\n                </dl>\n                <dl>\n                  <dt>Total</dt>\n                  <dd>{order.value}</dd>\n                </dl>\n              </div>\n            )}\n            {/* <div className=\"mobile-row\">\n              <dl>\n                <dt>Fecha</dt>\n                <dd><Link href=\"receipt\"><a target=\"_blank\">09/01/2020</a></Link></dd>\n              </dl>\n              <dl>\n                <dt>Descripción</dt>\n                <dd>{CONFIG.appName}</dd>\n              </dl>\n              <dl>\n                <dt>Periodo</dt>\n                <dd>09/01/2020—08/02/2020</dd>\n              </dl>\n              <dl>\n                <dt>Medio de Pago</dt>\n                <dd>VISA •••• •••• •••• 1627</dd>\n              </dl>\n              <dl>\n                <dt>Total</dt>\n                <dd>$99,00</dd>\n              </dl>\n            </div> */}\n          </div>\n          <Table className=\"desktop-table\" hover variant=\"dark\" size=\"sm\">\n            <thead>\n              <tr>\n                <th>#</th>\n                <th>Fecha</th>\n                <th>Descripción</th>\n                <th>Periodo</th>\n                <th>Medio de Pago</th>\n                <th>Total</th>\n              </tr>\n            </thead>\n            <tbody>\n              {orders.map(order =>\n                <tr key={order.id}>\n                  <td>{order.id}</td>\n                  <td><Link href=\"receipt\"><a target=\"_blank\">{order.paid_at && order.paid_at.split(' ')[0]}</a></Link></td>\n                  <td>{CONFIG.appName}</td>\n                  <td>{order.paid_at && order.paid_at.split(' ')[0]}-</td>\n                  <td><Link href=\"receipt\"><a target=\"_blank\">{order.download_link}</a></Link></td>\n                  <td>{order.value}</td>\n                </tr>\n              )}\n            </tbody>\n          </Table>\n        </div>\n      </div>\n      <style global jsx>{`\n        .payments-wrapper .bg-dark {\n          background-color: ${backgroundColor} !important;\n          /* It's appearing a compiler error here on dev at Windows,\n          but apparently it has already been resolved in newer versions of next and styled-jsx:\n          https://github.com/zeit/next.js/issues/9065 */\n        }\n        td > a  {\n          color: var(--gray);\n          line-height: 1.5;\n          text-decoration: underline;\n        }\n        dd > a {\n          color: var(--primary);\n        }\n        td > a:hover {\n          color: var(--primary-hover);\n        }\n        dd > a:hover {\n          text-decoration: underline;\n          color: var(--primary-hover);\n        }\n        h3 {\n          margin-bottom: 25px;\n        }\n        .table {\n          margin-top: 15px;\n        }\n        .table-dark {\n          background: transparent;\n        }\n        .table-sm {\n          font-size: 16px;\n        }\n        .card-text {\n          font-size: 14px;\n        }\n        .table-dark.table-hover tbody tr:hover {\n          background-color: var(--primary-alpha);\n        }\n        .mobile-table {\n          font-size: 16px;\n          margin-top: 40px;\n          margin-bottom: 20px;\n          display: none;\n        }\n        .mobile-row {\n          border-top: 1px solid white;\n        }\n        dl:first-child {\n          margin-top: 15px;\n        }\n        dl {\n          margin-bottom: 0.5rem;\n        }\n        dt, dd {\n          font-weight: 300;\n          display: inline;\n        }\n        dd {\n          float:right;\n        }\n        @media only screen and (max-width: 767px) {\n          .mobile-table {\n            display: inherit;\n          }\n          .table {\n            display: none;\n          }\n        }\n    `}</style>\n  </Layout>\n)}\n\nPaymentsPage.getInitialProps = async ({ api, user }) => {\n  let packages\n  try {\n    const { data } = await api.get('packages')\n    packages = { items: data }\n  } catch(error) {\n    packages = { error }\n  }\n  return { packages, user }\n}\n\nexport default withAuth(PaymentsPage);\n"]},"metadata":{},"sourceType":"module"}