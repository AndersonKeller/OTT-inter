{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport Head from 'next/head';\nimport Link from 'next/link';\nimport React, { useContext, useEffect, useState } from 'react';\nimport styled from 'styled-components';\nimport Button from '../components/button';\nimport CarouselSection from '../components/carousel-section';\nimport Featured from '../components/featured';\nimport Layout from '../components/layout/Layout';\nimport Loading from '../components/Loading/Loading';\nimport MediaLink from '../components/MediaLink/MediaLink';\nimport WishlistBtn from '../components/wishlist-btn';\nimport UserContext from '../contexts/UserContext';\nimport { CONFIG } from '../config';\nimport api from '../services/api';\nimport withApi from '~/components/withApi';\nimport Color from 'color';\n\nconst HomePage = ({\n  api,\n  contents,\n  featuredMedia,\n  featuredMediaError,\n  layoutProps\n}) => {\n  const {\n    user\n  } = useContext(UserContext);\n  const {\n    appName: pageTitle\n  } = CONFIG;\n  return __jsx(Layout, _extends({\n    paddingTop: false\n  }, layoutProps), __jsx(Head, null, __jsx(\"title\", {\n    className: \"jsx-29549889\"\n  }, pageTitle)), __jsx(\"div\", {\n    className: \"jsx-29549889\" + \" \" + \"index\"\n  }, __jsx(Cover, {\n    error: featuredMediaError,\n    media: featuredMedia\n  }), __jsx(\"div\", {\n    className: \"jsx-29549889\" + \" \" + \"index__contents\"\n  }, contents && contents.map((item, index) => {\n    const showBanner = item.is_paid && user || !item.is_paid && !user;\n    const {\n      contentable_type: contentableType\n    } = item;\n\n    switch (contentableType) {\n      case 'categories':\n        return __jsx(HomeCarouselSection, {\n          api: api,\n          category: item.slug,\n          key: index\n        });\n\n      case 'banners':\n        return showBanner && __jsx(BannerSection, {\n          id: item.contentable_id,\n          key: index\n        });\n\n      case 'movies':\n        return showBanner && __jsx(BannerSection, {\n          movie: item.slug,\n          key: index\n        });\n    }\n  }))), __jsx(_JSXStyle, {\n    id: \"29549889\"\n  }, [\".index.jsx-29549889{margin-bottom:75px;}\", \".index__contents.jsx-29549889{position:relative;z-index:2;}\", \"@media (min-width:768px){.index.jsx-29549889{margin-bottom:30px;}}\"]));\n};\n\nHomePage.getInitialProps = async ctx => {\n  const {\n    api\n  } = ctx;\n  const {\n    data: homePage\n  } = await api.get('pages/home');\n\n  try {\n    const [firstContent, ...contents] = homePage.contents;\n    const {\n      data: {\n        movie: featuredMedia\n      }\n    } = await api.get('movie/' + firstContent.slug + '?for=home-cover');\n    return {\n      contents,\n      featuredMedia\n    };\n  } catch (error) {\n    const [...contents] = homePage.contents;\n    return {\n      contents,\n      featuredMediaError: error\n    };\n  }\n};\n\nexport default withApi(HomePage);\nconst CoverImgContent = styled.div.withConfig({\n  displayName: \"pages__CoverImgContent\",\n  componentId: \"zvtr18-0\"\n})([\"background-image:linear-gradient(to bottom,\", \" 80%,\", \" 100%),radial-gradient(circle at 50% 50%,\", \" 25%,\", \" 75%),url('\", \"');background-position:50% 0,50% 0,75% 0;background-repeat:no-repeat,no-repeat,no-repeat;background-size:cover,cover,cover;&::before{content:'';display:block;padding-bottom:112.5%;}@media (min-width:768px){background-image:linear-gradient(to bottom,\", \" 80%,\", \" 100%),radial-gradient(circle at 67.5% 57.5%,\", \" 25%,\", \" 42.5%),url('\", \"');background-position:50% 0,50% 0,40% 50%;&::before{padding-bottom:80%;}}@media (min-width:1200px){background-position:50% 0,50% 0,75% 50%;&::before{padding-bottom:48%;}}\"], props => Color(props.theme.colors.background).fade(1).string(), props => props.theme.colors.background, props => Color(props.theme.colors.background).fade(1).string(), props => Color(props.theme.colors.background).fade(.075).string(), props => props.posterUrl, props => Color(props.theme.colors.background).fade(1).string(), props => props.theme.colors.background, props => Color(props.theme.colors.background).fade(1).string(), props => Color(props.theme.colors.background).fade(.075).string(), props => props.posterUrl);\n\nconst Cover = ({\n  error,\n  media\n}) => {\n  if (error) {\n    return __jsx(\"p\", null, \"No se puede cargar contenido destacado\");\n  }\n\n  const {\n    user\n  } = useContext(UserContext);\n  const {\n    description,\n    logo,\n    poster_url\n  } = media || {};\n  const {\n    height,\n    url: {\n      default: fallback,\n      png,\n      webp\n    } = {},\n    width\n  } = logo || {};\n  const empezaYa = CONFIG.lang === 'es-CL' ? '¡Vívelo ahora!' : '¡Empezá Ya!';\n  return __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"cover container-fluid\"\n  }, poster_url && __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"cover__img row\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"col p-0\"\n  }, __jsx(CoverImgContent, {\n    posterUrl: poster_url\n  }, __jsx(\"img\", {\n    alt: \"\",\n    src: poster_url,\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"d-none\"\n  })))), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"cover__contents row\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"col-12 col-md-4 offset-md-1\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"cover__infos\"\n  }, logo && __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"row\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"col-8 offset-2 col-md-12 offset-md-0\"\n  }, __jsx(\"h1\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"cover__logo\"\n  }, __jsx(\"picture\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]])\n  }, __jsx(\"source\", {\n    srcSet: webp,\n    type: \"media/webp\",\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]])\n  }), __jsx(\"source\", {\n    srcSet: png,\n    type: \"media/png\",\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]])\n  }), __jsx(\"img\", {\n    height: height,\n    src: fallback,\n    width: width,\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"img-fluid\"\n  }))))), description && __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"row cover__description\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"col-10 offset-1 col-md-12 offset-md-0\"\n  }, __jsx(\"p\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"mb-0\"\n  }, description)))), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"row justify-content-center gutter-15\"\n  }, !user ? __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"col-auto\"\n  }, __jsx(Link, {\n    href: \"/subscriptor\",\n    passHref: true\n  }, __jsx(Button, null, empezaYa))) : __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"col-auto\"\n  }, __jsx(MediaLink, _extends({\n    media\n  }, {\n    passHref: true\n  }), __jsx(Button, null, \"Mira\"))), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"1905217443\", [logo ? height * 100 / width + '%' : 0]]]) + \" \" + \"col-auto\"\n  }, __jsx(WishlistBtn, {\n    movieId: media.id\n  })))))), __jsx(_JSXStyle, {\n    id: \"1905217443\",\n    dynamic: [logo ? height * 100 / width + '%' : 0]\n  }, [\".cover.__jsx-style-dynamic-selector{font-size:12px;line-height:1.4;margin-bottom:15px;overflow:hidden;padding-bottom:15px;position:relative;text-align:center;z-index:1;}\", \".cover__img.__jsx-style-dynamic-selector{margin-bottom:-90px;}\", \".cover__infos.__jsx-style-dynamic-selector{margin-bottom:15px;}\", \".cover__logo.__jsx-style-dynamic-selector{margin-top:0;margin-bottom:15px;position:relative;}\", `.cover__logo.__jsx-style-dynamic-selector::before{content:'';display:block;padding-bottom:${logo ? height * 100 / width + '%' : 0};}`, \".cover__logo.__jsx-style-dynamic-selector img.__jsx-style-dynamic-selector{left:0;position:absolute;top:0;}\", \"@media (min-width:768px){.cover.__jsx-style-dynamic-selector{font-size:16px;line-height:1.5;margin-bottom:-60px;text-align:left;}.cover__img.__jsx-style-dynamic-selector{margin-bottom:0;}.cover__contents.__jsx-style-dynamic-selector{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:100%;padding-top:var(--padding-top);padding-bottom:60px;position:absolute;width:100%;top:0;}.cover__infos.__jsx-style-dynamic-selector{margin-bottom:15px;}}\"]));\n};\n\nconst HomeCarouselSection = ({\n  api,\n  category: categorySlug\n}) => {\n  const {\n    0: category,\n    1: setCategory\n  } = useState(null);\n  const {\n    0: error,\n    1: setError\n  } = useState(false);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    lang\n  } = CONFIG;\n  useEffect(() => {\n    async function fetchData() {\n      setError(false);\n      setLoading(true);\n\n      try {\n        const {\n          data\n        } = await api.get(`category/${categorySlug}`);\n        setCategory(data);\n      } catch (error) {\n        const errorMessage = ['es', 'es-CL'].includes(lang) ? 'Error al intentar cargar la categoría' : 'Error trying to load category';\n        setError(errorMessage);\n      }\n\n      setLoading(false);\n    }\n\n    fetchData();\n  }, [categorySlug]);\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"jsx-2239041638\" + \" \" + \"home-carousel-section\"\n  }, loading ? __jsx(\"div\", {\n    className: \"jsx-2239041638\" + \" \" + \"text-center\"\n  }, __jsx(Loading, {\n    loadingState: loading\n  })) : category ? __jsx(CarouselSection, {\n    category: category\n  }) : error && __jsx(\"div\", {\n    className: \"jsx-2239041638\" + \" \" + \"text-center\"\n  }, error)), __jsx(_JSXStyle, {\n    id: \"2239041638\"\n  }, [\".home-carousel-section.jsx-2239041638{margin-bottom:25px;}\", \"@media (min-width:768px){.home-carousel-section.jsx-2239041638{margin-bottom:55px;}}\"]));\n};\n\nconst BannerSection = ({\n  id,\n  movie\n}) => {\n  const {\n    0: banner,\n    1: setBanner\n  } = useState();\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(false);\n  const {\n    0: error,\n    1: setError\n  } = useState();\n  useEffect(_ => {\n    async function fetchData() {\n      setLoading(true);\n\n      try {\n        const {\n          data\n        } = await (id ? api().get(`/banners/${id}`) : api().get(`/movie/${movie}`));\n        setBanner(data);\n      } catch (error) {\n        setError(true);\n      }\n\n      setLoading(false);\n    }\n\n    fetchData();\n  }, [id]);\n  return __jsx(\"div\", {\n    className: \"jsx-1694855813\"\n  }, __jsx(\"div\", {\n    className: \"jsx-1694855813\" + \" \" + \"section\"\n  }, __jsx(\"div\", {\n    className: \"jsx-1694855813\" + \" \" + \"text-center\"\n  }, __jsx(Loading, {\n    loadingState: loading\n  })), banner && id && __jsx(\"a\", {\n    href: banner.link,\n    target: \"_blank\",\n    className: \"jsx-1694855813\" + \" \" + \"sponsor-link\"\n  }, __jsx(Featured, {\n    img: banner.banner_url\n  })), banner && movie && __jsx(MediaLink, {\n    media: banner.movie,\n    passHref: true\n  }, __jsx(\"a\", {\n    className: \"jsx-1694855813\"\n  }, __jsx(Featured, {\n    className: \"gradient\",\n    img: banner.movie.poster_url\n  }))), error && __jsx(\"div\", {\n    className: \"jsx-1694855813\" + \" \" + \"text-center\"\n  }, \"Error\")), __jsx(_JSXStyle, {\n    id: \"1694855813\"\n  }, [\".sponsor-link.jsx-1694855813{color:white !important;-webkit-text-decoration:none;text-decoration:none;}\", \".sponsor-link.jsx-1694855813:hover{color:white !important;-webkit-text-decoration:none;text-decoration:none;}\", \"a.jsx-1694855813:not([href]):not([tabindex]):hover{color:white !important;-webkit-text-decoration:none;text-decoration:none;}\"]));\n};","map":{"version":3,"sources":["/Users/rafael/Projects/somosgad/dale/pages/index.js"],"names":["Head","Link","React","useContext","useEffect","useState","styled","Button","CarouselSection","Featured","Layout","Loading","MediaLink","WishlistBtn","UserContext","CONFIG","api","withApi","Color","HomePage","contents","featuredMedia","featuredMediaError","layoutProps","user","appName","pageTitle","map","item","index","showBanner","is_paid","contentable_type","contentableType","slug","contentable_id","getInitialProps","ctx","data","homePage","get","firstContent","movie","error","CoverImgContent","div","props","theme","colors","background","fade","string","posterUrl","Cover","media","description","logo","poster_url","height","url","default","fallback","png","webp","width","empezaYa","lang","id","HomeCarouselSection","category","categorySlug","setCategory","setError","loading","setLoading","fetchData","errorMessage","includes","BannerSection","banner","setBanner","_","link","banner_url"],"mappings":"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","sourcesContent":["import Head from 'next/head'\nimport Link from 'next/link'\nimport React, { useContext, useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport Button from '../components/button'\nimport CarouselSection from '../components/carousel-section'\nimport Featured from '../components/featured'\nimport Layout from '../components/layout/Layout'\nimport Loading from '../components/Loading/Loading'\nimport MediaLink from '../components/MediaLink/MediaLink'\nimport WishlistBtn from '../components/wishlist-btn'\nimport UserContext from '../contexts/UserContext'\nimport { CONFIG } from '../config'\nimport api from '../services/api'\nimport withApi from '~/components/withApi'\nimport Color from 'color'\n\nconst HomePage = ({ api, contents, featuredMedia, featuredMediaError, layoutProps }) => {\n  const { user } = useContext(UserContext)\n  const { appName: pageTitle } = CONFIG\n  return (\n    <Layout paddingTop={false} {...layoutProps}>\n      <Head>\n        <title>{pageTitle}</title>\n      </Head>\n      <div className=\"index\">\n\n        {/* cover */}\n        <Cover error={featuredMediaError} media={featuredMedia} />\n        {/* <Cover media={featuredMedia} /> */}\n\n        {/* contents */}\n        <div className=\"index__contents\">\n          {contents && contents.map((item, index) => {\n            const showBanner = (item.is_paid && user || !item.is_paid && !user)\n            const { contentable_type: contentableType } = item\n            switch(contentableType) {\n              case 'categories': return <HomeCarouselSection api={api} category={item.slug} key={index} />\n              case 'banners':    return showBanner && <BannerSection id={item.contentable_id} key={index} />\n              case 'movies':     return showBanner && <BannerSection movie={item.slug} key={index} />\n            }\n          })}\n        </div>\n\n      </div>\n      <style jsx>{`\n        .index {\n          margin-bottom: 75px;\n        }\n        .index__contents {\n          position: relative;\n          z-index: 2;\n        }\n        @media (min-width: 768px) {\n          .index {\n            margin-bottom: 30px;\n          }\n        }\n      `}</style>\n    </Layout>\n  )\n}\n\nHomePage.getInitialProps = async ctx => {\n  const { api } = ctx\n  const { data: homePage } = await api.get('pages/home');\n\n  try {\n    const [ firstContent, ...contents ] = homePage.contents\n    const { data: { movie: featuredMedia } } = await api.get('movie/' + firstContent.slug + '?for=home-cover')\n    return { contents, featuredMedia }\n  } catch (error) {\n    const [ ...contents ] = homePage.contents;\n    return { contents , featuredMediaError: error };\n  }\n}\n\nexport default withApi(HomePage)\n\nconst CoverImgContent = styled.div`\n  background-image:\n    linear-gradient(to bottom, ${props => Color(props.theme.colors.background).fade(1).string()} 80%, ${props => props.theme.colors.background} 100%),\n    radial-gradient(circle at 50% 50%, ${props => Color(props.theme.colors.background).fade(1).string()} 25%, ${props => Color(props.theme.colors.background).fade(.075).string()} 75%),\n    url('${props => props.posterUrl}');\n  background-position: 50% 0, 50% 0, 75% 0;\n  background-repeat: no-repeat, no-repeat, no-repeat;\n  background-size: cover, cover, cover;\n  &::before {\n    content: '';\n    display: block;\n    padding-bottom: 112.5%;\n  }\n  @media (min-width: 768px) {\n    background-image:\n      linear-gradient(to bottom, ${props => Color(props.theme.colors.background).fade(1).string()} 80%, ${props => props.theme.colors.background} 100%),\n      radial-gradient(circle at 67.5% 57.5%, ${props => Color(props.theme.colors.background).fade(1).string()} 25%, ${props => Color(props.theme.colors.background).fade(.075).string()} 42.5%),\n      url('${props => props.posterUrl}');\n    background-position: 50% 0, 50% 0, 40% 50%;\n    &::before {\n      padding-bottom: 80%;\n    }\n  }\n  @media (min-width: 1200px) {\n    background-position: 50% 0, 50% 0, 75% 50%;\n    &::before {\n      padding-bottom: 48%;\n    }\n  }\n`\n\nconst Cover = ({ error, media }) => {\n  if (error) {\n    return (\n      <p>No se puede cargar contenido destacado</p>\n    )\n  }\n  const { user } = useContext(UserContext)\n  const { description, logo, poster_url } = media || {}\n  const {\n    height,\n    url: { default: fallback, png, webp } = {},\n    width,\n  } = logo || {}\n  const empezaYa = CONFIG.lang === 'es-CL' ? '¡Vívelo ahora!' : '¡Empezá Ya!'\n  return (\n    <div className=\"cover container-fluid\">\n\n      {/* poster backaground banner image */}\n      {\n        poster_url && (\n        <div className=\"cover__img row\">\n          <div className=\"col p-0\">\n            <CoverImgContent posterUrl={poster_url}>\n              <img alt=\"\" className=\"d-none\" src={poster_url} />\n            </CoverImgContent>\n          </div>\n        </div>\n        )\n      }\n\n      <div className=\"cover__contents row\">\n        <div className=\"col-12 col-md-4 offset-md-1\">\n          <div className=\"cover__infos\">\n\n            {/* logo overlay image */}\n            {logo && (\n              <div className=\"row\">\n                <div className=\"col-8 offset-2 col-md-12 offset-md-0\">\n                  <h1 className=\"cover__logo\">\n                    <picture>\n                      <source srcSet={webp} type=\"media/webp\" />\n                      <source srcSet={png} type=\"media/png\" />\n                      <img className=\"img-fluid\" height={height} src={fallback} width={width} />\n                    </picture>\n                  </h1>\n                </div>\n              </div>\n            )}\n\n            {/* content's description */}\n            {description && (\n              <div className=\"row cover__description\">\n                <div className=\"col-10 offset-1 col-md-12 offset-md-0\">\n                  <p className=\"mb-0\">{description}</p>\n                </div>\n              </div>\n            )}\n\n          </div>\n\n          {/* cta buttons */}\n          <div className=\"row justify-content-center gutter-15\">\n            { ! user ? (\n              <div className=\"col-auto\">\n                <Link href=\"/subscriptor\" passHref>\n                  <Button>{empezaYa}</Button>\n                </Link>\n              </div>\n            ) : <>\n              <div className=\"col-auto\">\n                <MediaLink {...{media}} passHref>\n                  <Button>Mira</Button>\n                </MediaLink>\n              </div>\n              <div className=\"col-auto\">\n                <WishlistBtn movieId={media.id} />\n              </div>\n            </> }\n          </div>\n\n        </div>\n      </div>\n\n      {/* styles */}\n      <style jsx>{`\n        .cover {\n          font-size: 12px;\n          line-height: 1.4;\n          margin-bottom: 15px;\n          overflow: hidden;\n          padding-bottom: 15px;\n          position: relative;\n          text-align: center;\n          z-index: 1;\n        }\n        .cover__img {\n          margin-bottom: -90px;\n        }\n        .cover__infos {\n          margin-bottom: 15px;\n        }\n        .cover__logo {\n          margin-top: 0;\n          margin-bottom: 15px;\n          position: relative;\n        }\n        .cover__logo::before {\n          content: '';\n          display: block;\n          padding-bottom: ${logo ? height * 100 / width + '%' : 0};\n        }\n        .cover__logo img {\n          left: 0;\n          position: absolute;\n          top: 0;\n        }\n        @media (min-width: 768px) {\n          .cover {\n            font-size: 16px;\n            line-height: 1.5;\n            margin-bottom: -60px;\n            text-align: left;\n          }\n          .cover__img {\n            margin-bottom: 0;\n          }\n          .cover__contents {\n            align-items: center;\n            height: 100%;\n            padding-top: var(--padding-top);\n            padding-bottom: 60px;\n            position: absolute;\n            width: 100%;\n            top: 0;\n          }\n          .cover__infos {\n            margin-bottom: 15px;\n          }\n        }\n      `}</style>\n\n    </div>\n  )\n}\n\nconst HomeCarouselSection = ({ api, category: categorySlug }) => {\n\n  const [ category, setCategory ] = useState(null)\n  const [ error, setError ] = useState(false)\n  const [ loading, setLoading ] = useState(false)\n  const { lang } = CONFIG\n\n  useEffect(() => {\n    async function fetchData() {\n      setError(false)\n      setLoading(true)\n      try {\n        const { data } = await api.get(`category/${categorySlug}`)\n        setCategory(data)\n      } catch (error) {\n        const errorMessage = ['es', 'es-CL'].includes(lang) ? 'Error al intentar cargar la categoría'\n          : 'Error trying to load category'\n        setError(errorMessage)\n      }\n      setLoading(false)\n    }\n    fetchData()\n  }, [categorySlug])\n\n  return (\n    <>\n      <div className=\"home-carousel-section\">\n        { loading ? (\n          <div className=\"text-center\">\n            <Loading loadingState={loading} />\n          </div>\n        ) : category ? (\n          <CarouselSection category={category} />\n        ) : error && (\n          <div className=\"text-center\">\n            {error}\n          </div>\n        ) }\n      </div>\n      <style jsx>{`\n        .home-carousel-section {\n          margin-bottom: 25px;\n        }\n        @media (min-width: 768px) {\n          .home-carousel-section {\n            margin-bottom: 55px;\n          }\n        }\n      `}</style>\n    </>\n  )\n}\n\nconst BannerSection = ({id, movie}) => {\n  const [banner, setBanner] = useState()\n  const [loading, setLoading] = useState(false)\n  const [error, setError] = useState()\n\n  useEffect(_ => {\n    async function fetchData() {\n      setLoading(true)\n      try {\n        const { data } = await (id ? api().get(`/banners/${id}`) : api().get(`/movie/${movie}`))\n        setBanner(data)\n\n      } catch (error) {\n        setError(true)\n      }\n      setLoading(false)\n    }\n    fetchData()\n  }, [id])\n\n  return (\n    <div>\n      <div className=\"section\">\n\n        {/* loading */}\n        <div className=\"text-center\">\n          <Loading loadingState={loading} />\n        </div>\n\n        {/* features */}\n        { banner && id &&\n          <a className=\"sponsor-link\" href={banner.link} target=\"_blank\">\n            <Featured img={banner.banner_url} />\n          </a>\n        }\n\n        { banner && movie &&\n          <MediaLink media={banner.movie} passHref>\n            <a>\n              <Featured\n                className=\"gradient\"\n                img={banner.movie.poster_url}\n              />\n            </a>\n          </MediaLink>\n        }\n\n        {/* error */}\n        {error && (\n          <div className=\"text-center\">Error</div>\n        )}\n\n      </div>\n      <style jsx>{`\n        .sponsor-link {\n          color: white !important;\n          text-decoration: none;\n        }\n        .sponsor-link:hover {\n          color: white !important;\n          text-decoration: none;\n        }\n        a:not([href]):not([tabindex]):hover {\n          color: white !important;\n          text-decoration: none;\n        }\n      `}</style>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}