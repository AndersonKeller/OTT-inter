{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport Head from 'next/head';\nimport Layout from '../../../components/layout/Layout';\nimport { CONFIG } from '../../../config';\nimport { useEffect } from 'react';\nimport { IS_PRODUCTION } from '../../../constants/constants';\n\nconst Page = ({\n  errorCode,\n  layoutProps\n}) => {\n  let POS;\n\n  function onSubmit(event) {\n    event.preventDefault();\n    const data = {\n      token_type: \"card_cvv_code\",\n      credit_card_cvv: document.getElementById('credit_card_cvv').value,\n      payment_method_token: document.getElementById('payment_method_token').value\n    };\n    POS.tokenize(data, onToken);\n  }\n\n  function onToken(result) {\n    const json = JSON.parse(result);\n    console.log(json);\n\n    if (json.token) {// sample response:\n\n      /* {\n        created: 1575921556971\n        token: \"NTE0ZjMyMmYtMmE0Ny00MWYyLThlN2YtOGJmNWY5NjAzNjAyY3Z2X2RlbGltaXRlcnZhdWx0OnYxOnM5UUdDL00rNitVVXAxZWdNQVJuUVg1WGdUUzR0Z2YxWEJsZjJMQzE1dGY0ZTFTOXQwMTlHVGo4Ym9CUVJlekJINy93SkpMK2srUDdrWGkxUGpFdjRBdjkxS3lnd296TUxCT0JQY1lT\"\n        token_type: \"card_cvv_code\"\n        type: \"tokenized\"\n      } */\n    }\n  }\n\n  function scriptLoaded() {\n    const payUEnv = 'test';\n    const businessUnitPublicKey = '88985036-6530-4b5a-a7ec-c4e07ec07f6c';\n    POS = window.POS;\n\n    if (!POS) {\n      return console.log('POS not defined');\n    }\n\n    POS.setPublicKey(businessUnitPublicKey);\n    POS.setEnvironment(payUEnv);\n  }\n\n  const latestJSApi = 'https://js.paymentsos.com/v2/latest/token.min.js';\n  const specifiedJSApi = 'https://js.paymentsos.com/v2/0.0.1/token.min.js';\n  const jsApi = latestJSApi || specifiedJSApi;\n  useEffect(() => {\n    const script = document.createElement(\"script\");\n    script.src = jsApi;\n    script.async = true;\n\n    script.onload = () => scriptLoaded();\n\n    document.body.appendChild(script);\n  });\n  return __jsx(Layout, _extends({\n    color: \"white\",\n    errorCode: errorCode\n  }, layoutProps), __jsx(Head, null, __jsx(\"title\", null, \"Payments Sample < \", CONFIG.appName)), \"Payments\", __jsx(\"p\", null, \"Reusing card's information\"), __jsx(\"form\", {\n    id: \"payment-form\",\n    method: \"post\",\n    onSubmit: onSubmit\n  }, __jsx(\"div\", null, __jsx(\"input\", {\n    id: \"credit_card_cvv\",\n    placeholder: \"CVV\",\n    type: \"text\"\n  })), __jsx(\"div\", null, __jsx(\"input\", {\n    id: \"payment_method_token\",\n    placeholder: \"Payment Method Token\",\n    required: true,\n    type: \"text\"\n  }), __jsx(\"p\", {\n    style: {\n      lineHeight: 1\n    }\n  }, __jsx(\"small\", null, \"Something similar to\", __jsx(\"br\", null), \"47e8dfbe-5cad-4c9f-29df-90b8bb54b6b1\"))), __jsx(\"button\", {\n    type: \"submit\"\n  }, \"Pay\")));\n};\n\nPage.getInitialProps = _ => {\n  if (IS_PRODUCTION) {\n    const errorCode = 404;\n    return {\n      errorCode\n    };\n  }\n};\n\nexport default Page;","map":{"version":3,"sources":["/Users/rafael/Projects/somosgad/dale/pages/samples/payments/js-api-cvv.js"],"names":["Head","Layout","CONFIG","useEffect","IS_PRODUCTION","Page","errorCode","layoutProps","POS","onSubmit","event","preventDefault","data","token_type","credit_card_cvv","document","getElementById","value","payment_method_token","tokenize","onToken","result","json","JSON","parse","console","log","token","scriptLoaded","payUEnv","businessUnitPublicKey","window","setPublicKey","setEnvironment","latestJSApi","specifiedJSApi","jsApi","script","createElement","src","async","onload","body","appendChild","appName","lineHeight","getInitialProps","_"],"mappings":"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","sourcesContent":["\nimport Head from 'next/head'\nimport Layout from '../../../components/layout/Layout'\nimport { CONFIG } from '../../../config'\nimport { useEffect } from 'react'\nimport { IS_PRODUCTION } from '../../../constants/constants'\n\nconst Page = ({ errorCode, layoutProps }) => {\n\n  let POS\n\n  function onSubmit(event) {\n    event.preventDefault();\n    const data = {\n      token_type: \"card_cvv_code\",\n      credit_card_cvv: document.getElementById('credit_card_cvv').value,\n      payment_method_token: document.getElementById('payment_method_token').value,\n    }\n    POS.tokenize(data, onToken)\n  }\n\n  function onToken(result) {\n    const json = JSON.parse(result)\n    console.log (json);\n    if (json.token) {\n      // sample response:\n      /* {\n        created: 1575921556971\n        token: \"NTE0ZjMyMmYtMmE0Ny00MWYyLThlN2YtOGJmNWY5NjAzNjAyY3Z2X2RlbGltaXRlcnZhdWx0OnYxOnM5UUdDL00rNitVVXAxZWdNQVJuUVg1WGdUUzR0Z2YxWEJsZjJMQzE1dGY0ZTFTOXQwMTlHVGo4Ym9CUVJlekJINy93SkpMK2srUDdrWGkxUGpFdjRBdjkxS3lnd296TUxCT0JQY1lT\"\n        token_type: \"card_cvv_code\"\n        type: \"tokenized\"\n      } */\n    }\n  }\n\n  function scriptLoaded() {\n    const payUEnv = 'test'\n    const businessUnitPublicKey = '88985036-6530-4b5a-a7ec-c4e07ec07f6c'\n    POS = window.POS\n    if ( ! POS) {\n      return console.log('POS not defined')\n    }\n    POS.setPublicKey(businessUnitPublicKey)\n    POS.setEnvironment(payUEnv)\n  }\n\n  const latestJSApi = 'https://js.paymentsos.com/v2/latest/token.min.js'\n  const specifiedJSApi = 'https://js.paymentsos.com/v2/0.0.1/token.min.js'\n  const jsApi = latestJSApi || specifiedJSApi\n\n  useEffect(() => {\n    const script = document.createElement(\"script\")\n    script.src = jsApi\n    script.async = true\n    script.onload = () => scriptLoaded()\n    document.body.appendChild(script)\n  })\n\n  return (\n    <Layout color=\"white\" errorCode={errorCode} {...layoutProps}>\n      <Head>\n        <title>Payments Sample &lt; {CONFIG.appName}</title>\n      </Head>\n        Payments\n        <p>Reusing card's information</p>\n        <form id=\"payment-form\" method=\"post\" onSubmit={onSubmit}>\n\n          {/* mandatory data */}\n          <div>\n            <input\n              id=\"credit_card_cvv\"\n              placeholder=\"CVV\"\n              type=\"text\"\n            />\n          </div>\n          <div>\n            <input\n              id=\"payment_method_token\"\n              placeholder=\"Payment Method Token\"\n              required\n              type=\"text\"\n            />\n            <p style={{lineHeight: 1}}><small>Something similar to<br />\n              47e8dfbe-5cad-4c9f-29df-90b8bb54b6b1</small></p>\n          </div>\n\n          <button type=\"submit\">Pay</button>\n        </form>\n    </Layout>\n  )\n}\n\nPage.getInitialProps = _ => {\n  if (IS_PRODUCTION) {\n    const errorCode = 404\n    return { errorCode }\n  }\n}\n\nexport default Page\n"]},"metadata":{},"sourceType":"module"}