{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nimport Head from 'next/head';\nimport Layout from '../../../components/layout/Layout';\nimport { CONFIG } from '../../../config';\nimport { useEffect } from 'react';\nimport { IS_PRODUCTION } from '../../../constants/constants';\n\nconst Page = ({\n  errorCode,\n  layoutProps\n}) => {\n  let POS;\n\n  function onSubmit(event) {\n    event.preventDefault();\n    const additionalData = {\n      holder_name: document.getElementById('cardholder-name').value,\n      custom_data: document.getElementById('custom').value\n    };\n    POS.createToken(additionalData, function (result) {\n      const json = JSON.parse(result);\n\n      if (json.token) {// sample response:\n\n        /* {\n          \"token\":\"3c82255a-7986-405b-9721-11be1d3ab6ed\",\n          \"created\":\"1575914964507\",\n          \"pass_luhn_validation\":true,\n          \"encrypted_cvv\":\"NjI0MzdmN2UtOGUwYS00MWVmLWFkZTItOGYyMDRhNjQ4YWRiY3Z2X2RlbGltaXRlcnZhdWx0OnYxOnIzd1g0aGowbXZ5NS9nQ2lPb2ZlR29tR2FDcnZHYVJEalUrTzJreTVxQ2VaSVNLSVpxNnRCSlNJQi9mVmV6am5zdzI1a3lLbFpwR2hSQjRLRExOZzVqWFBZYWtmdC9iVTE5MVZvU01y\",\n          \"token_type\":\"credit_card\",\n          \"type\":\"tokenized\",\n          \"state\":\"created\",\n          \"bin_number\":\"550209\",\n          \"vendor\":\"MASTERCARD\",\n          \"card_type\":\"CREDIT\",\n          \"issuer\":\"NU PAGAMENTOS SA\",\n          \"level\":\"GOLD\",\n          \"country_code\":\"BRA\",\n          \"holder_name\":\"Giovanni\",\n          \"expiration_date\":\"08/2027\",\n          \"last_4_digits\":\"3362\"\n        } */\n      } else {\n        const possibleErrors = [{\n          category: \"client_validation_error\",\n          description: \"Invalid PAN\",\n          more_info: \"Card number did not pass luhn validation\"\n        }, {\n          category: \"client_validation_error\",\n          description: \"Invalid expiration date\",\n          more_info: \"expiration date have passed\"\n        }, {\n          category: \"client_validation_error\",\n          description: \"Missing required parameters\",\n          more_info: \"holder_name field is mandatory\"\n        }];\n      }\n    });\n  }\n\n  function scriptLoaded() {\n    const payUEnv = 'test';\n    const businessUnitPublicKey = '88985036-6530-4b5a-a7ec-c4e07ec07f6c';\n    POS = window.POS;\n\n    if (!POS) {\n      return console.log('POS not defined');\n    }\n\n    POS.setPublicKey(businessUnitPublicKey);\n    POS.setEnvironment(payUEnv);\n    POS.initSecureFields('card-secure-fields');\n  }\n\n  useEffect(() => {\n    const script = document.createElement(\"script\");\n    script.src = \"https://js.paymentsos.com/v2/latest/secure-fields.min.js\";\n    script.async = true;\n\n    script.onload = () => scriptLoaded();\n\n    document.body.appendChild(script);\n  });\n  return __jsx(Layout, _extends({\n    color: \"white\",\n    errorCode: errorCode\n  }, layoutProps), __jsx(Head, null, __jsx(\"title\", null, \"Payments Sample < \", CONFIG.appName)), \"Payments\", __jsx(\"form\", {\n    id: \"payment-form\",\n    method: \"post\",\n    onSubmit: onSubmit\n  }, __jsx(\"input\", {\n    type: \"text\",\n    id: \"custom\",\n    placeholder: \"Custom Additional Data\"\n  }), __jsx(\"input\", {\n    id: \"cardholder-name\",\n    placeholder: \"John Doe\",\n    required: true,\n    type: \"text\"\n  }), __jsx(\"div\", {\n    id: \"card-secure-fields\"\n  }, __jsx(\"p\", null, \"The payment form will be displayed here\")), __jsx(\"button\", {\n    type: \"submit\"\n  }, \"Pay\")));\n};\n\nPage.getInitialProps = _ => {\n  if (IS_PRODUCTION) {\n    const errorCode = 404;\n    return {\n      errorCode\n    };\n  }\n};\n\nexport default Page;","map":{"version":3,"sources":["/Users/rafael/Projects/somosgad/dale/pages/samples/payments/ssf.js"],"names":["Head","Layout","CONFIG","useEffect","IS_PRODUCTION","Page","errorCode","layoutProps","POS","onSubmit","event","preventDefault","additionalData","holder_name","document","getElementById","value","custom_data","createToken","result","json","JSON","parse","token","possibleErrors","category","description","more_info","scriptLoaded","payUEnv","businessUnitPublicKey","window","console","log","setPublicKey","setEnvironment","initSecureFields","script","createElement","src","async","onload","body","appendChild","appName","getInitialProps","_"],"mappings":"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","sourcesContent":["\nimport Head from 'next/head'\nimport Layout from '../../../components/layout/Layout'\nimport { CONFIG } from '../../../config'\nimport { useEffect } from 'react'\nimport { IS_PRODUCTION } from '../../../constants/constants'\n\nconst Page = ({ errorCode, layoutProps }) => {\n  let POS\n  function onSubmit(event) {\n    event.preventDefault()\n    const additionalData = {\n      holder_name: document.getElementById('cardholder-name').value,\n      custom_data: document.getElementById('custom').value,\n    }\n    POS.createToken(additionalData, function(result) {\n      const json = JSON.parse(result)\n      if (json.token) {\n        // sample response:\n        /* {\n          \"token\":\"3c82255a-7986-405b-9721-11be1d3ab6ed\",\n          \"created\":\"1575914964507\",\n          \"pass_luhn_validation\":true,\n          \"encrypted_cvv\":\"NjI0MzdmN2UtOGUwYS00MWVmLWFkZTItOGYyMDRhNjQ4YWRiY3Z2X2RlbGltaXRlcnZhdWx0OnYxOnIzd1g0aGowbXZ5NS9nQ2lPb2ZlR29tR2FDcnZHYVJEalUrTzJreTVxQ2VaSVNLSVpxNnRCSlNJQi9mVmV6am5zdzI1a3lLbFpwR2hSQjRLRExOZzVqWFBZYWtmdC9iVTE5MVZvU01y\",\n          \"token_type\":\"credit_card\",\n          \"type\":\"tokenized\",\n          \"state\":\"created\",\n          \"bin_number\":\"550209\",\n          \"vendor\":\"MASTERCARD\",\n          \"card_type\":\"CREDIT\",\n          \"issuer\":\"NU PAGAMENTOS SA\",\n          \"level\":\"GOLD\",\n          \"country_code\":\"BRA\",\n          \"holder_name\":\"Giovanni\",\n          \"expiration_date\":\"08/2027\",\n          \"last_4_digits\":\"3362\"\n        } */\n      } else {\n        const possibleErrors = [\n          {\n            category: \"client_validation_error\",\n            description: \"Invalid PAN\",\n            more_info: \"Card number did not pass luhn validation\"\n          },\n          {\n            category: \"client_validation_error\",\n            description: \"Invalid expiration date\",\n            more_info: \"expiration date have passed\"\n          },\n          {\n            category: \"client_validation_error\",\n            description: \"Missing required parameters\",\n            more_info: \"holder_name field is mandatory\"\n          },\n        ]\n      }\n    })\n  }\n  function scriptLoaded() {\n    const payUEnv = 'test'\n    const businessUnitPublicKey = '88985036-6530-4b5a-a7ec-c4e07ec07f6c'\n    POS = window.POS\n    if ( ! POS) {\n      return console.log('POS not defined')\n    }\n    POS.setPublicKey(businessUnitPublicKey)\n    POS.setEnvironment(payUEnv)\n    POS.initSecureFields('card-secure-fields')\n  }\n  useEffect(() => {\n    const script = document.createElement(\"script\")\n    script.src = \"https://js.paymentsos.com/v2/latest/secure-fields.min.js\"\n    script.async = true\n    script.onload = () => scriptLoaded()\n    document.body.appendChild(script)\n  })\n  return (\n    <Layout color=\"white\" errorCode={errorCode} {...layoutProps}>\n      <Head>\n        <title>Payments Sample &lt; {CONFIG.appName}</title>\n      </Head>\n        Payments\n        <form id=\"payment-form\" method=\"post\" onSubmit={onSubmit}>\n\n          {/* custom additional data */}\n          <input type=\"text\" id=\"custom\" placeholder=\"Custom Additional Data\" />\n\n          {/* mandatory data */}\n          <input id=\"cardholder-name\" placeholder=\"John Doe\" required type=\"text\" />\n\n          <div id=\"card-secure-fields\">\n            <p>The payment form will be displayed here</p>\n          </div>\n          <button type=\"submit\">Pay</button>\n        </form>\n    </Layout>\n  )\n}\n\nPage.getInitialProps = _ => {\n  if (IS_PRODUCTION) {\n    const errorCode = 404\n    return { errorCode }\n  }\n}\n\nexport default Page\n"]},"metadata":{},"sourceType":"module"}