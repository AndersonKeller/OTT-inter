{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/esm/asyncToGenerator\"));\n\nvar _router = _interopRequireDefault(require(\"next/router\"));\n\nvar _react = require(\"react\");\n\nvar _UserContext = _interopRequireDefault(require(\"../../../contexts/UserContext\"));\n\nvar _constants = require(\"../../../constants/constants\");\n\nvar _auth = require(\"../../../services/auth\");\n\nvar _api = _interopRequireDefault(require(\"../../../services/api\"));\n\nvar _AuthModalContext = require(\"../../../contexts/AuthModalContext\");\n\nvar _FormGroup = _interopRequireDefault(require(\"./FormGroup\"));\n\nvar _Input = _interopRequireDefault(require(\"./Input\"));\n\nvar _button = _interopRequireDefault(require(\"../../button\"));\n\nvar _SocialButtons = _interopRequireDefault(require(\"./SocialButtons\"));\n\nvar _OrEnterWith = _interopRequireDefault(require(\"./OrEnterWith\"));\n\nvar _config = require(\"~/config\");\n\nvar _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nvar RegisterTab = function RegisterTab(_ref) {\n  _s();\n\n  var changeTab = _ref.changeTab,\n      setLoading = _ref.setLoading,\n      socialLogin = _ref.socialLogin;\n\n  var _useState = (0, _react.useState)(''),\n      name = _useState[0],\n      setName = _useState[1];\n\n  var _useState2 = (0, _react.useState)(''),\n      email = _useState2[0],\n      setEmail = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(''),\n      password = _useState3[0],\n      setPassword = _useState3[1];\n\n  var _useState4 = (0, _react.useState)(''),\n      error = _useState4[0],\n      setError = _useState4[1];\n\n  var _useContext = (0, _react.useContext)(_UserContext[\"default\"]),\n      signIn = _useContext.signIn;\n\n  var _useContext2 = (0, _react.useContext)(_AuthModalContext.AuthModalContext),\n      closeAuthModal = _useContext2.closeAuthModal,\n      packageId = _useContext2.packageId;\n\n  var handleSubmit = /*#__PURE__*/function () {\n    var _ref2 = (0, _asyncToGenerator2[\"default\"])( /*#__PURE__*/_regenerator[\"default\"].mark(function _callee(e) {\n      var tokenResponse, access_token, userResponse;\n      return _regenerator[\"default\"].wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              e.preventDefault();\n              setLoading(true);\n              document.activeElement.blur();\n              _context.prev = 3;\n              _context.next = 6;\n              return (0, _api[\"default\"])().post('register', {\n                client_id: _constants.CLIENT_ID,\n                client_secret: _constants.CLIENT_SECRET,\n                email: email,\n                name: name,\n                package_id_intention: packageId,\n                password: password\n              });\n\n            case 6:\n              tokenResponse = _context.sent;\n              access_token = tokenResponse.data.access_token;\n              (0, _auth.setAccessToken)(access_token);\n              _context.next = 11;\n              return (0, _api[\"default\"])().get('user');\n\n            case 11:\n              userResponse = _context.sent;\n              signIn(userResponse.data, tokenResponse.data);\n              closeAuthModal();\n\n              _router[\"default\"].push('/register/wizard/user-data');\n\n              _context.next = 20;\n              break;\n\n            case 17:\n              _context.prev = 17;\n              _context.t0 = _context[\"catch\"](3);\n\n              if (_context.t0.response) {\n                setError(_context.t0.response.data);\n              } else {\n                setError('An error has occurred!');\n                console.log('error', _context.t0);\n              }\n\n            case 20:\n              setLoading(false);\n\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[3, 17]]);\n    }));\n\n    return function handleSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  function goToLogin(e) {\n    e.preventDefault();\n    changeTab('login');\n  }\n\n  var alreadyRegistered = _config.CONFIG.lang === 'es-CL' ? '¿Ya estás suscrito?' : '¿Ya eres suscriptor?';\n  var login = _config.CONFIG.lang === 'es-CL' ? 'Inicia sesión' : 'Ház login';\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"intro-text\"\n  }, __jsx(\"p\", null, \"\\xA1Bienvenidos!\")), __jsx(\"form\", {\n    method: \"post\",\n    onSubmit: handleSubmit\n  }, error && __jsx(\"div\", {\n    className: \"invalid-feedback\"\n  }, error.message), __jsx(_FormGroup[\"default\"], null, __jsx(_Input[\"default\"], {\n    id: \"name\",\n    onChange: function onChange(e) {\n      return setName(e.target.value);\n    },\n    placeholder: \"Nombre\",\n    required: true,\n    value: name\n  }), error && error.errors && __jsx(\"div\", {\n    className: \"invalid-feedback\"\n  }, error.errors.name)), __jsx(_FormGroup[\"default\"], null, __jsx(_Input[\"default\"], {\n    id: \"reg_email\",\n    onChange: function onChange(e) {\n      return setEmail(e.target.value);\n    },\n    placeholder: \"E-mail\",\n    required: true,\n    type: \"email\",\n    value: email\n  }), error && error.errors && __jsx(\"div\", {\n    className: \"invalid-feedback\"\n  }, error.errors.email)), __jsx(_FormGroup[\"default\"], null, __jsx(_Input[\"default\"], {\n    id: \"reg_password\",\n    onChange: function onChange(e) {\n      return setPassword(e.target.value);\n    },\n    placeholder: \"Clave\",\n    required: true,\n    type: \"password\",\n    value: password\n  }), error && error.errors && __jsx(\"div\", {\n    className: \"invalid-feedback\"\n  }, error.errors.password)), __jsx(_button[\"default\"], {\n    block: true,\n    className: \"enter-btn\",\n    size: \"sm\",\n    type: \"submit\"\n  }, \"Registrar\"), __jsx(\"div\", {\n    className: \"already-subscriptor\"\n  }, __jsx(\"span\", null, alreadyRegistered), ' ', __jsx(\"a\", {\n    className: \"bold text-uppercase\",\n    href: \"/login\",\n    onClick: goToLogin\n  }, login)), __jsx(_OrEnterWith[\"default\"], null), __jsx(_SocialButtons[\"default\"], {\n    socialLogin: socialLogin\n  })));\n};\n\n_s(RegisterTab, \"7LCaxpIoSPXbF3BeTHGflKk4aHU=\");\n\n_c = RegisterTab;\nvar _default = RegisterTab;\nexports[\"default\"] = _default;\n\nvar _c;\n\n$RefreshReg$(_c, \"RegisterTab\");","map":{"version":3,"sources":["/Users/rafael/Projects/somosgad/dale/components/layout/AuthModal/RegisterTab.js"],"names":["RegisterTab","changeTab","setLoading","socialLogin","name","setName","email","setEmail","password","setPassword","error","setError","UserContext","signIn","AuthModalContext","closeAuthModal","packageId","handleSubmit","e","preventDefault","document","activeElement","blur","post","client_id","CLIENT_ID","client_secret","CLIENT_SECRET","package_id_intention","tokenResponse","access_token","data","get","userResponse","Router","push","response","console","log","goToLogin","alreadyRegistered","CONFIG","lang","login","message","target","value","errors"],"mappings":"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","sourcesContent":["import Router from 'next/router'\nimport {useState, useContext} from 'react'\nimport UserContext from '../../../contexts/UserContext'\nimport { CLIENT_ID, CLIENT_SECRET } from '../../../constants/constants'\nimport { setAccessToken } from '../../../services/auth'\nimport api from '../../../services/api'\nimport { AuthModalContext } from '../../../contexts/AuthModalContext'\nimport FormGroup from './FormGroup'\nimport Input from './Input'\nimport Button from '../../button'\nimport SocialButtons from './SocialButtons'\nimport OrEnterWith from './OrEnterWith'\nimport { CONFIG } from '~/config'\n\nconst RegisterTab = ({ changeTab, setLoading, socialLogin })  => {\n  const [name,setName] = useState('')\n  const [email,setEmail] = useState('')\n  const [password,setPassword] = useState('')\n  const [error, setError] = useState('')\n  const { signIn } = useContext(UserContext)\n  const { closeAuthModal, packageId } = useContext(AuthModalContext)\n\n  const handleSubmit = async e => {\n    e.preventDefault()\n    setLoading(true)\n    document.activeElement.blur()\n    try {\n      const tokenResponse = await api().post('register', {\n        client_id: CLIENT_ID,\n        client_secret: CLIENT_SECRET,\n        email,\n        name,\n        package_id_intention: packageId,\n        password,\n      })\n      const { access_token, } = tokenResponse.data\n      setAccessToken(access_token)\n      const userResponse = await api().get('user')\n      signIn(userResponse.data, tokenResponse.data)\n      closeAuthModal()\n      Router.push('/register/wizard/user-data')\n    } catch (error) {\n      if (error.response) {\n        setError(error.response.data)\n      } else {\n        setError('An error has occurred!')\n        console.log('error', error)\n      }\n    }\n    setLoading(false)\n  }\n\n  function goToLogin(e) {\n    e.preventDefault()\n    changeTab('login')\n  }\n\n  const alreadyRegistered = CONFIG.lang === 'es-CL' ? '¿Ya estás suscrito?' : '¿Ya eres suscriptor?'\n\n  const login = CONFIG.lang === 'es-CL' ? 'Inicia sesión' : 'Ház login'\n\n  return (\n    <>\n      <div className=\"intro-text\">\n        <p>¡Bienvenidos!</p>\n      </div>\n      <form method=\"post\" onSubmit={handleSubmit}>\n\n        {error && <div className=\"invalid-feedback\">{error.message}</div>}\n\n        <FormGroup>\n          <Input\n            id=\"name\"\n            onChange={e => setName(e.target.value)}\n            placeholder=\"Nombre\"\n            required\n            value={name}\n          />\n          {error && error.errors && (<div className=\"invalid-feedback\">{error.errors.name}</div>)}\n        </FormGroup>\n\n        <FormGroup>\n          <Input\n            id=\"reg_email\"\n            onChange={e => setEmail(e.target.value)}\n            placeholder=\"E-mail\"\n            required\n            type=\"email\"\n            value={email}\n          />\n          {error && error.errors && (<div className=\"invalid-feedback\">{error.errors.email}</div>)}\n        </FormGroup>\n\n        <FormGroup>\n          <Input\n            id=\"reg_password\"\n            onChange={e => setPassword(e.target.value)}\n            placeholder=\"Clave\"\n            required\n            type=\"password\"\n            value={password}\n          />\n          {error && error.errors &&  (\n            <div className=\"invalid-feedback\">{error.errors.password}</div>\n          )}\n        </FormGroup>\n\n        {/* <FormGroup>\n          <Label hmtlFor=\"password_confirmation\">Confirmación de Clave</Label>\n          <Input id=\"password_confirmation\" type=\"password\" />\n        </FormGroup> */}\n\n        <Button block className=\"enter-btn\" size=\"sm\" type=\"submit\">Registrar</Button>\n\n        <div className=\"already-subscriptor\">\n          <span>{alreadyRegistered}</span>\n          {' '}\n          <a className=\"bold text-uppercase\" href=\"/login\" onClick={goToLogin}>{login}</a>\n        </div>\n\n        <OrEnterWith />\n\n        <SocialButtons socialLogin={socialLogin} />\n\n      </form>\n    </>\n  )\n}\n\nexport default RegisterTab\n"]},"metadata":{},"sourceType":"script"}