{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useContext, useEffect, useState } from \"react\";\nimport FormGroup from \"~/components/layout/AuthModal/FormGroup\";\nimport Label from \"~/components/Form/Label\";\nimport Input from \"~/components/layout/AuthModal/Input\";\nimport withAuth from \"~/components/withAuth\";\nimport InvalidFeedback from \"~/components/Form/InvalidFeedback\";\nimport { HAS_WINDOW } from \"~/constants/constants\";\nimport useScript from \"@charlietango/use-script\";\nimport Select from \"~/components/Select/Select\";\nimport Button from \"~/components/button\";\nimport MaskedInput from 'react-text-mask';\nimport UserContext from \"~/contexts/UserContext\";\nimport Router from \"next/router\";\n\nconst Payment = ({\n  layoutProps,\n  userData,\n  package_id,\n  packages,\n  api,\n  requireds\n}) => {\n  const [ready, status] = useScript('https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js');\n  let selectedPackage = null;\n\n  if (packages && package_id) {\n    selectedPackage = packages.items.find(i => i.id == package_id);\n    console.log(selectedPackage);\n  }\n\n  const {\n    user\n  } = useContext(UserContext);\n  const {\n    0: error,\n    1: setError\n  } = useState({\n    errors: {}\n  });\n  const {\n    0: values,\n    1: setValues\n  } = useState({\n    package_id: '',\n    paymentMethodId: null,\n    payment_os: null,\n    cash_paymentMethodId: null,\n    terms: null,\n    discount_id: null,\n    cardNumber: null,\n    cardHolderName: null,\n    cardExpirationDate: null,\n    cardSecurityCode: null,\n    paymentMethodCode: null,\n    docType: \"CPF\",\n    docNumber: null\n  });\n  const {\n    0: cardImg,\n    1: setCardImg\n  } = useState(null);\n  const {\n    0: creditCard,\n    1: setCreditCard\n  } = useState(null);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState();\n  const businessUnitPublicKey = 'TEST-7205c1be-9805-4308-bf00-6557c5b56b88';\n  const {\n    0: isMercadoPagoReady,\n    1: setIsMercadoPagoReady\n  } = useState(false);\n  const MercadoPago = ready && HAS_WINDOW ? window.Mercadopago : null;\n  const credit_card_id = 1;\n  const debit_card_id = 2;\n  const isCardPayment = [credit_card_id, debit_card_id].includes(values.paymentMethodId);\n  const {\n    0: payMethods,\n    1: setPayMethods\n  } = useState([]);\n  useEffect(_ => {\n    if (MercadoPago) {\n      MercadoPago.setPublishableKey(businessUnitPublicKey);\n      setIsMercadoPagoReady(true);\n      setPayMethods(MercadoPago.getPaymentMethods());\n    }\n  }, [MercadoPago]);\n  /* handle payment method change */\n\n  function onPaymentChange(e) {\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      paymentMethodId: parseInt(e.target.value, 10),\n      cash_paymentMethodId: null\n    }));\n  }\n\n  function onCashPaymentMethodChange(e) {\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      cash_paymentMethodId: parseInt(e.target.value, 10)\n    }));\n  }\n\n  const handleInputChange = e => {\n    const {\n      checked,\n      name,\n      value,\n      type\n    } = e.target;\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      [name]: type === 'checkbox' ? checked ? value === 'true' ? true : value : false : value\n    }));\n  };\n\n  const handleInputChangeCreditCardNumber = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      [name]: value\n    }));\n    let cardnumber = value;\n\n    if (cardnumber.length >= 6) {\n      let bin = cardnumber.substring(0, 6);\n      MercadoPago.getPaymentMethod({\n        \"bin\": bin\n      }, (status, details) => {\n        if (details.length > 0) {\n          setCardImg(details[0].secure_thumbnail);\n          setCreditCard(details[0]);\n          setValues(_objectSpread(_objectSpread({}, values), {}, {\n            ['paymentMethodCode']: details[0].id,\n            ['cardNumber']: cardnumber\n          }));\n        }\n      });\n    }\n  }; // payment methods\n\n\n  const {\n    0: paymentMethods,\n    1: setPaymentMethods\n  } = useState(); // get payment methods\n\n  useEffect(_ => {\n    const getPaymentMethods = async _ => {\n      const {\n        data\n      } = await api.get('payment-methods');\n      setPaymentMethods(data);\n    };\n\n    getPaymentMethods();\n  }, []); // cash payment methods\n\n  const {\n    0: cashPaymentMethods,\n    1: setCashPaymentMethods\n  } = useState(); // get cash payment methods\n\n  useEffect(_ => {\n    const getCashPaymentMethods = async _ => {\n      const {\n        data\n      } = await api.get('cash-payment-methods');\n      setCashPaymentMethods(data);\n    };\n\n    getCashPaymentMethods();\n  }, []);\n\n  let payMethodsHtml = () => {\n    {\n      payMethods && payMethods.map((m, key) => {\n        return __jsx(\"div\", {\n          className: \"col-6 col-md\"\n        }, m.id);\n      });\n    }\n  };\n\n  const submitCredit = async e => {\n    e.preventDefault();\n    setLoading(true);\n    let expirationMonth = values.cardExpirationDate.split('/')[0];\n    let expirationYear = values.cardExpirationDate.split('/')[1];\n    MercadoPago.createToken({\n      cardNumber: values.cardNumber,\n      cardholderName: values.cardHolderName,\n      cardExpirationMonth: expirationMonth,\n      cardExpirationYear: expirationYear,\n      securityCode: values.cardSecurityCode,\n      docType: values.docType,\n      docNumber: values.docNumber,\n      email: user.email\n    }, async (statusCode, response) => {\n      let token = \"\";\n\n      if (response && response.cause && response.cause.length > 0) {\n        let errors = [];\n\n        for (let error of response.cause) {\n          if (error.code === \"E301\") {\n            errors[\"cardNumber\"] = \"Há algo de errado com esse número. Digite novamente.\";\n          }\n\n          if (error.code === \"E302\") {\n            errors[\"cardSecurityCode\"] = \"Confira o código de segurança.\";\n          }\n\n          if (error.code === \"316\") {\n            error[\"cardHolderName\"] = \"Por favor, digite um nome válido.\";\n          }\n\n          if (error.code === \"324\") {\n            errors[\"docType\"] = \"Confira seu documento.\";\n          }\n\n          if (error.code === \"325\" || error.code === \"326\") {\n            errors[\"cardExpirationDate\"] = \"Confira a data.\";\n          }\n        }\n\n        setError({\n          errors: errors\n        });\n      }\n\n      try {\n        token = response.id;\n        const res = await api.post(`register/subscribe`, {\n          package_id: package_id,\n          payment_method_id: values.paymentMethodId,\n          payment_method_code: values.paymentMethodCode,\n          token: token\n        });\n        Router.push({\n          pathname: '/register/confirm',\n          query: {\n            download_link: order.download_link,\n            link: order.link\n          }\n        }, '/register/confirm'); // handleSubmit(1)\n      } catch (error) {\n        if (error.response) {\n          const {\n            data,\n            status\n          } = error.response;\n\n          if (status === 422) {\n            setError(data);\n          }\n        } else if (error.request) {\n          setError(error);\n        } else {\n          setError(error);\n        }\n      } finally {\n        setLoading(false);\n      }\n\n      setLoading(false);\n    }); // const data = { ...values, payment_os: paymentData }\n    //\n  };\n\n  return __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"offset-md-2 col-md-8\"\n  }, __jsx(\"h3\", {\n    className: \"h3\"\n  }, \"Pago\"), __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-6 paymentMethod\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"row w-100\"\n  }, __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"paymentMethodId\",\n    style: \"margin: 0;\"\n  }, \"Pague com\"), __jsx(Select, {\n    id: \"paymentMethodId\",\n    name: \"paymentMethodId\",\n    required: requireds,\n    onChange: onPaymentChange,\n    value: values.paymentMethodId\n  }, __jsx(\"option\", {\n    value: \"0\"\n  }, \"Selecione\"), paymentMethods && paymentMethods.map((paymentMethod, key) => __jsx(\"option\", {\n    key: paymentMethod.id,\n    state: values.paymentMethodId,\n    value: paymentMethod.id\n  }, paymentMethod.name))), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"paymentMethodId\"\n  })))), values.paymentMethodId == 1 && __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"cardHolderName\"\n  }, \"Nombre impreso en tarjeta\"), __jsx(Input, {\n    id: \"cardHolderName\",\n    name: \"cardHolderName\",\n    required: requireds,\n    type: \"text\",\n    onChange: handleInputChange\n  }))), __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"cardNumber\"\n  }, \"Nro Cart\\xE3o\"), __jsx(\"img\", {\n    src: cardImg,\n    className: \"creditCardBrand\"\n  }), __jsx(MaskedInput, {\n    mask: [/\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/],\n    guide: false,\n    class: \"form-control\",\n    onChange: handleInputChangeCreditCardNumber,\n    id: \"cardNumber\",\n    name: \"cardNumber\"\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"cardNumber\"\n  }))), __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"docNumber\"\n  }, \"Documento\"), __jsx(Input, {\n    class: \"form-control\",\n    onChange: handleInputChange,\n    id: \"docNumber\",\n    name: \"docNumber\",\n    maxLength: 20\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"docNumber\"\n  }))), __jsx(\"div\", {\n    className: \"col-6\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"card-duedate\"\n  }, \"Dt Vencimento\"), __jsx(MaskedInput, {\n    mask: [/\\d/, /\\d/, '/', /\\d/, /\\d/],\n    guide: false,\n    class: \"form-control\",\n    placeholder: \"MM/AA\",\n    name: \"cardExpirationDate\",\n    onChange: handleInputChange\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"cardExpirationDate\"\n  }))), __jsx(\"div\", {\n    className: \"col-6\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"card-cvv\"\n  }, \"CVV\"), __jsx(MaskedInput, {\n    mask: [/\\d/, /\\d/, /\\d/],\n    guide: false,\n    class: \"form-control\",\n    name: \"cardSecurityCode\",\n    onChange: handleInputChange,\n    placeholder: \"***\"\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"cardSecurityCode\"\n  }))), __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(Button, {\n    block: true,\n    color: \"secondary\",\n    type: \"button\",\n    disabled: loading,\n    loading: loading,\n    onClick: submitCredit\n  }, \"Pagar\"))), values.paymentMethodId == 3 && __jsx(\"div\", {\n    class: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(Button, {\n    block: true,\n    color: \"secondary\",\n    type: \"button\",\n    disabled: loading,\n    loading: loading,\n    onClick: submitCredit\n  }, \"Gerar Boleto\"))))), __jsx(\"div\", {\n    className: \"col-md-6\"\n  }, __jsx(\"div\", {\n    class: \"product-summary\"\n  }, __jsx(\"div\", {\n    className: \"product-image\"\n  }, __jsx(\"img\", {\n    src: \"https://place-hold.it/280x125\",\n    alt: \"\"\n  })), __jsx(\"div\", {\n    className: \"product-name-group\"\n  }, __jsx(\"h6\", null, \"Voc\\xEA est\\xE1 comprando:\"), __jsx(\"p\", {\n    class: \"product-name\"\n  }, \"Assinatura LaU Play - \", __jsx(\"strong\", null, selectedPackage.name), \" recorrente\")), __jsx(\"div\", {\n    class: \"price-breakdown\"\n  }, __jsx(\"div\", {\n    className: \"checkout-total\"\n  }, __jsx(\"h6\", null, \"Total\"), __jsx(\"p\", {\n    class: \"price\"\n  }, \"$ \", selectedPackage.amount)))), __jsx(\"div\", {\n    class: \"row pay-methods\"\n  }, payMethods && payMethods.map((m, key) => {\n    return __jsx(\"div\", {\n      class: \"col-3 text-center\"\n    }, __jsx(\"img\", {\n      src: m.thumbnail,\n      alt: \"\"\n    }));\n  }))))));\n};\n\nexport default withAuth(Payment, true);","map":{"version":3,"sources":["/Users/rafael/Projects/somosgad/dale/pages/register/wizard/payment.js"],"names":["useContext","useEffect","useState","FormGroup","Label","Input","withAuth","InvalidFeedback","HAS_WINDOW","useScript","Select","Button","MaskedInput","UserContext","Router","Payment","layoutProps","userData","package_id","packages","api","requireds","ready","status","selectedPackage","items","find","i","id","console","log","user","error","setError","errors","values","setValues","paymentMethodId","payment_os","cash_paymentMethodId","terms","discount_id","cardNumber","cardHolderName","cardExpirationDate","cardSecurityCode","paymentMethodCode","docType","docNumber","cardImg","setCardImg","creditCard","setCreditCard","loading","setLoading","businessUnitPublicKey","isMercadoPagoReady","setIsMercadoPagoReady","MercadoPago","window","Mercadopago","credit_card_id","debit_card_id","isCardPayment","includes","payMethods","setPayMethods","_","setPublishableKey","getPaymentMethods","onPaymentChange","e","parseInt","target","value","onCashPaymentMethodChange","handleInputChange","checked","name","type","handleInputChangeCreditCardNumber","cardnumber","length","bin","substring","getPaymentMethod","details","secure_thumbnail","paymentMethods","setPaymentMethods","data","get","cashPaymentMethods","setCashPaymentMethods","getCashPaymentMethods","payMethodsHtml","map","m","key","submitCredit","preventDefault","expirationMonth","split","expirationYear","createToken","cardholderName","cardExpirationMonth","cardExpirationYear","securityCode","email","statusCode","response","token","cause","code","res","post","payment_method_id","payment_method_code","push","pathname","query","download_link","order","link","request","paymentMethod","amount","thumbnail"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useState } from \"react\";\nimport FormGroup from \"~/components/layout/AuthModal/FormGroup\";\nimport Label from \"~/components/Form/Label\";\nimport Input from \"~/components/layout/AuthModal/Input\";\nimport withAuth from \"~/components/withAuth\";\nimport InvalidFeedback from \"~/components/Form/InvalidFeedback\"\nimport { HAS_WINDOW } from \"~/constants/constants\";\nimport useScript from \"@charlietango/use-script\";\nimport Select from \"~/components/Select/Select\";\nimport Button from \"~/components/button\";\nimport MaskedInput from 'react-text-mask'\nimport UserContext from \"~/contexts/UserContext\";\nimport Router from \"next/router\";\n\nconst Payment = ({\n                   layoutProps,\n                   userData,\n                   package_id,\n                   packages,\n                   api,\n                   requireds\n                 }) => {\n\n  const [ready, status] = useScript('https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js')\n\n\n  let selectedPackage = null\n  if (packages && package_id) {\n    selectedPackage = packages.items.find(i => i.id == package_id)\n    console.log(selectedPackage)\n  }\n\n  const { user } = useContext(UserContext)\n  const [error, setError] = useState({\n    errors: {}\n  })\n\n  const [values, setValues] = useState({\n    package_id: '',\n    paymentMethodId: null,\n    payment_os: null,\n    cash_paymentMethodId: null,\n    terms: null,\n    discount_id: null,\n    cardNumber: null,\n    cardHolderName: null,\n    cardExpirationDate: null,\n    cardSecurityCode: null,\n    paymentMethodCode: null,\n    docType: \"CPF\",\n    docNumber: null,\n  })\n\n  const [cardImg, setCardImg] = useState(null);\n  const [creditCard, setCreditCard] = useState(null);\n\n  const [loading, setLoading] = useState();\n\n  const businessUnitPublicKey = 'TEST-7205c1be-9805-4308-bf00-6557c5b56b88'\n  const [isMercadoPagoReady, setIsMercadoPagoReady] = useState(false)\n  const MercadoPago = ready && HAS_WINDOW ? window.Mercadopago : null\n\n  const credit_card_id = 1\n  const debit_card_id = 2\n  const isCardPayment = [credit_card_id, debit_card_id].includes(values.paymentMethodId)\n\n\n  const [payMethods, setPayMethods] = useState([]);\n\n  useEffect(_ => {\n    if (MercadoPago) {\n      MercadoPago.setPublishableKey(businessUnitPublicKey)\n      setIsMercadoPagoReady(true)\n      setPayMethods(MercadoPago.getPaymentMethods());\n    }\n  }, [MercadoPago])\n\n\n  /* handle payment method change */\n  function onPaymentChange(e) {\n    setValues({\n      ...values,\n      paymentMethodId: parseInt(e.target.value, 10),\n      cash_paymentMethodId: null,\n    })\n  }\n\n  function onCashPaymentMethodChange(e) {\n    setValues({\n      ...values,\n      cash_paymentMethodId: parseInt(e.target.value, 10),\n    })\n  }\n\n  const handleInputChange = e => {\n    const { checked, name, value, type } = e.target\n    setValues({\n      ...values,\n      [name]: type === 'checkbox' ?\n        (checked ? (value === 'true' ? true : value) : false) :\n        value,\n    })\n  }\n\n  const handleInputChangeCreditCardNumber = e => {\n\n    const { name, value } = e.target\n\n\n    setValues({\n      ...values,\n      [name]: value,\n    })\n\n    let cardnumber = value;\n\n    if (cardnumber.length >= 6) {\n      let bin = cardnumber.substring(0, 6);\n\n      MercadoPago.getPaymentMethod({\n        \"bin\": bin\n      }, (status, details) => {\n        if (details.length > 0) {\n          setCardImg(details[0].secure_thumbnail);\n          setCreditCard(details[0]);\n          setValues({\n            ...values,\n            ['paymentMethodCode']: details[0].id,\n            ['cardNumber']: cardnumber\n          })\n\n        }\n      });\n\n    }\n  }\n\n  // payment methods\n  const [paymentMethods, setPaymentMethods] = useState()\n\n  // get payment methods\n  useEffect(_ => {\n    const getPaymentMethods = async _ => {\n      const { data } = await api.get('payment-methods')\n      setPaymentMethods(data)\n    }\n    getPaymentMethods()\n  }, [])\n\n  // cash payment methods\n  const [cashPaymentMethods, setCashPaymentMethods] = useState()\n\n  // get cash payment methods\n  useEffect(_ => {\n    const getCashPaymentMethods = async _ => {\n      const { data } = await api.get('cash-payment-methods')\n      setCashPaymentMethods(data)\n    }\n    getCashPaymentMethods()\n  }, [])\n\n  let payMethodsHtml = () => {\n    {\n      payMethods && payMethods.map((m, key) => {\n        return <div className=\"col-6 col-md\">\n          { m.id }\n        </div>\n      })\n    }\n  }\n\n\n  const submitCredit = async e => {\n\n    e.preventDefault();\n\n    setLoading(true);\n\n    let expirationMonth = values.cardExpirationDate.split('/')[0];\n    let expirationYear = values.cardExpirationDate.split('/')[1];\n\n    MercadoPago.createToken({\n      cardNumber: values.cardNumber,\n      cardholderName: values.cardHolderName,\n      cardExpirationMonth: expirationMonth,\n      cardExpirationYear: expirationYear,\n      securityCode: values.cardSecurityCode,\n      docType: values.docType,\n      docNumber: values.docNumber,\n      email: user.email\n    }, async (statusCode, response) => {\n\n      let token = \"\";\n\n      if (response && response.cause && response.cause.length > 0) {\n        let errors = [];\n        for (let error of response.cause) {\n          if (error.code === \"E301\") {\n            errors[\"cardNumber\"] = \"Há algo de errado com esse número. Digite novamente.\"\n          }\n          if (error.code === \"E302\") {\n            errors[\"cardSecurityCode\"] = \"Confira o código de segurança.\"\n          }\n          if (error.code === \"316\") {\n            error[\"cardHolderName\"] = \"Por favor, digite um nome válido.\"\n          }\n          if (error.code === \"324\") {\n            errors[\"docType\"] = \"Confira seu documento.\";\n          }\n          if (error.code === \"325\" || error.code === \"326\") {\n            errors[\"cardExpirationDate\"] = \"Confira a data.\";\n          }\n        }\n        setError({\n          errors: errors\n        });\n      }\n\n\n      try {\n\n        token = response.id;\n\n        const res = await api.post(`register/subscribe`, {\n          package_id: package_id,\n          payment_method_id: values.paymentMethodId,\n          payment_method_code: values.paymentMethodCode,\n          token: token\n        })\n\n        Router.push({\n          pathname: '/register/confirm',\n          query: {\n            download_link: order.download_link,\n            link: order.link,\n          },\n        }, '/register/confirm')\n\n        // handleSubmit(1)\n\n      } catch (error) {\n\n        if (error.response) {\n          const { data, status } = error.response\n          if (status === 422) {\n            setError(data)\n          }\n        } else if (error.request) {\n          setError(error)\n        } else {\n          setError(error)\n        }\n\n      } finally {\n        setLoading(false)\n      }\n\n\n      setLoading(false);\n\n    });\n\n\n    // const data = { ...values, payment_os: paymentData }\n    //\n\n  }\n\n  return (\n    <div className=\"row\">\n      <div className=\"offset-md-2 col-md-8\">\n\n        <h3 className=\"h3\">Pago</h3>\n\n        <div className=\"row\">\n\n          <div className=\"col-md-6 paymentMethod\">\n            <div className=\"row\">\n              <div className=\"row w-100\">\n                <div className=\"col-12\">\n                  <FormGroup>\n                    <Label htmlFor=\"paymentMethodId\" style=\"margin: 0;\">Pague com</Label>\n                    <Select\n                      id=\"paymentMethodId\"\n                      name=\"paymentMethodId\"\n                      required={ requireds }\n                      onChange={ onPaymentChange }\n                      value={ values.paymentMethodId }\n                    >\n                      <option value=\"0\">Selecione</option>\n                      { paymentMethods && paymentMethods.map((paymentMethod, key) => (\n                        <option\n                          key={ paymentMethod.id }\n                          state={ values.paymentMethodId }\n                          value={ paymentMethod.id }\n                        >\n                          { paymentMethod.name }\n                        </option>\n                      )) }\n                    </Select>\n                    <InvalidFeedback error={ error } loading={ loading } name=\"paymentMethodId\"/>\n                  </FormGroup>\n                </div>\n              </div>\n              { values.paymentMethodId == 1 && (\n                <div className=\"row\">\n                  <div className=\"col-12\">\n                    <FormGroup>\n                      <Label htmlFor=\"cardHolderName\">Nombre impreso en tarjeta</Label>\n                      <Input id=\"cardHolderName\" name=\"cardHolderName\" required={ requireds } type=\"text\"\n                             onChange={ handleInputChange }/>\n                    </FormGroup>\n                  </div>\n                  <div className=\"col-12\">\n                    <FormGroup>\n                      <Label htmlFor=\"cardNumber\">Nro Cartão</Label>\n                      <img src={ cardImg } className=\"creditCardBrand\"/>\n                      <MaskedInput\n                        mask={ [/\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/] }\n                        guide={ false }\n                        class={ \"form-control\" }\n                        onChange={ handleInputChangeCreditCardNumber }\n                        id=\"cardNumber\" name=\"cardNumber\"\n                      />\n                      <InvalidFeedback error={ error } loading={ loading } name=\"cardNumber\"/>\n                    </FormGroup>\n                  </div>\n                  <div className=\"col-12\">\n                    <FormGroup>\n                      <Label htmlFor=\"docNumber\">Documento</Label>\n                      <Input\n                        class={ \"form-control\" }\n                        onChange={ handleInputChange }\n                        id=\"docNumber\" name=\"docNumber\"\n                        maxLength={ 20 }\n                      />\n                      <InvalidFeedback error={ error } loading={ loading } name=\"docNumber\"/>\n                    </FormGroup>\n                  </div>\n                  <div className=\"col-6\">\n                    <FormGroup>\n                      <Label htmlFor=\"card-duedate\">Dt Vencimento</Label>\n                      <MaskedInput\n                        mask={ [/\\d/, /\\d/, '/', /\\d/, /\\d/,] }\n                        guide={ false }\n                        class={ \"form-control\" }\n                        placeholder={ \"MM/AA\" }\n                        name={ \"cardExpirationDate\" }\n                        onChange={ handleInputChange }\n                      />\n                      <InvalidFeedback error={ error } loading={ loading } name=\"cardExpirationDate\"/>\n                    </FormGroup>\n                  </div>\n                  <div className=\"col-6\">\n                    <FormGroup>\n                      <Label htmlFor=\"card-cvv\">CVV</Label>\n                      <MaskedInput\n                        mask={ [/\\d/, /\\d/, /\\d/] }\n                        guide={ false }\n                        class={ \"form-control\" }\n                        name={ \"cardSecurityCode\" }\n                        onChange={ handleInputChange }\n                        placeholder={ \"***\" }\n                      />\n                      <InvalidFeedback error={ error } loading={ loading } name=\"cardSecurityCode\"/>\n                    </FormGroup>\n                  </div>\n                  <div className=\"col-12\">\n                    <Button block color=\"secondary\" type=\"button\" disabled={ loading }\n                            loading={ loading } onClick={ submitCredit }>Pagar</Button>\n                  </div>\n                </div>\n              ) }\n\n              { values.paymentMethodId == 3 && (\n                <div class={ \"row\" }>\n                  <div className=\"col-12\">\n                    <Button block color=\"secondary\" type=\"button\" disabled={ loading }\n                            loading={ loading } onClick={ submitCredit }>Gerar Boleto</Button>\n                  </div>\n                </div>\n              ) }\n\n            </div>\n          </div>\n\n          <div className=\"col-md-6\">\n            <div class=\"product-summary\">\n              <div className=\"product-image\">\n                <img src=\"https://place-hold.it/280x125\" alt=\"\"/>\n              </div>\n              <div className={ \"product-name-group\" }>\n                <h6>\n                  Você está comprando:\n                </h6>\n                <p class={ \"product-name\" }>\n                  Assinatura LaU Play - <strong>{ selectedPackage.name }</strong> recorrente\n                </p>\n              </div>\n              <div class={ \"price-breakdown\" }>\n                <div className=\"checkout-total\">\n                  <h6>\n                    Total\n                  </h6>\n                  <p class={ \"price\" }>\n                    $ { selectedPackage.amount }\n                  </p>\n                </div>\n              </div>\n            </div>\n            <div class={\"row pay-methods\"}>\n              { payMethods && payMethods.map((m, key) => {\n                return <div class={\"col-3 text-center\"}>\n                  <img src={ m.thumbnail } alt=\"\"/>\n                </div>\n              }) }\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  )\n}\n\nexport default withAuth(Payment, true);\n"]},"metadata":{},"sourceType":"module"}