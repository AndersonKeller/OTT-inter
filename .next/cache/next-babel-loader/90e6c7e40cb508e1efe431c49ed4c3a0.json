{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useContext, useEffect, useState } from \"react\";\nimport FormGroup from \"~/components/layout/AuthModal/FormGroup\";\nimport Label from \"~/components/Form/Label\";\nimport Input from \"~/components/layout/AuthModal/Input\";\nimport withAuth from \"~/components/withAuth\";\nimport InvalidFeedback from \"~/components/Form/InvalidFeedback\";\nimport { HAS_WINDOW } from \"~/constants/constants\";\nimport useScript from \"@charlietango/use-script\";\nimport Select from \"~/components/Select/Select\";\nimport Button from \"~/components/button\";\nimport MaskedInput from 'react-text-mask';\nimport UserContext from \"~/contexts/UserContext\";\n\nvar Payment = function Payment(_ref) {\n  _s();\n\n  var layoutProps = _ref.layoutProps,\n      userData = _ref.userData,\n      package_id = _ref.package_id,\n      packages = _ref.packages,\n      api = _ref.api,\n      requireds = _ref.requireds;\n\n  var _useScript = useScript('https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js'),\n      _useScript2 = _slicedToArray(_useScript, 2),\n      ready = _useScript2[0],\n      status = _useScript2[1];\n\n  var selectedPackage = null;\n\n  if (packages && package_id) {\n    selectedPackage = packages.items.find(function (i) {\n      return i.id == package_id;\n    });\n    console.log(selectedPackage);\n  }\n\n  var _useContext = useContext(UserContext),\n      user = _useContext.user;\n\n  var _useState = useState({\n    errors: {}\n  }),\n      error = _useState[0],\n      setError = _useState[1];\n\n  var _useState2 = useState({\n    package_id: '',\n    paymentMethodId: null,\n    payment_os: null,\n    cash_paymentMethodId: null,\n    terms: null,\n    discount_id: null,\n    cardNumber: null,\n    cardHolderName: null,\n    cardExpirationDate: null,\n    cardSecurityCode: null,\n    paymentMethodCode: null,\n    docType: \"CPF\",\n    docNumber: null\n  }),\n      values = _useState2[0],\n      setValues = _useState2[1];\n\n  var _useState3 = useState(null),\n      cardImg = _useState3[0],\n      setCardImg = _useState3[1];\n\n  var _useState4 = useState(null),\n      creditCard = _useState4[0],\n      setCreditCard = _useState4[1];\n\n  var _useState5 = useState(),\n      loading = _useState5[0],\n      setLoading = _useState5[1];\n\n  var businessUnitPublicKey = 'TEST-7205c1be-9805-4308-bf00-6557c5b56b88';\n\n  var _useState6 = useState(false),\n      isMercadoPagoReady = _useState6[0],\n      setIsMercadoPagoReady = _useState6[1];\n\n  var MercadoPago = ready && HAS_WINDOW ? window.Mercadopago : null;\n  var credit_card_id = 1;\n  var debit_card_id = 2;\n  var isCardPayment = [credit_card_id, debit_card_id].includes(values.paymentMethodId);\n  useEffect(function (_) {\n    if (MercadoPago) {\n      MercadoPago.setPublishableKey(businessUnitPublicKey);\n      setIsMercadoPagoReady(true);\n    }\n  }, [MercadoPago]);\n  /* handle payment method change */\n\n  function onPaymentChange(e) {\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      paymentMethodId: parseInt(e.target.value, 10),\n      cash_paymentMethodId: null\n    }));\n  }\n\n  function onCashPaymentMethodChange(e) {\n    setValues(_objectSpread(_objectSpread({}, values), {}, {\n      cash_paymentMethodId: parseInt(e.target.value, 10)\n    }));\n  }\n\n  var handleInputChange = function handleInputChange(e) {\n    var _e$target = e.target,\n        checked = _e$target.checked,\n        name = _e$target.name,\n        value = _e$target.value,\n        type = _e$target.type;\n    setValues(_objectSpread(_objectSpread({}, values), {}, _defineProperty({}, name, type === 'checkbox' ? checked ? value === 'true' ? true : value : false : value)));\n  };\n\n  var handleInputChangeCreditCardNumber = function handleInputChangeCreditCardNumber(e) {\n    var _e$target2 = e.target,\n        name = _e$target2.name,\n        value = _e$target2.value;\n    setValues(_objectSpread(_objectSpread({}, values), {}, _defineProperty({}, name, value)));\n    var cardnumber = value;\n\n    if (cardnumber.length >= 6) {\n      var bin = cardnumber.substring(0, 6);\n      MercadoPago.getPaymentMethod({\n        \"bin\": bin\n      }, function (status, details) {\n        if (details.length > 0) {\n          var _objectSpread4;\n\n          setCardImg(details[0].secure_thumbnail);\n          setCreditCard(details[0]);\n          setValues(_objectSpread(_objectSpread({}, values), {}, (_objectSpread4 = {}, _defineProperty(_objectSpread4, 'paymentMethodCode', details[0].id), _defineProperty(_objectSpread4, 'cardNumber', cardnumber), _objectSpread4)));\n        }\n      });\n    }\n  }; // payment methods\n\n\n  var _useState7 = useState(),\n      paymentMethods = _useState7[0],\n      setPaymentMethods = _useState7[1]; // get payment methods\n\n\n  useEffect(function (_) {\n    var getPaymentMethods = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_) {\n        var _yield$api$get, data;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return api.get('payment-methods');\n\n              case 2:\n                _yield$api$get = _context.sent;\n                data = _yield$api$get.data;\n                setPaymentMethods(data);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function getPaymentMethods(_x) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    getPaymentMethods();\n  }, []); // cash payment methods\n\n  var _useState8 = useState(),\n      cashPaymentMethods = _useState8[0],\n      setCashPaymentMethods = _useState8[1]; // get cash payment methods\n\n\n  useEffect(function (_) {\n    var getCashPaymentMethods = /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_) {\n        var _yield$api$get2, data;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return api.get('cash-payment-methods');\n\n              case 2:\n                _yield$api$get2 = _context2.sent;\n                data = _yield$api$get2.data;\n                setCashPaymentMethods(data);\n\n              case 5:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function getCashPaymentMethods(_x2) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n\n    getCashPaymentMethods();\n  }, []);\n\n  var submitCredit = /*#__PURE__*/function () {\n    var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e) {\n      var expirationMonth, expirationYear;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              e.preventDefault();\n              setLoading(true);\n              expirationMonth = values.cardExpirationDate.split('/')[0];\n              expirationYear = values.cardExpirationDate.split('/')[1];\n              MercadoPago.createToken({\n                cardNumber: values.cardNumber,\n                cardholderName: values.cardHolderName,\n                cardExpirationMonth: expirationMonth,\n                cardExpirationYear: expirationYear,\n                securityCode: values.cardSecurityCode,\n                docType: values.docType,\n                docNumber: values.docNumber,\n                email: user.email\n              }, /*#__PURE__*/function () {\n                var _ref5 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(statusCode, response) {\n                  var token, errors, _iterator, _step, _error, res, _error$response, data, _status;\n\n                  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          token = \"\";\n\n                          if (response && response.cause && response.cause.length > 0) {\n                            errors = [];\n                            _iterator = _createForOfIteratorHelper(response.cause);\n\n                            try {\n                              for (_iterator.s(); !(_step = _iterator.n()).done;) {\n                                _error = _step.value;\n\n                                if (_error.code === \"E301\") {\n                                  errors[\"cardNumber\"] = \"Há algo de errado com esse número. Digite novamente.\";\n                                }\n\n                                if (_error.code === \"E302\") {\n                                  errors[\"cardSecurityCode\"] = \"Confira o código de segurança.\";\n                                }\n\n                                if (_error.code === \"316\") {\n                                  _error[\"cardHolderName\"] = \"Por favor, digite um nome válido.\";\n                                }\n\n                                if (_error.code === \"324\") {\n                                  errors[\"docType\"] = \"Confira seu documento.\";\n                                }\n\n                                if (_error.code === \"325\" || _error.code === \"326\") {\n                                  errors[\"cardExpirationDate\"] = \"Confira a data.\";\n                                }\n                              }\n                            } catch (err) {\n                              _iterator.e(err);\n                            } finally {\n                              _iterator.f();\n                            }\n\n                            setError({\n                              errors: errors\n                            });\n                          }\n\n                          _context3.prev = 2;\n                          console.log(response);\n                          _context3.next = 6;\n                          return api.post(\"register/subscribe\", {\n                            package_id: package_id,\n                            payment_method_id: values.paymentMethodId,\n                            payment_method_code: values.paymentMethodCode,\n                            token: token\n                          });\n\n                        case 6:\n                          res = _context3.sent;\n                          _context3.next = 12;\n                          break;\n\n                        case 9:\n                          _context3.prev = 9;\n                          _context3.t0 = _context3[\"catch\"](2);\n\n                          if (_context3.t0.response) {\n                            _error$response = _context3.t0.response, data = _error$response.data, _status = _error$response.status;\n\n                            if (_status === 422) {\n                              setError(data);\n                            }\n                          } else if (_context3.t0.request) {\n                            setError(_context3.t0);\n                          } else {\n                            setError(_context3.t0);\n                          }\n\n                        case 12:\n                          _context3.prev = 12;\n                          setLoading(false);\n                          return _context3.finish(12);\n\n                        case 15:\n                          setLoading(false);\n\n                        case 16:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _callee3, null, [[2, 9, 12, 15]]);\n                }));\n\n                return function (_x4, _x5) {\n                  return _ref5.apply(this, arguments);\n                };\n              }()); // const data = { ...values, payment_os: paymentData }\n              //\n\n            case 5:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function submitCredit(_x3) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"offset-md-2 col-md-8\"\n  }, __jsx(\"h3\", {\n    className: \"h3\"\n  }, \"Pago\"), __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-md-6 paymentMethod\"\n  }, __jsx(\"div\", {\n    className: \"row\"\n  }, __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"paymentMethodId\",\n    style: \"margin: 0;\"\n  }, \"Pague com\"), __jsx(Select, {\n    id: \"paymentMethodId\",\n    name: \"paymentMethodId\",\n    required: requireds,\n    onChange: onPaymentChange,\n    value: values.paymentMethodId\n  }, __jsx(\"option\", {\n    value: \"0\"\n  }, \"Selecione\"), paymentMethods && paymentMethods.map(function (paymentMethod, key) {\n    return __jsx(\"option\", {\n      key: paymentMethod.id,\n      state: values.paymentMethodId,\n      value: paymentMethod.id\n    }, paymentMethod.name);\n  })), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"paymentMethodId\"\n  }))), __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"cardHolderName\"\n  }, \"Nombre impreso en tarjeta\"), __jsx(Input, {\n    id: \"cardHolderName\",\n    name: \"cardHolderName\",\n    required: requireds,\n    type: \"text\",\n    onChange: handleInputChange\n  }))), __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"cardNumber\"\n  }, \"Nro Cart\\xE3o\"), __jsx(\"img\", {\n    src: cardImg,\n    \"class\": \"creditCardBrand\"\n  }), __jsx(MaskedInput, {\n    mask: [/\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/],\n    guide: false,\n    \"class\": \"form-control\",\n    onChange: handleInputChangeCreditCardNumber,\n    id: \"cardNumber\",\n    name: \"cardNumber\"\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"cardNumber\"\n  }))), __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"docNumber\"\n  }, \"Documento\"), __jsx(Input, {\n    \"class\": \"form-control\",\n    onChange: handleInputChange,\n    id: \"docNumber\",\n    name: \"docNumber\",\n    maxLength: 20\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"docNumber\"\n  }))), __jsx(\"div\", {\n    className: \"col-6\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"card-duedate\"\n  }, \"Dt Vencimento\"), __jsx(MaskedInput, {\n    mask: [/\\d/, /\\d/, '/', /\\d/, /\\d/],\n    guide: false,\n    \"class\": \"form-control\",\n    placeholder: \"MM/AA\",\n    name: \"cardExpirationDate\",\n    onChange: handleInputChange\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"cardExpirationDate\"\n  }))), __jsx(\"div\", {\n    className: \"col-6\"\n  }, __jsx(FormGroup, null, __jsx(Label, {\n    htmlFor: \"card-cvv\"\n  }, \"CVV\"), __jsx(MaskedInput, {\n    mask: [/\\d/, /\\d/, /\\d/],\n    guide: false,\n    \"class\": \"form-control\",\n    name: \"cardSecurityCode\",\n    onChange: handleInputChange,\n    placeholder: \"***\"\n  }), __jsx(InvalidFeedback, {\n    error: error,\n    loading: loading,\n    name: \"cardSecurityCode\"\n  }))), __jsx(\"div\", {\n    className: \"col-12\"\n  }, __jsx(Button, {\n    block: true,\n    color: \"secondary\",\n    type: \"button\",\n    disabled: loading,\n    loading: loading,\n    onClick: submitCredit\n  }, \"Pagar\")))), __jsx(\"div\", {\n    className: \"col-md-6\"\n  }, __jsx(\"div\", {\n    \"class\": \"product-summary\"\n  }, __jsx(\"div\", {\n    className: \"product-image\"\n  }, __jsx(\"img\", {\n    src: \"https://place-hold.it/280x125\",\n    alt: \"\"\n  })), __jsx(\"div\", {\n    className: \"product-name-group\"\n  }, __jsx(\"h6\", null, \"Voc\\xEA est\\xE1 comprando:\"), __jsx(\"p\", {\n    \"class\": \"product-name\"\n  }, \"Assinatura LaU Play - \", __jsx(\"strong\", null, selectedPackage.name), \" recorrente\")), __jsx(\"div\", {\n    \"class\": \"price-breakdown\"\n  }, __jsx(\"div\", {\n    className: \"checkout-total\"\n  }, __jsx(\"h6\", null, \"Total\"), __jsx(\"p\", {\n    \"class\": \"price\"\n  }, \"$ \", selectedPackage.amount))))))));\n};\n\n_s(Payment, \"MxNhemYDTHBnaDP4GLZqER+xDNQ=\", false, function () {\n  return [useScript];\n});\n\n_c = Payment;\nexport default _c2 = withAuth(Payment, true);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Payment\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/rafael/Projects/somosgad/dale/pages/register/wizard/payment.js"],"names":["useContext","useEffect","useState","FormGroup","Label","Input","withAuth","InvalidFeedback","HAS_WINDOW","useScript","Select","Button","MaskedInput","UserContext","Payment","layoutProps","userData","package_id","packages","api","requireds","ready","status","selectedPackage","items","find","i","id","console","log","user","errors","error","setError","paymentMethodId","payment_os","cash_paymentMethodId","terms","discount_id","cardNumber","cardHolderName","cardExpirationDate","cardSecurityCode","paymentMethodCode","docType","docNumber","values","setValues","cardImg","setCardImg","creditCard","setCreditCard","loading","setLoading","businessUnitPublicKey","isMercadoPagoReady","setIsMercadoPagoReady","MercadoPago","window","Mercadopago","credit_card_id","debit_card_id","isCardPayment","includes","_","setPublishableKey","onPaymentChange","e","parseInt","target","value","onCashPaymentMethodChange","handleInputChange","checked","name","type","handleInputChangeCreditCardNumber","cardnumber","length","bin","substring","getPaymentMethod","details","secure_thumbnail","paymentMethods","setPaymentMethods","getPaymentMethods","get","data","cashPaymentMethods","setCashPaymentMethods","getCashPaymentMethods","submitCredit","preventDefault","expirationMonth","split","expirationYear","createToken","cardholderName","cardExpirationMonth","cardExpirationYear","securityCode","email","statusCode","response","token","cause","code","post","payment_method_id","payment_method_code","res","request","map","paymentMethod","key","amount"],"mappings":"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","sourcesContent":["import { useContext, useEffect, useState } from \"react\";\nimport FormGroup from \"~/components/layout/AuthModal/FormGroup\";\nimport Label from \"~/components/Form/Label\";\nimport Input from \"~/components/layout/AuthModal/Input\";\nimport withAuth from \"~/components/withAuth\";\nimport InvalidFeedback from \"~/components/Form/InvalidFeedback\"\nimport { HAS_WINDOW } from \"~/constants/constants\";\nimport useScript from \"@charlietango/use-script\";\nimport Select from \"~/components/Select/Select\";\nimport Button from \"~/components/button\";\nimport MaskedInput from 'react-text-mask'\nimport UserContext from \"~/contexts/UserContext\";\n\nconst Payment = ({\n                   layoutProps,\n                   userData,\n                   package_id,\n                   packages,\n                   api,\n                   requireds\n                 }) => {\n\n  const [ready, status] = useScript('https://secure.mlstatic.com/sdk/javascript/v1/mercadopago.js')\n\n\n  let selectedPackage = null\n  if (packages && package_id) {\n    selectedPackage = packages.items.find(i => i.id == package_id)\n    console.log(selectedPackage)\n  }\n\n  const { user } = useContext(UserContext)\n  const [error, setError] = useState({\n    errors: {}\n  })\n\n  const [values, setValues] = useState({\n    package_id: '',\n    paymentMethodId: null,\n    payment_os: null,\n    cash_paymentMethodId: null,\n    terms: null,\n    discount_id: null,\n    cardNumber: null,\n    cardHolderName: null,\n    cardExpirationDate: null,\n    cardSecurityCode: null,\n    paymentMethodCode: null,\n    docType: \"CPF\",\n    docNumber: null,\n  })\n\n  const [cardImg, setCardImg] = useState(null);\n  const [creditCard, setCreditCard] = useState(null);\n\n  const [loading, setLoading] = useState();\n\n  const businessUnitPublicKey = 'TEST-7205c1be-9805-4308-bf00-6557c5b56b88'\n  const [isMercadoPagoReady, setIsMercadoPagoReady] = useState(false)\n  const MercadoPago = ready && HAS_WINDOW ? window.Mercadopago : null\n\n  const credit_card_id = 1\n  const debit_card_id = 2\n  const isCardPayment = [credit_card_id, debit_card_id].includes(values.paymentMethodId)\n\n\n  useEffect(_ => {\n    if (MercadoPago) {\n      MercadoPago.setPublishableKey(businessUnitPublicKey)\n      setIsMercadoPagoReady(true)\n    }\n  }, [MercadoPago])\n\n\n  /* handle payment method change */\n  function onPaymentChange(e) {\n    setValues({\n      ...values,\n      paymentMethodId: parseInt(e.target.value, 10),\n      cash_paymentMethodId: null,\n    })\n  }\n\n  function onCashPaymentMethodChange(e) {\n    setValues({\n      ...values,\n      cash_paymentMethodId: parseInt(e.target.value, 10),\n    })\n  }\n\n  const handleInputChange = e => {\n    const { checked, name, value, type } = e.target\n    setValues({\n      ...values,\n      [name]: type === 'checkbox' ?\n        (checked ? (value === 'true' ? true : value) : false) :\n        value,\n    })\n  }\n\n  const handleInputChangeCreditCardNumber = e => {\n\n    const { name, value } = e.target\n\n\n    setValues({\n      ...values,\n      [name]: value,\n    })\n\n    let cardnumber = value;\n\n    if (cardnumber.length >= 6) {\n      let bin = cardnumber.substring(0, 6);\n\n      MercadoPago.getPaymentMethod({\n        \"bin\": bin\n      }, (status, details) => {\n        if (details.length > 0) {\n          setCardImg(details[0].secure_thumbnail);\n          setCreditCard(details[0]);\n          setValues({\n            ...values,\n            ['paymentMethodCode']: details[0].id,\n            ['cardNumber']: cardnumber\n          })\n\n        }\n      });\n\n    }\n  }\n\n  // payment methods\n  const [paymentMethods, setPaymentMethods] = useState()\n\n  // get payment methods\n  useEffect(_ => {\n    const getPaymentMethods = async _ => {\n      const { data } = await api.get('payment-methods')\n      setPaymentMethods(data)\n    }\n    getPaymentMethods()\n  }, [])\n\n  // cash payment methods\n  const [cashPaymentMethods, setCashPaymentMethods] = useState()\n\n  // get cash payment methods\n  useEffect(_ => {\n    const getCashPaymentMethods = async _ => {\n      const { data } = await api.get('cash-payment-methods')\n      setCashPaymentMethods(data)\n    }\n    getCashPaymentMethods()\n  }, [])\n\n\n  const submitCredit = async e => {\n\n    e.preventDefault();\n\n    setLoading(true);\n\n    let expirationMonth = values.cardExpirationDate.split('/')[0];\n    let expirationYear = values.cardExpirationDate.split('/')[1];\n\n    MercadoPago.createToken({\n      cardNumber: values.cardNumber,\n      cardholderName: values.cardHolderName,\n      cardExpirationMonth: expirationMonth,\n      cardExpirationYear: expirationYear,\n      securityCode: values.cardSecurityCode,\n      docType: values.docType,\n      docNumber: values.docNumber,\n      email: user.email\n    }, async (statusCode, response) => {\n\n      let token = \"\";\n\n      if (response && response.cause && response.cause.length > 0) {\n        let errors = [];\n        for (let error of response.cause) {\n          if (error.code === \"E301\") {\n            errors[\"cardNumber\"] = \"Há algo de errado com esse número. Digite novamente.\"\n          }\n          if (error.code === \"E302\") {\n            errors[\"cardSecurityCode\"] = \"Confira o código de segurança.\"\n          }\n          if (error.code === \"316\") {\n            error[\"cardHolderName\"] = \"Por favor, digite um nome válido.\"\n          }\n          if (error.code === \"324\") {\n            errors[\"docType\"] = \"Confira seu documento.\";\n          }\n          if (error.code === \"325\" || error.code === \"326\") {\n            errors[\"cardExpirationDate\"] = \"Confira a data.\";\n          }\n        }\n        setError({\n          errors: errors\n        });\n      }\n\n\n      try {\n\n        console.log(response);\n        \n        const res = await api.post(`register/subscribe`, {\n          package_id: package_id,\n          payment_method_id: values.paymentMethodId,\n          payment_method_code: values.paymentMethodCode,\n          token: token\n        })\n\n        // handleSubmit(1)\n\n      } catch (error) {\n\n        if (error.response) {\n          const { data, status } = error.response\n          if (status === 422) {\n            setError(data)\n          }\n        } else if (error.request) {\n          setError(error)\n        } else {\n          setError(error)\n        }\n\n      } finally {\n        setLoading(false)\n      }\n\n\n      setLoading(false);\n\n    });\n\n\n    // const data = { ...values, payment_os: paymentData }\n    //\n\n  }\n\n  return (\n    <div className=\"row\">\n      <div className=\"offset-md-2 col-md-8\">\n\n        <h3 className=\"h3\">Pago</h3>\n\n        <div className=\"row\">\n\n          <div className=\"col-md-6 paymentMethod\">\n            <div className=\"row\">\n              <div className=\"col-12\">\n                <FormGroup>\n                  <Label htmlFor=\"paymentMethodId\" style=\"margin: 0;\">Pague com</Label>\n                  <Select\n                    id=\"paymentMethodId\"\n                    name=\"paymentMethodId\"\n                    required={ requireds }\n                    onChange={ onPaymentChange }\n                    value={ values.paymentMethodId }\n                  >\n                    <option value=\"0\">Selecione</option>\n                    { paymentMethods && paymentMethods.map((paymentMethod, key) => (\n                      <option\n                        key={ paymentMethod.id }\n                        state={ values.paymentMethodId }\n                        value={ paymentMethod.id }\n                      >\n                        { paymentMethod.name }\n                      </option>\n                    )) }\n                  </Select>\n                  <InvalidFeedback error={ error } loading={ loading } name=\"paymentMethodId\"/>\n                </FormGroup>\n              </div>\n              <div className=\"col-12\">\n                <FormGroup>\n                  <Label htmlFor=\"cardHolderName\">Nombre impreso en tarjeta</Label>\n                  <Input id=\"cardHolderName\" name=\"cardHolderName\" required={ requireds } type=\"text\"\n                         onChange={ handleInputChange }/>\n                </FormGroup>\n              </div>\n              <div className=\"col-12\">\n                <FormGroup>\n                  <Label htmlFor=\"cardNumber\">Nro Cartão</Label>\n                  <img src={ cardImg } class=\"creditCardBrand\"/>\n                  <MaskedInput\n                    mask={ [/\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/, ' ', /\\d/, /\\d/, /\\d/, /\\d/] }\n                    guide={ false }\n                    class={ \"form-control\" }\n                    onChange={ handleInputChangeCreditCardNumber }\n                    id=\"cardNumber\" name=\"cardNumber\"\n                  />\n                  <InvalidFeedback error={ error } loading={ loading } name=\"cardNumber\"/>\n                </FormGroup>\n              </div>\n              <div className=\"col-12\">\n                <FormGroup>\n                  <Label htmlFor=\"docNumber\">Documento</Label>\n                  <Input\n                    class={ \"form-control\" }\n                    onChange={ handleInputChange }\n                    id=\"docNumber\" name=\"docNumber\"\n                    maxLength={ 20 }\n                  />\n                  <InvalidFeedback error={ error } loading={ loading } name=\"docNumber\"/>\n                </FormGroup>\n              </div>\n              <div className=\"col-6\">\n                <FormGroup>\n                  <Label htmlFor=\"card-duedate\">Dt Vencimento</Label>\n                  <MaskedInput\n                    mask={ [/\\d/, /\\d/, '/', /\\d/, /\\d/,] }\n                    guide={ false }\n                    class={ \"form-control\" }\n                    placeholder={ \"MM/AA\" }\n                    name={ \"cardExpirationDate\" }\n                    onChange={ handleInputChange }\n                  />\n                  <InvalidFeedback error={ error } loading={ loading } name=\"cardExpirationDate\"/>\n                </FormGroup>\n              </div>\n              <div className=\"col-6\">\n                <FormGroup>\n                  <Label htmlFor=\"card-cvv\">CVV</Label>\n                  <MaskedInput\n                    mask={ [/\\d/, /\\d/, /\\d/] }\n                    guide={ false }\n                    class={ \"form-control\" }\n                    name={ \"cardSecurityCode\" }\n                    onChange={ handleInputChange }\n                    placeholder={ \"***\" }\n                  />\n                  <InvalidFeedback error={ error } loading={ loading } name=\"cardSecurityCode\"/>\n                </FormGroup>\n              </div>\n              <div className=\"col-12\">\n                <Button block color=\"secondary\" type=\"button\" disabled={ loading }\n                        loading={ loading } onClick={ submitCredit }>Pagar</Button>\n              </div>\n            </div>\n          </div>\n\n          <div className=\"col-md-6\">\n            <div class=\"product-summary\">\n              <div className=\"product-image\">\n                <img src=\"https://place-hold.it/280x125\" alt=\"\"/>\n              </div>\n              <div className={ \"product-name-group\" }>\n                <h6>\n                  Você está comprando:\n                </h6>\n                <p class={ \"product-name\" }>\n                  Assinatura LaU Play - <strong>{ selectedPackage.name }</strong> recorrente\n                </p>\n              </div>\n              <div class={ \"price-breakdown\" }>\n                <div className=\"checkout-total\">\n                  <h6>\n                    Total\n                  </h6>\n                  <p class={ \"price\" }>\n                    $ { selectedPackage.amount }\n                  </p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  )\n}\n\nexport default withAuth(Payment, true);\n"]},"metadata":{},"sourceType":"module"}